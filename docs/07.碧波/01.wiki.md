---
title: wiki
date: 2022-07-29 17:00:07
permalink: /pages/be35a1/
categories:
  - ç¢§æ³¢
tags:
  - 
author: 
  name: xugaoyi
  link: https://github.com/xugaoyi
---
#  ğŸ¦–wiki

<img src="https://gitee.com/ibepo/ogcip/raw/master/20210930122438.jpg" alt="æŸ¥çœ‹æºå›¾åƒ" style="zoom: 150%;" />
## Git

![image-20211210163331558](https://gitee.com/ibepo/ogcip/raw/master/20211210163332.png)



`git add . `ä»–ä¼šç›‘æ§å·¥ä½œåŒºçš„çŠ¶æ€æ ‘ï¼Œä½¿ç”¨å®ƒä¼šæŠŠå·¥ä½œæ—¶çš„**æ‰€æœ‰å˜åŒ–æäº¤**åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬æ–‡ä»¶å†…å®¹ä¿®æ”¹(modified)ä»¥åŠæ–°æ–‡ä»¶(new)ï¼Œä½†ä¸åŒ…æ‹¬è¢«åˆ é™¤çš„æ–‡ä»¶

`git add -u`ä»–ä»…ç›‘æ§**å·²ç»è¢«addçš„æ–‡ä»¶**ï¼ˆå³`tracked file`ï¼‰ï¼Œä»–ä¼šå°†è¢«ä¿®æ”¹çš„æ–‡ä»¶æäº¤åˆ°æš‚å­˜åŒºã€‚`git add -u` ä¸ä¼šæäº¤æ–°æ–‡ä»¶ï¼ˆ`untracked file`ï¼‰ã€‚ï¼ˆ`git add --update`çš„ç¼©å†™ï¼‰

`git add -A `æ˜¯ä¸Šé¢ä¸¤ä¸ªåŠŸèƒ½çš„åˆé›†ï¼ˆ`git add --all`çš„ç¼©å†™ï¼‰

æ€»ç»“:

* `git add -A`  æäº¤æ‰€æœ‰å˜åŒ–

- `git add -u ` æäº¤è¢«ä¿®æ”¹(modified)å’Œè¢«åˆ é™¤(deleted)æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬æ–°æ–‡ä»¶(new),(ä¿®æ”¹å’Œåˆ é™¤)
- `git add . ` æäº¤æ–°æ–‡ä»¶(new)å’Œè¢«ä¿®æ”¹(modified)æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬è¢«åˆ é™¤(deleted)æ–‡ä»¶(æ–°å¢å’Œä¿®æ”¹)

svn

```shell
$ svn chekout https://47.97.78.164:8443/svn/parking/parking --username=cuijie --password=123456
```

å®æ—¶è·å–çŠ¶æ€

```shell
git -c credential.helper= -c core.quotepath=false -c log.showSignature=false fetch origin --recurse-submodules=no --progress --prune
```

å¼ºåˆ¶ç”¨è¿œç¨‹é«˜ç‰ˆæœ¬è¦†ç›–æœ‰æœ¬åœ°ä¿®æ”¹çš„ä½ç‰ˆæœ¬

```shell
git -c credential.helper= -c core.quotepath=false -c log.showSignature=false reset --hard b77619e51ee9ca50edbb0ba04dc1c77a95db4414
```



## Linux 



zsh

```shell
sudo apt install zsh
chsh -s /bin/zsh
```



*   Â è…¾è®¯äº‘æœåŠ¡å™¨è®°å¾—é‡ç½®æœåŠ¡å™¨å¯†ç 
*    Ubuntu é»˜è®¤ä¸äºˆè®¸ root ç™»å½•

### ä¿®æ”¹ä¸»æœºå

```shell
#1
echo "timehouse" > /etc/hostname
hostname -F /etc/hostname

#2
hostnamectl set-hostname

#3
vim /etc/hostname

```

[Ubuntué»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ_ç™¾åº¦çŸ¥é“ (baidu.com)](https://zhidao.baidu.com/question/535932780.html)

### ä¿®æ”¹ rootç”¨æˆ·å¯†ç 

```shell
sudo passwd
```

### SSH

#### ~~bash åˆ«åç™»å½•~~

```
alias 62='sshpass -pã€€bbdmw9527~ ssh root@39.102.138.62'
```

```shell
#homebrew ä¸èƒ½å®‰è£… sshpass,å¯¹å®‰å…¨ä¸å¯é ,è¿™é‡Œåˆ—å‡ºç®—æ˜¯ä¸€ä¸ªæ–¹å‘
brew install sshpass
We won't add sshpass because it makes it too easy for novice SSH users to
ruin SSH's security.
```



#### ssh å…å¯†ç™»å½•

#### æŸ¥çœ‹ ssh å…¬é’¥ç§˜é’¥

```shell
cd ~/.ssh
bat id_rsa.pub
```



æœ¬åœ°ç”Ÿäº§ç§˜é’¥å¯¹

```shell
ssh-keygen -t rsa
```
ä¿®æ”¹sshæ–‡ä»¶å¤¹æƒé™è¿‡äºå¼€æ”¾çš„é—®é¢˜
```shell
chmod 600 ~/.ssh/id_rsa ~/.ssh/id_rsa.pub
```

ç™»å½•è¿œç¨‹ä¸»æœº,å¹¶å¤åˆ¶ç§˜é’¥å¯¹

```shell
$ ssh-copy-id -i ~/.ssh/id_rsa.pub root@82.157.172.14
```

```shell
$ ssh-copy-id -i ~/.ssh/id_rsa.pub ubuntu@82.157.172.14
```

```
$ ssh-copy-id -i ~/.ssh/id_rsa.pub ubuntu@82.157.172.14
```



#### ç»™è¿œç¨‹ä¸»æœºè®¾ç½®åˆ«å

è¿›å…¥`ï½/.ssh` ç›®å½•ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰åä¸º`config`çš„æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ç›´æ¥åˆ›å»ºä¸€ä¸ªï¼Œç„¶åä¿®æ”¹configæ–‡ä»¶ä¸ºè¿œç¨‹ä¸»æœºèµ· åˆ«å

```shell
vim ~/.ssh/config
```

config æ–‡ä»¶çš„ç¼–å†™å¯ä»¥å‚è€ƒä¸‹é¢

```vim
Host s
HostName 39.102.138.62
User root
Port 22
```

é€šè¿‡åˆ«å ssh åˆ°è¿œç¨‹ä¸»æœº

```shell
ssh s
```

### å¸¸è§è½¯ä»¶å®‰è£…ä½ç½®

`usr/lib`ã€`usr/local`ã€`var/lib`

### ç¯å¢ƒå˜é‡

```shell
#Shell è‡ªåŠ¨è¯»å–çš„æ–‡ä»¶æœ‰
#mac ä¸‹
bashrc
~/.bash_profile
~/.bash_login
~/.profile
~/.zshrc
#liunx
~/.bashrc 
```

```shell
env #æŸ¥çœ‹å…¨éƒ¨ç¯å¢ƒå˜é‡
echo $JAVA_HOME #æŸ¥çœ‹å•ä¸ªç¯å¢ƒå˜é‡

#â‘ é…ç½®ç¯å¢ƒå˜é‡
vi /etc/profile #æ‰“å¼€/etc/profile
#ä»¥ä¸‹æ˜¯ profile è®¾ç½® java ç¯å¢ƒå˜é‡çš„ä¾‹å­
JAVA_HOME=/usr/lib/jvm/jre-1.8.0-openjdk.x86_64
PATH=$PATH:$JAVA_HOME/bin
CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar #:å°±æ˜¯å’Œçš„æ„æ€,
export JAVA_HOME CLASSPATH PATH%
#é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶
source /etc/profile

#â‘¡é€šè¿‡å‘½ä»¤è¡Œ ç›´æ¥æ“ä½œlinux ä¸­çš„ç¯å¢ƒè®¾ç½®æ–‡ä»¶
#æ³¨æ„>> æ˜¯è¿½åŠ 
echo 'PATH="$PATH:./node_modules/.bin"' >> ~/.profile 

#â‘¢è½¯è¿æ¥æ–¹å¼,å°†/usr/bin/xx/bin æˆ–è€…/usr/local/xx/binä¸‹çš„ç›¸å…³å‘½ä»¤ è¿æ¥åˆ°/usr/bin ä¸‹.
ln -s[åŸæ–‡ä»¶æˆ–ç›®å½•][è½¯è¿æ¥çš„åå­—] #ln è½¯è¿æ¥æŒ‡ä»¤,ç¬¦å·é“¾æ¥,ç±»ä¼¼äºå¿«æ·æ–¹å¼
[å½“å‰åœ¨/home ç›®å½•ä¸‹] ln -s /root linktotest # åœ¨/home ä¸‹åˆ›å»ºä¸€ä¸ªè½¯è¿æ¥ linktotest è¿æ¥åˆ°/root ç›®å½•
rm -rf linktotest# åˆ é™¤è½¯è¿æ¥,è™½ç„¶è½¯è¿æ¥æ˜¯ä¸ªæ–‡ä»¶å¤¹ ä½†æ˜¯ä¸è¦å¸¦æ–œæ 

```

```shell
#Linuxä¸‹ç¯å¢ƒå˜é‡é…ç½®æ–¹æ³•æ¢³ç†ï¼ˆ.bash_profileå’Œ.bashrcçš„åŒºåˆ«ï¼‰

#1ï¼‰ä¿®æ”¹/etc/profileæ–‡ä»¶
#æ¨èä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºæ‰€æœ‰ç”¨æˆ·çš„shelléƒ½æœ‰æƒä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡ï¼Œç¼ºç‚¹æ˜¯å¯èƒ½ä¼šç»™ç³»ç»Ÿå¸¦æ¥å®‰å…¨æ€§é—®é¢˜ã€‚ è¿™é‡Œæ˜¯é’ˆå¯¹æ‰€æœ‰çš„ç”¨æˆ·çš„,æ‰€æœ‰çš„shell;
vim /etc/profile
export PATH=$PATH:/usr/local/mysql/bin 
#ä½¿ç”¨sourceå‘½ä»¤ä½¿ä¿®æ”¹ç«‹åˆ»ç”Ÿæ•ˆ
[root@test ~]# source  /etc/profile
#Tips:
#åœ¨/etc/profileé‡Œè®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡æ—¶ï¼Œè·¯å¾„æœ«å°¾ä¸èƒ½ä»¥"/"ç»“å°¾ï¼Œå¦åˆ™å°†å¯¼è‡´æ•´ä¸ªPATHå˜é‡å‡ºé”™ã€‚

#2ï¼‰ä¿®æ”¹.bashrcæ–‡ä»¶,è¿™ç§æ–¹æ³•æ›´ä¸ºå®‰å…¨ï¼Œå®ƒå¯ä»¥æŠŠä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡çš„æƒé™æ§åˆ¶åˆ°ç”¨æˆ·çº§åˆ«,è¿™é‡Œæ˜¯é’ˆå¯¹æŸä¸€ä¸ªç‰¹å®šçš„ç”¨##æˆ·ï¼Œå¦‚æœéœ€è¦ç»™æŸä¸ªç”¨æˆ·æƒé™
#ä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡ï¼Œåªéœ€è¦ä¿®æ”¹å…¶ä¸ªäººç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„.bashrcæ–‡ä»¶å°±å¯ä»¥äº†ã€‚
vim /root/.bashrc
export PATH=$PATH:/usr/local/mysql/bin
source  /root/.bashrc


#3)
# /etc/profile: æ­¤æ–‡ä»¶ä¸ºç³»ç»Ÿçš„æ¯ä¸ªç”¨æˆ·è®¾ç½®ç¯å¢ƒä¿¡æ¯,å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•æ—¶,è¯¥æ–‡ä»¶è¢«æ‰§è¡Œ.å¹¶ä»/etc/profile.dç›®å½•çš„é…ç½®æ–‡ä»¶ä¸­æœé›†shellçš„è®¾ç½®.

# /etc/bashrc:  ä¸ºæ¯ä¸€ä¸ªè¿è¡Œbash shellçš„ç”¨æˆ·æ‰§è¡Œæ­¤æ–‡ä»¶.å½“bash shellè¢«æ‰“å¼€æ—¶,è¯¥æ–‡ä»¶è¢«è¯»å–.

# ~/.bash_profile: æ¯ä¸ªç”¨æˆ·éƒ½å¯ä½¿ç”¨è¯¥æ–‡ä»¶è¾“å…¥ä¸“ç”¨äºè‡ªå·±ä½¿ç”¨çš„shellä¿¡æ¯,å½“ç”¨æˆ·ç™»å½•æ—¶,è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡!é»˜è®¤æƒ…å†µä¸‹,ä»–è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡,æ‰§è¡Œç”¨æˆ·çš„.bashrcæ–‡ä»¶.

# ~/.bashrc: è¯¥æ–‡ä»¶åŒ…å«ä¸“ç”¨äºä½ çš„bash shellçš„bashä¿¡æ¯,å½“ç™»å½•æ—¶ä»¥åŠæ¯æ¬¡æ‰“å¼€æ–°çš„shellæ—¶,è¯¥è¯¥æ–‡ä»¶è¢«è¯»å–.

# ~/.bash_logout: å½“æ¯æ¬¡é€€å‡ºç³»ç»Ÿ(é€€å‡ºbash shell)æ—¶,æ‰§è¡Œè¯¥æ–‡ä»¶.
 
# å¦å¤–,/etc/profileä¸­è®¾å®šçš„å˜é‡(å…¨å±€)çš„å¯ä»¥ä½œç”¨äºä»»ä½•ç”¨æˆ·,è€Œ~/.bashrcç­‰ä¸­è®¾å®šçš„å˜é‡(å±€éƒ¨)åªèƒ½ç»§æ‰¿
#/etc/profileä¸­çš„å˜é‡,ä»–ä»¬æ˜¯"çˆ¶å­"å…³ç³».
```


### å¸¸ç”¨å‘½ä»¤

- `ls`ï¼šæ˜¾ç¤ºæ–‡ä»¶æˆ–ç›®å½•ä¿¡æ¯
- `mkdir`ï¼šå½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç©ºç›®å½•
- `rmdir`ï¼šè¦æ±‚ç›®å½•ä¸ºç©º
- `touch`ï¼šç”Ÿæˆä¸€ä¸ªç©ºæ–‡ä»¶æˆ–æ›´æ”¹æ–‡ä»¶çš„æ—¶é—´
- `cp`ï¼šå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•
- `mv`ï¼šç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ã€æ–‡ä»¶æˆ–ç›®å½•æ”¹å
- `rm`ï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•
- `ln`ï¼šå»ºç«‹é“¾æ¥æ–‡ä»¶
- `find`ï¼šæŸ¥æ‰¾æ–‡ä»¶
- `file/stat`ï¼šæŸ¥çœ‹æ–‡ä»¶ç±»å‹æˆ–æ–‡ä»¶å±æ€§ä¿¡æ¯
- `catï¼š`æŸ¥çœ‹æ–‡æœ¬æ–‡ä»¶å†…å®¹
- `moreï¼š`å¯ä»¥åˆ†é¡µçœ‹
- `lessï¼š`ä¸ä»…å¯ä»¥åˆ†é¡µï¼Œè¿˜å¯ä»¥æ–¹ä¾¿åœ°æœç´¢ï¼Œå›ç¿»ç­‰æ“ä½œ
- `tail -10`ï¼š æŸ¥çœ‹æ–‡ä»¶çš„å°¾éƒ¨çš„10è¡Œ
- `head -20`ï¼šæŸ¥çœ‹æ–‡ä»¶çš„å¤´éƒ¨20è¡Œ
- `echo`ï¼šæŠŠå†…å®¹é‡å®šå‘åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ ï¼Œæœ‰åˆ™æ‰“å¼€ï¼Œæ— åˆ™åˆ›å»º
- `ç®¡é“å‘½ä»¤ |` ï¼šå°†å‰é¢çš„ç»“æœç»™åé¢çš„å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š`ls -la | wc`ï¼Œå°†lsçš„ç»“æœåŠ æ²¹wcå‘½ä»¤æ¥ç»Ÿè®¡å­—æ•°
- `é‡å®šå‘ > æ˜¯è¦†ç›–æ¨¡å¼ï¼Œ>> æ˜¯è¿½åŠ æ¨¡å¼`ï¼Œä¾‹å¦‚ï¼š`echo "Java3y,zhen de hen xihuan ni" > qingshu.txt`æŠŠå·¦è¾¹çš„è¾“å‡ºæ”¾åˆ°å³è¾¹çš„æ–‡ä»¶é‡Œå»
- `uname -a`linux åŸºæœ¬ä¿¡æ¯

[çœ‹å®Œè¿™ç¯‡LinuxåŸºæœ¬çš„æ“ä½œå°±ä¼šäº† - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/36801617)

https://link.zhihu.com/?target=https%3A//github.com/ZhongFuCheng3y/3y

###  å‘½ä»¤è¡Œå·¥å…·

|   å·¥å…·   |                     å¤‡æ³¨                     |
| :------: | :------------------------------------------: |
|  ranger  |              å‘½ä»¤è¡Œä¸‹çš„ finder               |
|   ncdu   |               ç¡¬ç›˜å®¹é‡æ‰«æå·¥å…·               |
| autojump |                 è·¯å¾„è®°å¿†è·³è½¬                 |
| lazygit  |               å‘½ä»¤è¡Œä¸‹git å·¥å…·               |
| neofetch |                 ç³»ç»Ÿä¿¡æ¯ç»Ÿè®¡                 |
|   tmux   |                seseeion,çª—å£                 |
|   tldr   |                 mançš„æ›¿ä»£å“                  |
|   htop   | ç›‘æ§è¿›ç¨‹æŒ‡æ ‡,F4è¿‡æ»¤å…³æ³¨çš„è¿›ç¨‹, ç”¨æ³•è¯¦è§é™„å½•â‘  |
|   Ctop   |                 ç›‘æ§å®¹å™¨æŒ‡æ ‡                 |
|   Bat    |        apt install bacula-console-qt         |
|  Figlet  |                 ç”Ÿæˆ asii å­—                 |
|   Nnn    |            å¦ä¸€ä¸ªç»ˆç«¯æ–‡ä»¶ç®¡ç†å·¥å…·            |
| ripgrep  |                  grepçš„æ›¿ä»£                  |

[é™„å½•â‘ htopä½¿ç”¨è¯¦è§£--å²ä¸Šæœ€å¼º - ç«æ˜Ÿå°ç¼– - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/programmer-tlh/p/11726016.html)

### ç¡¬ç›˜å·¥å…·

```shell
diskutil list #æŸ¥çœ‹ç£ç›˜ç»“æ„ï¼š
df -h         #æŸ¥çœ‹ç£ç›˜ç»“æ„ å‘½ä»¤æŸ¥çœ‹æ•´ä¸ªç¡¬ç›˜çš„å¤§å° ï¼Œ-hè¡¨ç¤ºäººå¯è¯»çš„
du -d 1 -h    #æŸ¥çœ‹ç£ç›˜ç»“æ„å‘½ä»¤æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¤¹çš„å¤§å° -d æŒ‡æ·±åº¦ï¼Œåé¢åŠ ä¸€ä¸ªæ•°å€¼
```
```shell
#ragner,å‘½ä»¤è¡Œfinder
pip3 install ranger-fm
brew install ranger
#â‘ ç»™ rangeræ·»åŠ å­—ä½“å’Œå­—ä½“ç¬¦å·
brew tap homebrew/cask-fonts
brew install --cask font-hack-nerd-font
#â‘¡å¿«æ·é”®
#g+[],å¯åœ¨æç¤ºæ å¼¹å‡ºä¸€äº›å¿«æ·è·³è½¬æ–¹å¼
#shift+s,å¯æ¨å‡º ranger,å¹¶ä»å‘½ä»¤è¡Œè¿›å…¥é€‰ä¸­çš„è·¯å¾„ä¸‹
#yp,å½“å‰æ–‡ä»¶è·¯å¾„
#yn,æ–‡ä»¶å
#y.,å»æ‰åç¼€çš„ name
#ypo è¦†ç›–
#yy å¤åˆ¶
#pp ç²˜è´´
#dd å‰ªåˆ‡
#dD åˆ é™¤
#cw:é‡å‘½å
#v é€‰ä¸­å…¨éƒ¨
```

```shell
#ncdu,ç£ç›˜æŸ¥çœ‹å·¥å…·
brew  install ncdu
yum   install ncdu
```

```shell
#autojump
#mac ç”µè„‘
â‘  åœ¨è‡ªåŠ¨è¯»å–æ–‡ä»¶å†…æ·»åŠ  
[[ -s $(brew --prefix)/etc/profile.d/[autojump.sh](http://autojump.sh/) ]] && . $(brew --prefix)/etc/profile.d/[autojump.sh](http://autojump.sh/)#bash æ·»åŠ 
â‘¡ [[ -s `brew --prefix`/etc/autojump.sh ]] && . `brew --prefix`/etc/autojump.sh #zshæ·»åŠ 
â‘¢ [[ -s ~/.autojump/etc/profile.d/autojump.sh ]] && . ~/.autojump/etc/profile.d/autojump.sh #linuxä¸‹çš„~/.bashrc æ·»åŠ  
â‘£source ~/.bashrc
```

```shell
#tig,å‘½ä»¤è¡Œä¸‹çš„ gitå®¢æˆ·ç«¯
brew install tig

#lazygit,å‘½ä»¤è¡Œä¸‹çš„gitå®¢æˆ·ç«¯(å›½è´§ä¹‹å…‰)
brew install lazygit
```

```bash
#neofetch,å‘½ä»¤è¡Œç³»ç»Ÿä¿¡æ¯
sudo yum install epel-release
curl -o /etc/yum.repos.d/konimex-neofetch-epel-7.repo https://copr.fedorainfracloud.org/coprs/konimex/neofetch/repo/epel-7/konimex-neofetch-epel-7.repo
sudo yum install neofetch
```

```bash
#tmux,å‘½ä»¤è¡Œåˆ†çª—å£,åˆ†ä¼šè¯å·¥å…·
#tree,å‘½ä»¤è¡Œä¸‹æ ‘å½¢æ˜¾ç¤º
#bat,åŠ å¼ºç‰ˆçš„ cat
#tldr,å¤ªé•¿ä¸è¯»,å¸®åŠ©æ–‡æ¡£ç²¾ç®€å·¥å…·
```

![image-20210924105913784](https://gitee.com/ibepo/ogcip/raw/master/20210930122446.png)



### å¸¸ç”¨æ–‡ä»¶è·¯å¾„

- `/etc/profile.d`æ–‡ä»¶å¤¹ä¸‹å­˜æ”¾ sh å°†åœ¨ ssh è¿æ¥æ—¶,è¢«è‡ªåŠ¨æ‰§è¡Œ
- Systemd é»˜è®¤ä»ç›®å½•`/etc/systemd/system/`è¯»å–é…ç½®æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œé‡Œé¢å­˜æ”¾çš„å¤§éƒ¨åˆ†æ–‡ä»¶éƒ½æ˜¯ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ç›®å½•`/usr/lib/systemd/system/`ï¼ŒçœŸæ­£çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨é‚£ä¸ªç›®å½•ã€‚

### `>`å’Œ`>>`

```shell
#>å’Œ>>
ls -l>a.txt #å°† ls -l æ˜¾ç¤ºçš„å†…å®¹å†™å…¥åˆ° a.txt æ–‡ä»¶,å¦‚æœä¸å­˜åœ¨å°±åˆ›å»º,æ³¨æ„æ˜¯è¦†ç›–
ls -l>>a.txt #å°† ls -l çš„å†…å®¹è¿½åŠ åˆ° a.txt ä¸­

echo $path #ç”¨ echo æŒ‡ä»¤è¾“å‡ºç¯å¢ƒå˜é‡è·¯å¾„
echo "hello">>c.txt  #å°† hello å†™å…¥ c.txt
echo $JAVA_HOME #æŸ¥çœ‹å¤šä¸ªç¯å¢ƒå˜é‡
```



### /dev/null

`1>/dev/null 2>&1`æˆ–`>/dev/null 2>&1`è¡¨ç¤ºæ­¤è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºå’Œ é”™è¯¯è¾“å‡º ,å…¨éƒ¨å¹²æ‰

ç»“åˆ `nohup [sth]  &`,å°±å¯ä»¥å®ç°`åå°è¿è¡Œ,ä¸”ä¸è¾“å‡ºä»»ä½•ä¸œè¥¿`

```shell
é‚£ä¹ˆæœ¬æ–‡æ ‡é¢˜çš„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸ºï¼š

#-1>/dev/null(ä¸¢æ‰æ ‡å‡†è¾“å‡º) ï¼šé¦–å…ˆè¡¨ç¤ºæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸è¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°ç»ˆç«¯ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚

#2>&1(ä¿ºä¹Ÿä¸€æ ·) ï¼šæ¥ç€ï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘ åˆ° æ ‡å‡†è¾“å‡ºï¼Œå› ä¸ºä¹‹å‰æ ‡å‡†è¾“å‡ºå·²ç»é‡å®šå‘åˆ°äº†ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œæ‰€ä»¥æ ‡å‡†é”™#è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ã€‚
```



\> ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼šecho "123" > /home/123.txt 
1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥">/dev/null"ç­‰åŒäº"1>/dev/null" 
2 è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯ 
& è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2>&1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1 

**é‚£ä¹ˆæœ¬æ–‡æ ‡é¢˜çš„è¯­å¥ï¼š** 
1>/dev/null é¦–å…ˆè¡¨ç¤ºæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸è¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°ç»ˆç«¯ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚ 
2>&1 æ¥ç€ï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘ç­‰åŒäº æ ‡å‡†è¾“å‡ºï¼Œå› ä¸ºä¹‹å‰æ ‡å‡†è¾“å‡ºå·²ç»é‡å®šå‘åˆ°äº†ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œæ‰€ä»¥æ ‡å‡†é”™è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ã€‚ 

3ã€/dev/zeroæ–‡ä»¶ä»£è¡¨ä¸€ä¸ªæ°¸è¿œè¾“å‡º 0çš„è®¾å¤‡æ–‡ä»¶ï¼Œä½¿ç”¨å®ƒä½œè¾“å…¥å¯ä»¥å¾—åˆ°å…¨ä¸ºç©ºçš„æ–‡ä»¶ã€‚å› æ­¤å¯ç”¨æ¥åˆ›å»ºæ–°æ–‡ä»¶å’Œä»¥è¦†ç›–çš„æ–¹å¼æ¸…é™¤æ—§æ–‡ä»¶ã€‚ 

ä¸‹é¢ä½¿ç”¨ddå‘½ä»¤å°†ä»zeroè®¾å¤‡ä¸­åˆ›å»ºä¸€ä¸ª10Kå¤§å°ï¼ˆbså†³å®šæ¯æ¬¡è¯»å†™1024å­—èŠ‚ï¼Œcountå®šä¹‰è¯»å†™æ¬¡æ•°ä¸º10æ¬¡ï¼‰ï¼Œä½†å†…å®¹å…¨ä¸º0çš„æ–‡ä»¶ã€‚ 
dd if=/dev/zero of=file count=10 bs=1024

[Shellè„šæœ¬â€”â€”â€”â€” /dev/null 2>&1è¯¦è§£ - Tinywan - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/tinywan/p/6025468.html)



### rm

```shell
#ç§»é™¤æœ‰ç›¸åŒå­—ç¬¦çš„ä¸¤ä¸ªæ–‡ä»¶
rm -f "${HOME}"/.{yabai,skhd}rc
```







### ls

ç”¨æ¥æ˜¾ç¤ºç›®å½•æˆ–å…·ä½“æ–‡ä»¶åˆ—è¡¨

```shell
#æ¯è¡Œåˆ—å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œå³ä»¥å•åˆ—å½¢å¼åˆ—å‡º
$ ls -1
#åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶,åŒ…æ‹¬éšè—æ–‡ä»¶
$ ls -al
#æ‰€æœ‰æ–‡ä»¶çš„é•¿åˆ—è¡¨å½¢å¼(æƒé™,æ‰€æœ‰æƒ,å¤§å°,ä¿®æ”¹æ—¥æœŸ)
$ ls -al
#ä½¿ç”¨äººå¯è¯»å•ä½ï¼ˆKBï¼ŒMBï¼ŒGBï¼‰æ˜¾ç¤ºå¤§å°çš„é•¿æ ¼å¼åˆ—è¡¨
$ ls -lh
#æŒ‰å¤§å°æ’åºçš„é•¿æ ¼å¼åˆ—è¡¨ï¼ˆä»å¤§åˆ°å°ï¼‰
$ ls -lS
#æŒ‰å¤§å°æ’åºçš„é•¿æ ¼å¼åˆ—è¡¨ï¼ˆä»å°åˆ°å¤§ï¼‰
$ ls -ltr
#-t,sort by modification time, newest first
$ ls -t
```

ls ç»“åˆé€šé…ç¬¦

```shell
# Linuxå‘½ä»¤ä¸­ä½¿ç”¨çš„é€šé…ç¬¦æœ‰ ï¼Ÿ * [] ï¼›
$ ls /usr/bin/w*  #åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ä»¥wå¼€å¤´çš„æ–‡ä»¶æˆ–ç›®å½• ï¼›
$ ls /usr/bin/w?? #çš„æ•ˆæœæ˜¯ åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„ä»¥wå¼€å¤´åç§°é•¿åº¦ä¸º3çš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½• ï¼›
$ ls /usr/bin/[xyz]* #çš„æ•ˆæœæ˜¯ åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶åä»¥xæˆ–yæˆ–zå¼€å¤´çš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½• ï¼›
$ ls /usr/bin/[!a-h]* #çš„æ•ˆæœæ˜¯ åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶åä¸ä»¥aåˆ°håŒºé—´å­—æ¯å¼€å¤´çš„æ‰€æœ‰æ–‡ä»¶æˆ–
```

<img src="https://gitee.com/ibepo/ogcip/raw/master/20211126093338.png" alt="image-20211126093337734" style="zoom:50%;" />

### head

> head [å‚æ•°]... [æ–‡ä»¶]...

 headå‘½ä»¤è¾“å‡ºæ–‡ä»¶å¼€å¤´éƒ¨åˆ†ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¾ç¤ºæ–‡ä»¶çš„å¤´10è¡Œã€‚å¦‚æœæŒ‡å®šå¤šä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å‰éƒ½æœ‰ä¸€ä¸ªæ ‡é¢˜ï¼Œç»™å‡ºæ–‡ä»¶åã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šæ–‡ä»¶ï¼Œæˆ–å½“æ–‡ä»¶ä¸º-æ—¶ï¼Œè¯»å–æ ‡å‡†è¾“å…¥ã€‚

```shell
-c,--bytes=[-]K æ˜¾ç¤ºæ–‡ä»¶å‰Kå­—èŠ‚ã€‚å¦‚æœKå‰æœ‰-ï¼Œåˆ™è¡¨ç¤ºæ˜¾ç¤ºé™¤æœ€åKå­—èŠ‚å¤–çš„æ‰€æœ‰å†…å®¹
-n,--lines=[-]K æ˜¾ç¤ºå‰Kè¡Œã€‚å¦‚æœKå‰æœ‰-ï¼Œåˆ™è¡¨ç¤ºæ˜¾ç¤ºé™¤æœ€åKè¡Œå¤–çš„æ‰€æœ‰è¡Œ
-q,--quiet,--silent ä¸æ˜¾ç¤ºæ ‡é¢˜æ–‡ä»¶å
-v,--verbose æ€»æ˜¯æ˜¾ç¤ºæ ‡é¢˜æ–‡ä»¶å
--help æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º
--version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º
```

```shell
#æ˜¾ç¤ºæ–‡ä»¶çš„å‰10è¡Œ
$head -n 10 1.txt

#æ˜¾ç¤ºæ–‡ä»¶çš„å‰10ä¸ªå­—èŠ‚
$head -c 10 1.txt

#æ˜¾ç¤ºä»æ–‡ä»¶å¤´åˆ°å€’æ•°ç¬¬Nä¸ªå­—ç¬¦çš„å†…å®¹
#2,å°±æ˜¯é™¤äº†æ–‡ä»¶æœ«å°¾çš„ä¸¤ä¸ªå­—ç¬¦ä¸æ˜¾ç¤º,å…¶ä½™éƒ½æ˜¾ç¤º
$head -c -2 1.txt 
```

```shell
$tail -10ï¼š æŸ¥çœ‹æ–‡ä»¶çš„å°¾éƒ¨çš„10è¡Œ
$head -20ï¼šæŸ¥çœ‹æ–‡ä»¶çš„å¤´éƒ¨20è¡Œ
```

å®æˆ˜

åˆ—å‡ºæ–‡ä»¶å¤¹ä¸­æ‰€æœ‰çš„ txt æ ¼å¼çš„æ–‡æ¡£,æŒ‰æ—¶é—´æ’åº å–å‡ºæœ€æ–°çš„ä¸€ä¸ª
æ³¨æ„ `bash`ä¸‹å¯ä»¥ `ls  sth -t`,ä½†æ˜¯`zsh `ä¸‹,è¦æŒ‰ç…§æ­£å¸¸çš„`ls -t  sth`

```shell
$ls  *.txt -t |head -1
```



### ln

```bash
#ln è½¯è¿æ¥æŒ‡ä»¤,ç¬¦å·é“¾æ¥,ç±»ä¼¼äºå¿«æ·æ–¹å¼
ln -s[åŸæ–‡ä»¶æˆ–ç›®å½•][è½¯è¿æ¥]
# åœ¨/home ä¸‹åˆ›å»ºä¸€ä¸ªè½¯è¿æ¥ linktotest è¿æ¥åˆ°/root ç›®å½•
#[å½“å‰åœ¨/home ç›®å½•ä¸‹] ln -s /root linktotest
# åˆ é™¤è½¯è¿æ¥,è™½ç„¶è½¯è¿æ¥æ˜¯ä¸ªæ–‡ä»¶å¤¹ ä½†æ˜¯ä¸è¦å¸¦æ–œæ 
rm -rf linktotest
```

### history

```bash
# æ˜¾ç¤ºæ‰§è¡Œè¿‡çš„æ‰€æœ‰åˆ¶ä»¤
history
# æ‰§è¡Œå†å²ç¼–å·ä¸º 5 çš„æŒ‡ä»¤
history 5
```

### which

`which`æŒ‡ä»¤ä¼šåœ¨ç¯å¢ƒå˜é‡`$PATH`è®¾ç½®çš„ç›®å½•é‡ŒæŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶

```bash
#æŸ¥æ‰¾æŸä¸ªå‘½ä»¤çš„å…·ä½“ä½ç½®
$ which nvim
```

### whereis

æœ‰æ—¶ï¼Œåœ¨ä½¿ç”¨å‘½ä»¤è¡Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¿«é€Ÿæ‰¾åˆ°æŸä¸€ä¸ªå‘½ä»¤çš„äºŒè¿›åˆ¶æ–‡ä»¶æ‰€åœ¨ä½ç½®ã€‚è¿™ç§æƒ…å†µä¸‹å¯ä»¥é€‰æ‹© find å‘½ä»¤ï¼Œä½†ä½¿ç”¨å®ƒä¼šè€—è´¹æ—¶é—´ï¼Œå¯èƒ½ä¹Ÿä¼šå‡ºç°æ„æ–™ä¹‹å¤–çš„æƒ…å†µã€‚æœ‰ä¸€ä¸ªä¸“é—¨ä¸ºè¿™ç§æƒ…å†µè®¾è®¡çš„å‘½ä»¤ï¼š`whereis`

```bash
$ whereis systemd                                                        
systemd: /usr/lib/systemd /etc/systemd /usr/share/systemd /usr/share/man/man1/systemd.1.gz  
```

### w

å¯ä»¥çœ‹åˆ°æœ‰å“ªäº›ç”¨æˆ·ä»¥åŠä¸»æœºç™»é™†äº†è¿™å°æœºå™¨

`load average`

linux ä¸­çš„`load`æ˜¯å¯¹å½“å‰ CPU å·¥ä½œé‡çš„åº¦é‡,ç®€å•çš„è¯´å°±æ˜¯è¿›ç¨‹é˜Ÿåˆ—çš„é•¿åº¦

`load average`å°±æ˜¯ä¸€æ®µæ—¶é—´(1 åˆ†é’Ÿ,5 åˆ†é’Ÿ,15 åˆ†é’Ÿ)å†…å¹³å‡`load`

ç¬¬ä¸€è¡Œæ•°æ®ä»å‰å¾€ååˆ†åˆ«æ˜¯ 1 åˆ†é’Ÿ,5 åˆ†é’Ÿ,15 åˆ†é’Ÿçš„è´Ÿè½½

æ³¨:`linux`ç³»ç»Ÿæ˜¯ 5 ç§’é’Ÿè¿›è¡Œä¸€æ¬¡ load é‡‡æ ·.

```shell
ubuntu@timehouse:~$ w
 09:05:31 up 71 days, 21:34,  1 user,  load average: 0.02, 0.05, 0.06
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
ubuntu   pts/0    106.117.224.230  09:04    0.00s  0.01s  0.00s w
```

```shell
æŸ¥çœ‹cpu æ ¸æ•°å‘½ä»¤
$ grep 'model name' /proc/cpuinfo | wc -l
```



### chmod

`chmod`ä¿®æ”¹æ–‡ä»¶æƒé™

```shell
#å°† xxx/logos ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ‰§è¡Œå…¨éƒ¨ç»„å¯è¯»æƒé™
$ /panghu/nav/nginx/html/nav/assets/images/logos# chmod 644 *
```

```shell
mkdir -p #-p, --parents     éœ€è¦æ—¶åˆ›å»ºä¸Šå±‚ç›®å½•ï¼Œå¦‚ç›®å½•æ—©å·²å­˜åœ¨åˆ™ä¸å½“ä½œé”™è¯¯
cat /etc/passwd #æŸ¥çœ‹ç”¨æˆ·
chmod -R  777 /dir   #å°†æ­¤æ–‡ä»¶å¤¹çš„æƒé™è®¾ä¸ºè°éƒ½å¯ä»¥
chown -R  ibepo:dev  /home/ibepo  #ä¿®æ”¹ç›®å½•çš„æ‹¥æœ‰è€…æ˜¯rootç”¨æˆ·å’Œrootç»„ 
```



#### `-rw-rw-r-- `

æœ€å‰é¢é‚£ä¸ª - ä»£è¡¨çš„æ˜¯ç±»å‹(-æ–‡ä»¶ d æ–‡ä»¶å¤¹)
ä¸­é—´é‚£ä¸‰ä¸ª rw- ä»£è¡¨çš„æ˜¯æ‰€æœ‰è€…ï¼ˆuserï¼‰
ç„¶åé‚£ä¸‰ä¸ª rw- ä»£è¡¨çš„æ˜¯ç»„ç¾¤ï¼ˆgroupï¼‰
æœ€åé‚£ä¸‰ä¸ª r-- ä»£è¡¨çš„æ˜¯å…¶ä»–äººï¼ˆotherï¼‰

`r` è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«è¯»ï¼ˆreadï¼‰

 `w `è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«å†™ï¼ˆwriteï¼‰

 `x `è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«æ‰§è¡Œï¼ˆå¦‚æœå®ƒæ˜¯ç¨‹åºçš„è¯ï¼‰ - è¡¨ç¤ºç›¸åº”çš„æƒé™è¿˜æ²¡æœ‰è¢«æˆäºˆ

#### å¸¸è§æƒé™

|  æƒé™è¡¨ç¤º  | æƒé™ä»£ç  |  æ‰€æœ‰è€…æƒé™  |   ç¾¤ç»„æƒé™   |  æ‰€æœ‰äººæƒé™  |
| :--------: | :------: | :----------: | :----------: | :----------: |
| -rwxrwxrwx |   777    | è¯»ã€å†™ã€æ‰§è¡Œ | è¯»ã€å†™ã€æ‰§è¡Œ | è¯»ã€å†™ã€æ‰§è¡Œ |
| -rw-rw-rw- |   666    |    è¯»ã€å†™    |    è¯»ã€å†™    |    è¯»ã€å†™    |
| -rw------- |   600    |    è¯»ã€å†™    |      -       |      -       |
| -rw-râ€“r--  |   644    |    è¯»ã€å†™    |      è¯»      |      è¯»      |
| -rwx------ |   700    | è¯»ã€å†™ã€æ‰§è¡Œ |      -       |      -       |
| -rwxr-xr-x |   755    | è¯»ã€å†™ã€æ‰§è¡Œ |   è¯»ã€æ‰§è¡Œ   |   è¯»ã€æ‰§è¡Œ   |
| -rwxâ€“x--x  |   711    | è¯»ã€å†™ã€æ‰§è¡Œ |     æ‰§è¡Œ     |     æ‰§è¡Œ     |

#### ä¿®æ”¹æƒé™

```
# æ–‡ä»¶
chmod 777 demo.txt  # ä¸€ä¸ªæ–‡ä»¶ å¯å†™å¯è¯»å¯æ‰§è¡Œ

chmod 777 *.txt   # ç›®å½•ä¸‹æ‰€æœ‰ txt æ–‡ä»¶ å¯å†™å¯è¯»å¯æ‰§è¡Œ

chmod 777 *.*  # ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ å¯å†™å¯è¯»å¯æ‰§è¡Œ

# ç›®å½•
chmod 777 /demo  # ç›®å½• å¯å†™å¯è¯»å¯æ‰§è¡Œ

chmod 777 *  # ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å¤¹

chmod -R 777 /demo   # ä¿®æ”¹æ–‡ä»¶å¤¹å†…æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹åŠå­æ–‡ä»¶å¤¹

```

u ä»£è¡¨æ‰€æœ‰è€…ï¼ˆuserï¼‰
g ä»£è¡¨æ‰€æœ‰è€…æ‰€åœ¨çš„ç»„ç¾¤ï¼ˆgroupï¼‰
o ä»£è¡¨å…¶ä»–äººï¼Œä½†ä¸æ˜¯uå’Œg ï¼ˆotherï¼‰
a ä»£è¡¨å…¨éƒ¨çš„äººï¼Œä¹Ÿå°±æ˜¯åŒ…æ‹¬uï¼Œgå’Œo
r è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«è¯»ï¼ˆreadï¼‰
w è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«å†™ï¼ˆwriteï¼‰
x è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¢«æ‰§è¡Œï¼ˆå¦‚æœå®ƒæ˜¯ç¨‹åºçš„è¯ï¼‰

å…¶ä¸­ï¼šrwxä¹Ÿå¯ä»¥ç”¨æ•°å­—æ¥ä»£æ›¿

```
r ------------4
w ------------2
x ------------1
- ------------0
```

### paste

```shell
paste file1 file2         #åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹
paste -d '+' file1 file2  #åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ï¼Œä¸­é—´ç”¨"+"åŒºåˆ†
```



### sort

```shell
sort file1 file2           #æ’åºä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹
sort file1 file2 | uniq    #å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„å¹¶é›†(é‡å¤çš„è¡Œåªä¿ç•™ä¸€ä»½)
sort file1 file2 | uniq -u #åˆ é™¤äº¤é›†ï¼Œç•™ä¸‹å…¶ä»–çš„è¡Œ
sort file1 file2 | uniq -d #å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„äº¤é›†(åªç•™ä¸‹åŒæ—¶å­˜åœ¨äºä¸¤ä¸ªæ–‡ä»¶ä¸­çš„æ–‡ä»¶)

```

### tar

```shell
ï¼ˆå¯¹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…ï¼Œé»˜è®¤æƒ…å†µå¹¶ä¸ä¼šå‹ç¼©ï¼Œå¦‚æœæŒ‡å®šäº†ç›¸åº”çš„å‚æ•°ï¼Œå®ƒè¿˜ä¼šè°ƒç”¨ç›¸åº”çš„å‹ç¼©ç¨‹åºï¼ˆå¦‚gzipå’Œbzipç­‰ï¼‰è¿›è¡Œå‹ç¼©å’Œè§£å‹ï¼‰
-c         # å°å†™cæ–°å»ºæ‰“åŒ…æ–‡ä»¶
-t         #æŸ¥çœ‹æ‰“åŒ…æ–‡ä»¶çš„å†…å®¹å«æœ‰å“ªäº›æ–‡ä»¶å
-x         #è§£æ‰“åŒ…æˆ–è§£å‹ç¼©çš„åŠŸèƒ½ï¼Œå¯ä»¥æ­é…-Cï¼ˆå¤§å†™ï¼‰æŒ‡å®šè§£å‹çš„ç›®å½•ï¼Œæ³¨æ„-c,-t,-xä¸èƒ½åŒæ—¶å‡ºç°åœ¨åŒä¸€æ¡å‘½ä»¤ä¸­
-j         #é€šè¿‡bzip2çš„æ”¯æŒè¿›è¡Œå‹ç¼©/è§£å‹ç¼©
-z         #é€šè¿‡gzipçš„æ”¯æŒè¿›è¡Œå‹ç¼©/è§£å‹ç¼©
-v         #åœ¨å‹ç¼©/è§£å‹ç¼©è¿‡ç¨‹ä¸­ï¼Œå°†æ­£åœ¨å¤„ç†çš„æ–‡ä»¶åæ˜¾ç¤ºå‡ºæ¥
-f filename#filenameä¸ºè¦å¤„ç†çš„æ–‡ä»¶
-C dir     #æŒ‡å®šå‹ç¼©/è§£å‹ç¼©çš„ç›®å½•dir
å‹ç¼©ï¼štar -jcv -f filename.tar.bz2 è¦è¢«å¤„ç†çš„æ–‡ä»¶æˆ–ç›®å½•åç§°
æŸ¥è¯¢ï¼štar -jtv -f filename.tar.bz2
è§£å‹ï¼štar -jxv -f filename.tar.bz2 -C æ¬²è§£å‹ç¼©çš„ç›®å½•
bunzip2 file1.bz2 #è§£å‹ä¸€ä¸ªå«åš 'file1.bz2'çš„æ–‡ä»¶
bzip2 file1       #å‹ç¼©ä¸€ä¸ªå«åš 'file1' çš„æ–‡ä»¶
gunzip file1.gz   #è§£å‹ä¸€ä¸ªå«åš 'file1.gz'çš„æ–‡ä»¶
gzip file1        #å‹ç¼©ä¸€ä¸ªå«åš 'file1'çš„æ–‡ä»¶
gzip -9 file1     #æœ€å¤§ç¨‹åº¦å‹ç¼©
rar a file1.rar test_file åˆ›å»ºä¸€ä¸ªå«åš 'file1.rar' çš„åŒ…
tar -xzvf file.tar.gz #è§£å‹tar.gz
```





### grep/sed/awk

æµ‹è¯•æ–‡æœ¬

```
cat caatbar catfoobar
```

åŒ¹é…å¸¦æœ‰å­—ç¬¦` cat` çš„æ–‡æœ¬

```/cat/```

åŒ¹é…c åè¾¹è‡³å°‘æœ‰ä¸€ä¸ª `a`çš„æ–‡æœ¬

```
/cat{1,}/
```

åªåŒ¹é… cat,`\b`å­—ç¬¦è¾¹ç•Œ

```
/\bcat\b/
```

é«˜å±æ“ä½œ

```shell
#ï¼ˆåˆ†æä¸€è¡Œçš„ä¿¡æ¯ï¼Œè‹¥å½“ä¸­æœ‰æˆ‘ä»¬æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œå°±å°†è¯¥è¡Œæ˜¾ç¤ºå‡ºæ¥ï¼Œè¯¥å‘½ä»¤é€šå¸¸ä¸ç®¡é“å‘½ä»¤ä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºå¯¹ä¸€äº›å‘½ä»¤çš„è¾“å‡ºè¿›è¡Œç­›é€‰åŠ å·¥ç­‰ç­‰ï¼‰

grep Aug /var/log/messages  #åœ¨æ–‡ä»¶ '/var/log/messages'ä¸­æŸ¥æ‰¾å…³é”®è¯"Aug"
grep ^Aug /var/log/messages #åœ¨æ–‡ä»¶ '/var/log/messages'ä¸­æŸ¥æ‰¾ä»¥"Aug"å¼€å§‹çš„è¯æ±‡
grep [0-9] /var/log/messages #é€‰æ‹© '/var/log/messages' æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«æ•°å­—çš„è¡Œ
grep Aug -R /var/log/*       # åœ¨ç›®å½• '/var/log' åŠéšåçš„ç›®å½•ä¸­æœç´¢å­—ç¬¦ä¸²"Aug"

#å°†example.txtæ–‡ä»¶ä¸­çš„ "string1" æ›¿æ¢æˆ "string2"
sed 's/stringa1/stringa2/g' example.txt 
#ä»example.txtæ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œï¼Œå‰é¢çš„^æŒ‡è¡Œé¦–ï¼Œ$æŒ‡è¡Œå°¾ï¼Œæœ€åçš„dæŒ‡åˆ é™¤çš„æ„æ€ã€‚
sed '/^$/d' example.txt                 
```



-  https://juejin.cn/post/6844903845227659271



### brctl

`ç½‘æ¡¥ç®¡ç†å·¥å…·brctl `

```shell
#Centosç³»ç»Ÿ
$ yum install bridge-utils

#Ubuntuç³»ç»Ÿ   
$ apt-get  install bridge-utils

#æ˜¾ç¤ºæ‰€æœ‰çš„ç½‘æ¡¥ä¿¡æ¯
$ sudo brctl show

#æ˜¾ç¤ºæŸä¸ªç½‘æ¡¥(br0)çš„ä¿¡æ¯
$ sudo brctl show br0
```



### lsof

`lsof`(list open files)æ˜¯ä¸€ä¸ªåˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶çš„å·¥å…·ã€‚

```bash
#åˆ—å‡ºæ‰€æœ‰çš„ç«¯å£å ç”¨æƒ…å†µ
$ lsof -i
#æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ
$ lsof -i:8080

$ lsof abc.txt                       #æ˜¾ç¤ºå¼€å¯æ–‡ä»¶abc.txtçš„è¿›ç¨‹
$ lsof -c abcï¼š                      #æ˜¾ç¤ºabcè¿›ç¨‹ç°åœ¨æ‰“å¼€çš„æ–‡ä»¶
$ lsof -c -p 1234                    #åˆ—å‡ºè¿›ç¨‹å·ä¸º1234çš„è¿›ç¨‹æ‰€æ‰“å¼€çš„æ–‡ä»¶
$ lsof -g gid                        #æ˜¾ç¤ºå½’å±gidçš„è¿›ç¨‹æƒ…å†µ
$ lsof +d /usr/local/                #æ˜¾ç¤ºç›®å½•ä¸‹è¢«è¿›ç¨‹å¼€å¯çš„æ–‡ä»¶
$ lsof +D /usr/local/                #åŒä¸Šï¼Œä½†æ˜¯ä¼šæœç´¢ç›®å½•ä¸‹çš„ç›®å½•ï¼Œæ—¶é—´è¾ƒé•¿
$ lsof -d 4                          #æ˜¾ç¤ºä½¿ç”¨fdä¸º4çš„è¿›ç¨‹
$ lsof -i -U                         #æ˜¾ç¤ºæ‰€æœ‰æ‰“å¼€çš„ç«¯å£å’ŒUNIX domainæ–‡ä»¶
```



### netstat

```bash
$ netstat -ntlp   //æŸ¥çœ‹å½“å‰æ‰€æœ‰tcpç«¯å£

$ netstat -ntulp | grep 80   //æŸ¥çœ‹æ‰€æœ‰80ç«¯å£ä½¿ç”¨æƒ…å†µ

$ netstat -ntulp | grep 3306   //æŸ¥çœ‹æ‰€æœ‰3306ç«¯å£ä½¿ç”¨æƒ…å†µ

$ netstat -tunpl
```

å‚æ•°é¡¹

- -t (tcp) ä»…æ˜¾ç¤ºtcpç›¸å…³é€‰é¡¹

- -u (udp)ä»…æ˜¾ç¤ºudpç›¸å…³é€‰é¡¹

- -n æ‹’ç»æ˜¾ç¤ºåˆ«åï¼Œèƒ½æ˜¾ç¤ºæ•°å­—çš„å…¨éƒ¨è½¬åŒ–ä¸ºæ•°å­—

- -l ä»…åˆ—å‡ºåœ¨Listen(ç›‘å¬)çš„æœåŠ¡çŠ¶æ€

- -p æ˜¾ç¤ºå»ºç«‹ç›¸å…³é“¾æ¥çš„ç¨‹åºå

### rsync

`rsync` è¢«ç”¨æ¥ä¸è¿œç¨‹æœåŠ¡å™¨é—´ä¼ é€æ–‡ä»¶ï¼Œä¸ `scp` ç±»ä¼¼ï¼Œä½† `rsync` å¯ä»¥å®ç°å¢é‡ä¼ é€

å¦‚éœ€è¦ä¼ è¾“k8sæ‰€éœ€è¦çš„é•œåƒå‹ç¼©åŒ…æ—¶: é¦–æ¬¡æ‰“åŒ…äº†æ€»å…±5ä¸ªé•œåƒä¸º k8s.tarï¼Œä¼ è¾“åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚éšåå‘ç°ä¸€ä¸ªé•œåƒæ²¡æœ‰æ‰“åŒ…ï¼Œäºæ˜¯å†æ¬¡æ‰“åŒ…ï¼Œæ€»å…±6ä¸ªé•œåƒä¸º k8s.tarï¼Œå†æ¬¡ä¼ è¾“åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚`rsync` å¯ä»¥å¯¹æ¯”æ–‡ä»¶å·®å¼‚è€Œåšåˆ°ä»…ä¼ è¾“æœ€åä¸€æ¬¡ä¸¢æ‰çš„é•œåƒã€‚

```shell
# æŠŠæœ¬æœºçš„ k8s.tar ä¼ é€åˆ° shanyue æœåŠ¡å™¨çš„ /root ç›®å½•
# -a ä»£è¡¨å½’æ¡£
# -v ä»£è¡¨æ‰“å°è¯¦ç»†ä¿¡æ¯ï¼Œè¿™ä¸ªå‚æ•°å¾ˆå¸¸è§äº† --verbose
# -h ä»£è¡¨æ‰“å°å¯è¯»æ€§å¥½çš„ä¿¡æ¯ï¼Œè¿™ä¸ªå‚æ•°ä¹Ÿå¾ˆå¸¸è§ --human-readable
# -z ä»£è¡¨æ‰“åŒ…ä¼ é€ï¼Œå‡å°ä¼ é€ä½“ç§¯
$ rsync -avhzP k8s.tar shanyue:/root
```

### é˜²ç«å¢™

```bash
netstat -ntlp   #æŸ¥çœ‹å½“å‰æ‰€æœ‰tcpç«¯å£
netstat -ntulp |grep 1935   #æŸ¥çœ‹æ‰€æœ‰1935ç«¯å£ä½¿ç”¨æƒ…å†µ
tt -tal #æŸ¥çœ‹ soket å¥—æ¥å­—è¿è¡ŒçŠ¶å†µ
systemctl start firewalld #å¼€å¯é˜²ç«å¢™ 
```

```bash
#å¼€æ”¾æŒ‡å®šç«¯å£
# å‘½ä»¤å«ä¹‰ï¼š
#--zone #ä½œç”¨åŸŸ
#--add-port=1935/tcp  #æ·»åŠ ç«¯å£ï¼Œæ ¼å¼ä¸ºï¼šç«¯å£/é€šè®¯åè®®
#--permanent  #æ°¸ä¹…ç”Ÿæ•ˆï¼Œæ²¡æœ‰æ­¤å‚æ•°é‡å¯åå¤±æ•ˆ
firewall-cmd --zone=public --add-port=1935/tcp --permanent    
```

```bash
firewall-cmd --reload #é‡å¯é˜²ç«å¢™
```

### curl

[curl çš„ç”¨æ³•æŒ‡å— - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— (ruanyifeng.com)](http://www.ruanyifeng.com/blog/2019/09/curl-reference.html)

[è¿˜åœ¨ç”¨ Postmanï¼Ÿæ‰‹æŠŠæ‰‹æ•™ä½ ç”¨ Curl æé«˜å·¥ä½œæ•ˆç‡](https://developer.51cto.com/art/202111/689151.htm)


```bash

#curl,
#ä¸‹è¾¹ä»£ç æ¼”ç¤ºçš„æ˜¯é€šè¿‡ curl ä¸‹è½½ docker-compose,å¹¶ä¸‹è½½åˆ°æŒ‡å®šä½ç½®,ç„¶åå¢åŠ æ‰§è¡Œçš„æƒé™ç»™å…¨å±€

curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose

#-L è·Ÿéšé‡å®šå‘è·³è½¬
#-oå‚æ•°å°†æœåŠ¡å™¨çš„å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œç­‰åŒäºwgetå‘½ä»¤ã€‚
#-Oå‚æ•°å°†æœåŠ¡å™¨å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œå¹¶å°† URL çš„æœ€åéƒ¨åˆ†å½“ä½œæ–‡ä»¶åã€‚
#-så‚æ•°å°†ä¸è¾“å‡ºé”™è¯¯å’Œè¿›åº¦ä¿¡æ¯
#-Så‚æ•°æŒ‡å®šåªè¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œé€šå¸¸ä¸-sä¸€èµ·ä½¿ç”¨ã€‚
#-vå‚æ•°è¾“å‡ºé€šä¿¡çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç”¨äºè°ƒè¯•ã€‚
#-xå‚æ•°æŒ‡å®š HTTP è¯·æ±‚çš„ä»£ç†ã€‚
#-Xå‚æ•°æŒ‡å®š HTTP è¯·æ±‚çš„æ–¹æ³•ã€‚
chmod +x /usr/local/bin/docker-compose
```

`curl`é«˜é¢‘æ“ä½œ

```shell
# å‘é€ get è¯·æ±‚
$ curl www.baidu.com

# ä½¿ç”¨-ié€‰é¡¹,æ‰“å°æœåŠ¡å™¨å“åº”çš„httpå¤´éƒ¨ä¿¡æ¯
$ curl -i www.baidu.com

# ä½¿-l é€‰é¡¹,æ‰“å°å“åº”å¤´ä¿¡æ¯,æ³¨æ„æ­¤æ—¶å‘é€çš„æ˜¯ head è¯·æ±‚
# -I å‘æœåŠ¡å™¨å‘é€HEADè¯·æ±‚ --head ç­‰åŒäºã€-Iã€‘
$ curl -l www.baidu.com

# é€šè¿‡-Hé€‰é¡¹,å¯ä»¥ä¸ºè¯·æ±‚æ·»åŠ å¤´
# å¯ä»¥æŒ‡å®šå¤šä¸ª-Hé€‰é¡¹ 
$ curl -H 'Accept-Language: en-US' -H 'Secret-Message: xyzzy' http://google.com 

#ä½¿ç”¨ -o æˆ– -O é€‰é¡¹ï¼Œå¯ä»¥å°†ç½‘ç»œèµ„æºä¿å­˜åˆ°æ–‡ä»¶ä¸­
#å¦‚æœæƒ³æ˜¾ç¤ºä¸‹è½½è¿›åº¦æ¡ï¼Œå¯ä»¥ä½¿ç”¨ -# é€‰é¡¹
# ç­‰æ•ˆäº wget 
$ curl -o chopin.html http://linuxblogs.cn 
# -O é€‰é¡¹ï¼Œå¯ä»¥å°† URL çš„æœ€åéƒ¨åˆ†å½“åšæ–‡ä»¶å 
$ curl -O http://linuxblogs.cn/bar.html 


#æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ > ç¬¦å·å°†è¾“å‡ºé‡å®šå‘åˆ°æœ¬åœ°æ–‡ä»¶ä¸­
curl http://www.baidu.com > index.html
```

##### é€‰é¡¹

- -A æŒ‡å®šUser-Agent
- -b å‘é€Cookie
- -c Cookieå†™å…¥æ–‡ä»¶
- -D è¾“å‡ºå“åº”æ ‡å¤´
- -d å‘é€è¯·æ±‚å¯¹ï¼Œé»˜è®¤å‘é€POSTè¯·æ±‚ï¼Œä¸”HTTP è¯·æ±‚åŠ ä¸Šæ ‡å¤´ã€Content-Type : application/x-www-form-urlencodedã€‘ï¼Œã€-Gã€‘å¯ä»¥è¦†ç›–é»˜è®¤è®¾ç½®
- --data-urlencode ç±»ä¼¼-dï¼Œæ•°æ®ä¼šè¿›è¡ŒURLç¼–ç 
- -e è®¾ç½®Referer
- -F ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒHTTP è¯·æ±‚åŠ ä¸Šæ ‡å¤´ã€Content-Type: multipart/form-dataã€‘
- -G å‘é€GETè¯·æ±‚
- -H æ·»åŠ HTTPè¯·æ±‚çš„æ ‡å¤´
- --head ç­‰åŒäºã€-Iã€‘
- -i æ‰“å°æœåŠ¡å™¨è¿”å›çš„HTTPæ ‡å¤´
- -I å‘æœåŠ¡å™¨å‘é€HEADè¯·æ±‚
- -L HTTPè¯·æ±‚è·ŸéšæœåŠ¡å™¨çš„é‡å®šå‘ï¼Œé»˜è®¤ä¸é‡å®šå‘
- --limit-rate é™åˆ¶å¸¦å®½
- -m è®¾ç½®è¶…æ—¶æ—¶é—´
- -M æ˜¾ç¤ºcurlæ‰‹å†Œ
- -o ã€æ–‡ä»¶åã€‘æœåŠ¡å™¨çš„å›åº”ä¿å­˜æˆæ–‡ä»¶
- -O æœåŠ¡å™¨çš„å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œè‡ªåŠ¨å‘½å
- -s å®‰é™æ¨¡å¼
- -S è¦†ç›–-sï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯
- -T ä¸Šä¼ æ–‡ä»¶
- -u è®¾ç½®ç™»å½•ç”¨æˆ·åå’Œå¯†ç 
- -v è¾“å‡ºé€šä¿¡æ•´ä¸ªè¿‡ç¨‹
- -x æŒ‡å®šHTTPè¯·æ±‚çš„ä»£ç†
- -X æŒ‡å®šHTTPè¯·æ±‚æ–¹æ³•



### wget

```bash
wget

```

### ps 

[~~LinuxæŸ¥çœ‹æ‰€æœ‰serviceçš„çŠ¶æ€~~](https://blog.csdn.net/weixin_40367126/article/details/104670163 )

[æœåŠ¡å™¨ç›‘æ§æŒ‡æ ‡å°è®° - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/90303333)

[linuxæ¯æ—¥å‘½ä»¤(34):pså‘½ä»¤å’Œpstreeå‘½ä»¤ - Aray007 - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/zhongbokun/p/10296760.html)

```bash
#ps
ps -A #æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹
ps -ef #æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹è¿å¸¦å‘½ä»¤è¡Œ
ps -ef|grep mysql  #æŸ¥çœ‹mysqlè¿›ç¨‹
ps -u root #æ˜¾ç¤º root ç”¨æˆ·çš„è¿›ç¨‹çŠ¶æ€
ps -l #åˆ—å‡ºè¿™æ¬¡ç™»é™†çš„ pid å’Œä¸å…¶ç›¸å…³çš„çŠ¶æ€,åœ¨é¢„è®¾çš„æƒ…å†µä¸‹ï¼Œ ps ä»…ä¼šåˆ—å‡ºä¸ç›®å‰æ‰€åœ¨çš„ bash shell æœ‰å…³çš„ PID è€Œå·²ï¼Œæ‰€ä»¥ï¼Œ å½“æˆ‘ä½¿ç”¨ ps -l çš„æ—¶å€™ï¼Œåªæœ‰ä¸‰ä¸ª PIDã€‚
ps -axjf #ä»¥ç±»ä¼¼è¿›ç¨‹æ ‘çš„ç»“æ„æ˜¾ç¤º
ps -aux | more #å¯ä»¥ç”¨ | ç®¡é“å’Œ more è¿æ¥èµ·æ¥åˆ†é¡µæŸ¥çœ‹
```

```shell
ï¼ˆç”¨äºå°†æŸä¸ªæ—¶é—´ç‚¹çš„è¿›ç¨‹è¿è¡Œæƒ…å†µé€‰å–ä¸‹æ¥å¹¶è¾“å‡ºï¼Œprocessä¹‹æ„ï¼‰

-a      #æ‰€æœ‰çš„è¿›ç¨‹å‡æ˜¾ç¤ºå‡ºæ¥
-u      #æœ‰æ•ˆç”¨æˆ·çš„ç›¸å…³è¿›ç¨‹
-l      #è¾ƒé•¿ï¼Œè¾ƒè¯¦ç»†åœ°å°†PIDçš„ä¿¡æ¯åˆ—å‡º
-f      #å±•ç¤ºå‡ºè¿›ç¨‹çš„uids, ppids
```

```shell
ps aux # æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰çš„è¿›ç¨‹æ•°æ®
ps ax  # æŸ¥çœ‹ä¸ä¸terminalæœ‰å…³çš„æ‰€æœ‰è¿›ç¨‹
ps -lA # æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰çš„è¿›ç¨‹æ•°æ®
ps axjf # æŸ¥çœ‹è¿åŒä¸€éƒ¨åˆ†è¿›ç¨‹æ ‘çŠ¶æ€
```



å‘½ä»¤è¡Œé€‰é¡¹

| å‚æ•° | æè¿°                                             |
| ---- | ------------------------------------------------ |
| -A   | åˆ—å‡ºæ‰€æœ‰çš„è¡Œç¨‹                                   |
| -e   | ç­‰äºâ€œ-Aâ€                                         |
| -a   | æ˜¾ç¤ºç°è¡Œç»ˆç«¯æœºä¸‹çš„æ‰€æœ‰è¿›ç¨‹ï¼ŒåŒ…æ‹¬å…¶ä»–ç”¨æˆ·çš„è¿›ç¨‹ï¼› |
| -u   | ä»¥ç”¨æˆ·ä¸ºä¸»çš„è¿›ç¨‹çŠ¶æ€ ï¼›                          |
| x    | é€šå¸¸ä¸ a è¿™ä¸ªå‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œå¯åˆ—å‡ºè¾ƒå®Œæ•´ä¿¡æ¯ã€‚    |
| -w   | æ˜¾ç¤ºåŠ å®½å¯ä»¥æ˜¾ç¤ºè¾ƒå¤šçš„èµ„è®¯                       |
| -au  | æ˜¾ç¤ºè¾ƒè¯¦ç»†çš„èµ„è®¯                                 |
| -aux | æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶ä»–ä½¿ç”¨è€…çš„è¡Œç¨‹                     |
| -f   | åšä¸€ä¸ªæ›´ä¸ºå®Œæ•´çš„è¾“å‡ºã€‚                           |

å„ç›¸å…³ä¿¡æ¯çš„æ„ä¹‰

| æ ‡å¿—  | æ„ä¹‰                                                         |
| ----- | ------------------------------------------------------------ |
| F     | ä»£è¡¨è¿™ä¸ªç¨‹åºçš„æ——æ ‡ (flag)ï¼Œ 4 ä»£è¡¨ä½¿ç”¨è€…ä¸º super user        |
| S     | ä»£è¡¨è¿™ä¸ªç¨‹åºçš„çŠ¶æ€ (STAT)ï¼Œå…³äºå„ STAT çš„æ„ä¹‰å°†åœ¨å†…æ–‡ä»‹ç»(å‚è§é™„è¡¨â‘ ) |
| UID   | ç¨‹åºè¢«è¯¥ UID æ‰€æ‹¥æœ‰                                          |
| PID   | å°±æ˜¯è¿™ä¸ªç¨‹åºçš„ ID ï¼                                         |
| PPID  | åˆ™æ˜¯å…¶ä¸Šçº§çˆ¶ç¨‹åºçš„ID                                         |
| C     | CPU ä½¿ç”¨çš„èµ„æºç™¾åˆ†æ¯”                                         |
| PRI   | æŒ‡è¿›ç¨‹çš„æ‰§è¡Œä¼˜å…ˆæƒ(Priorityçš„ç®€å†™)ï¼Œå…¶å€¼è¶Šå°è¶Šæ—©è¢«æ‰§è¡Œï¼›     |
| NI    | è¿™ä¸ªè¿›ç¨‹çš„niceå€¼ï¼Œå…¶è¡¨ç¤ºè¿›ç¨‹å¯è¢«æ‰§è¡Œçš„ä¼˜å…ˆçº§çš„ä¿®æ­£æ•°å€¼ã€‚     |
| ADDR  | è¿™ä¸ªæ˜¯å†…æ ¸å‡½æ•°ï¼ŒæŒ‡å‡ºè¯¥ç¨‹åºåœ¨å†…å­˜çš„é‚£ä¸ªéƒ¨åˆ†ã€‚å¦‚æœæ˜¯ä¸ª runningçš„ç¨‹åºï¼Œä¸€èˆ¬å°±æ˜¯ "-" |
| SZ    | ä½¿ç”¨æ‰çš„å†…å­˜å¤§å°                                             |
| WCHAN | ç›®å‰è¿™ä¸ªç¨‹åºæ˜¯å¦æ­£åœ¨è¿ä½œå½“ä¸­ï¼Œè‹¥ä¸º - è¡¨ç¤ºæ­£åœ¨è¿ä½œ            |
| TTY   | ç™»å…¥è€…çš„ç»ˆç«¯æœºä½ç½®                                           |
| TIME  | ä½¿ç”¨æ‰çš„ CPU æ—¶é—´ã€‚                                          |
| CMD   | æ‰€ä¸‹è¾¾çš„æŒ‡ä»¤ä¸ºä½•                                             |

é™„è¡¨â‘ [pså·¥å…·æ ‡è¯†è¿›ç¨‹çš„5ç§çŠ¶æ€ç ]

- D ï¼šä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)
- R ï¼šè¯¥ç¨‹åºç›®å‰æ­£åœ¨è¿ä½œï¼Œæˆ–è€…æ˜¯å¯è¢«è¿ä½œ
- S ï¼šè¯¥ç¨‹åºç›®å‰æ­£åœ¨ç¡çœ å½“ä¸­ (å¯è¯´æ˜¯ idle çŠ¶æ€)ï¼Œä½†å¯è¢«æŸäº›è®¯å· (signal) å”¤é†’ã€‚
- T ï¼šè¯¥ç¨‹åºç›®å‰æ­£åœ¨ä¾¦æµ‹æˆ–è€…æ˜¯åœæ­¢äº†
- Z ï¼šè¯¥ç¨‹åºåº”è¯¥å·²ç»ç»ˆæ­¢ï¼Œä½†æ˜¯å…¶çˆ¶ç¨‹åºå´æ— æ³•æ­£å¸¸çš„ç»ˆæ­¢ä»–ï¼Œé€ æˆ zombie (ç–†å°¸) ç¨‹åºçš„çŠ¶æ€



### ps |aux

| æ ‡å¿—    | æ„ä¹‰                                                         |
| ------- | ------------------------------------------------------------ |
| USER    | è¯¥ process å±äºé‚£ä¸ªä½¿ç”¨è€…è´¦å·çš„                              |
| PID     | è¯¥ process çš„å·ç                                             |
| %CPU    | è¯¥ process ä½¿ç”¨æ‰çš„ CPU èµ„æºç™¾åˆ†æ¯”                           |
| %MEM    | è¯¥ process æ‰€å ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”                            |
| VSZ     | è¯¥ process ä½¿ç”¨æ‰çš„è™šæ‹Ÿå†…å­˜é‡ (Kbytes)                       |
| RSS     | è¯¥ process å ç”¨çš„å›ºå®šçš„å†…å­˜é‡ (Kbytes)                       |
| TTY     | è¯¥ process æ˜¯åœ¨é‚£ä¸ªç»ˆç«¯æœºä¸Šé¢è¿ä½œï¼Œè‹¥ä¸ç»ˆç«¯æœºæ— å…³ï¼Œåˆ™æ˜¾ç¤º ?ï¼Œå¦å¤–ï¼Œ tty1-tty6 æ˜¯æœ¬æœºä¸Šé¢çš„ç™»å…¥è€…ç¨‹åºï¼Œè‹¥ä¸º pts/0 ç­‰ç­‰çš„ï¼Œåˆ™è¡¨ç¤ºä¸ºç”±ç½‘ç»œè¿æ¥è¿›ä¸»æœºçš„ç¨‹åºã€‚ |
| STAT    | è¯¥ç¨‹åºç›®å‰çš„çŠ¶æ€                                             |
| START   | è¯¥ process è¢«è§¦å‘å¯åŠ¨çš„æ—¶é—´,STATï¼šè¯¥ç¨‹åºç›®å‰çš„çŠ¶æ€ï¼Œä¸»è¦çš„çŠ¶æ€æœ‰ |
| TIME    | è¯¥ process å®é™…ä½¿ç”¨ CPU è¿ä½œçš„æ—¶é—´                           |
| COMMAND | è¯¥ç¨‹åºçš„å®é™…æŒ‡ä»¤                                             |

### pstree

> pstreeå‘½ä»¤ä»¥æ ‘çŠ¶å›¾æ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³»ï¼ˆdisplay a tree of processesï¼‰ã€‚pså‘½ä»¤å¯ä»¥æ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„é‚£äº›è¿›ç¨‹çš„ä¿¡æ¯ï¼Œä½†æ˜¯å¯¹äºå®ƒä»¬ä¹‹é—´çš„å…³ç³»å´æ˜¾ç¤ºå¾—ä¸å¤Ÿæ¸…æ™°ã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿè°ƒç”¨forkå¯ä»¥åˆ›å»ºå­è¿›ç¨‹ï¼Œé€šè¿‡å­shellä¹Ÿå¯ä»¥åˆ›å»ºå­è¿›ç¨‹ï¼ŒLinuxç³»ç»Ÿä¸­è¿›ç¨‹ä¹‹é—´çš„å…³ç³»å¤©ç”Ÿå°±æ˜¯ä¸€æ£µæ ‘ï¼Œæ ‘çš„æ ¹å°±æ˜¯è¿›ç¨‹PIDä¸º1çš„initè¿›ç¨‹ã€‚

```bash
pstree -p #ä»¥æ ‘çŠ¶å›¾æ˜¾ç¤ºè¿›ç¨‹åŒæ—¶è¿˜æ˜¾ç¤ºPID

#ä»¥æ ‘çŠ¶å›¾æ˜¾ç¤ºè¿›ç¨‹PIDä¸ºçš„è¿›ç¨‹ä»¥åŠå­å­™è¿›ç¨‹ï¼Œå¦‚æœæœ‰-på‚æ•°åˆ™åŒæ—¶æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„PID
pstree [-p] <pid> 
pstree -p 21858 

pstree -p | less #å› ä¸ºpstreeè¾“å‡ºçš„ä¿¡æ¯å¯èƒ½æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æœ€å¥½ä¸more/lessé…åˆä½¿ç”¨,ä½¿ç”¨ä¸Šä¸‹ç®­å¤´æŸ¥çœ‹ï¼ŒæŒ‰qé€€å‡º
```

### systemd

>Systemd å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ï¼Œä¸ºç³»ç»Ÿçš„å¯åŠ¨å’Œç®¡ç†æä¾›ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚æ ¹æ® Linux æƒ¯ä¾‹ï¼Œå­—æ¯`d`æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰çš„ç¼©å†™ã€‚ Systemd è¿™ä¸ªåå­—çš„å«ä¹‰ï¼Œå°±æ˜¯å®ƒè¦å®ˆæŠ¤æ•´ä¸ªç³»ç»Ÿã€‚

![img](https://gitee.com/ibepo/ogcip/raw/master/20210930122501.png)





###### ç³»ç»Ÿç®¡ç†

`Systemd` å¹¶ä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ç»„å‘½ä»¤ï¼Œæ¶‰åŠåˆ°ç³»ç»Ÿç®¡ç†çš„æ–¹æ–¹é¢é¢ã€‚

`systemctl`æ˜¯ Systemd çš„ä¸»å‘½ä»¤ï¼Œç”¨äºç®¡ç†ç³»ç»Ÿ

```bash
# é‡å¯ç³»ç»Ÿ
$ sudo systemctl reboot

# å…³é—­ç³»ç»Ÿï¼Œåˆ‡æ–­ç”µæº
$ sudo systemctl poweroff

# CPUåœæ­¢å·¥ä½œ
$ sudo systemctl halt

# æš‚åœç³»ç»Ÿ
$ sudo systemctl suspend

# è®©ç³»ç»Ÿè¿›å…¥å†¬çœ çŠ¶æ€
$ sudo systemctl hibernate

# è®©ç³»ç»Ÿè¿›å…¥äº¤äº’å¼ä¼‘çœ çŠ¶æ€
$ sudo systemctl hybrid-sleep

# å¯åŠ¨è¿›å…¥æ•‘æ´çŠ¶æ€ï¼ˆå•ç”¨æˆ·çŠ¶æ€ï¼‰
$ sudo systemctl rescue
```



`hostnamectl`å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰ä¸»æœºçš„ä¿¡æ¯

```bash
# æ˜¾ç¤ºå½“å‰ä¸»æœºçš„ä¿¡æ¯
$ hostnamectl

# è®¾ç½®ä¸»æœºåã€‚
$ sudo hostnamectl set-hostname rhel7
```

### 

`localectl`å‘½ä»¤ç”¨äºæŸ¥çœ‹æœ¬åœ°åŒ–è®¾ç½®ã€‚

 ```bash
 # æŸ¥çœ‹æœ¬åœ°åŒ–è®¾ç½®
 $ localectl
 
 # è®¾ç½®æœ¬åœ°åŒ–å‚æ•°ã€‚
 $ sudo localectl set-locale LANG=en_GB.utf8
 $ sudo localectl set-keymap en_GB
 ```



`timedatectl`å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰æ—¶åŒºè®¾ç½®ã€‚

 ```bash
 # æŸ¥çœ‹å½“å‰æ—¶åŒºè®¾ç½®
 $ timedatectl
 
 # æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æ—¶åŒº
 $ timedatectl list-timezones                                                                                   
 
 # è®¾ç½®å½“å‰æ—¶åŒº
 $ sudo timedatectl set-timezone America/New_York
 $ sudo timedatectl set-time YYYY-MM-DD
 $ sudo timedatectl set-time HH:MM:SS
 ```



`loginctl`å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰ç™»å½•çš„ç”¨æˆ·ã€‚

 ```bash
 # åˆ—å‡ºå½“å‰session
 $ loginctl list-sessions
 
 # åˆ—å‡ºå½“å‰ç™»å½•ç”¨æˆ·
 $ loginctl list-users
 
 # åˆ—å‡ºæ˜¾ç¤ºæŒ‡å®šç”¨æˆ·çš„ä¿¡æ¯
 $ loginctl show-user ruanyf
 ```

å‚è€ƒç½‘å€

[Systemd å…¥é—¨æ•™ç¨‹ï¼šå®æˆ˜ç¯‡ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— (ruanyifeng.com)](https://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html)

[ä½¿ç”¨Systemctlå‘½ä»¤æ¥ç®¡ç†ç³»ç»ŸæœåŠ¡ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/388897743)

[systemctl è®¾ç½®è‡ªå®šä¹‰æœåŠ¡ç®¡ç†ï¼ˆä»¥nginxä¸ºä¾‹ï¼‰ ](https://segmentfault.com/a/1190000009723940)

[linux systemctl æŒ‡ä»¤ â€”â€” é˜®ä¸€å³° - ä¸ƒè„‰ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/zwcry/p/9602756.html)

[ğŸ¦Systemd å…¥é—¨æ•™ç¨‹ï¼šå‘½ä»¤ç¯‡ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— (ruanyifeng.com)](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html)



###### Unitå«ä¹‰

Systemd å¯ä»¥ç®¡ç†æ‰€æœ‰ç³»ç»Ÿèµ„æºã€‚ä¸åŒçš„èµ„æºç»Ÿç§°ä¸º`Unit`ï¼ˆå•ä½ï¼‰ã€‚

Unit ä¸€å…±åˆ†æˆ12ç§ã€‚

> - Service unitï¼šç³»ç»ŸæœåŠ¡
> - Target unitï¼šå¤šä¸ª Unit æ„æˆçš„ä¸€ä¸ªç»„
> - Device Unitï¼šç¡¬ä»¶è®¾å¤‡
> - Mount Unitï¼šæ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹
> - Automount Unitï¼šè‡ªåŠ¨æŒ‚è½½ç‚¹
> - Path Unitï¼šæ–‡ä»¶æˆ–è·¯å¾„
> - Scope Unitï¼šä¸æ˜¯ç”± Systemd å¯åŠ¨çš„å¤–éƒ¨è¿›ç¨‹
> - Slice Unitï¼šè¿›ç¨‹ç»„
> - Snapshot Unitï¼šSystemd å¿«ç…§ï¼Œå¯ä»¥åˆ‡å›æŸä¸ªå¿«ç…§
> - Socket Unitï¼šè¿›ç¨‹é—´é€šä¿¡çš„ socket
> - Swap Unitï¼šswap æ–‡ä»¶
> - Timer Unitï¼šå®šæ—¶å™¨

`systemctl list-units`å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰ Unit ã€‚

```bash
$ systemctl list-units                         #åˆ—å‡ºæ‰€æœ‰è¿è¡Œä¸­å•å…ƒ
$ systemctl list-units --all                   #åˆ—å‡ºæ‰€æœ‰Unitï¼ŒåŒ…æ‹¬æ²¡æœ‰æ‰¾åˆ°é…ç½®æ–‡ä»¶çš„æˆ–è€…å¯åŠ¨å¤±è´¥çš„
$ systemctl list-units --all --state=inactive  #åˆ—å‡ºæ‰€æœ‰æ²¡æœ‰è¿è¡Œçš„ Unit
$ systemctl list-units --type=service          #åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ã€ç±»å‹ä¸º service çš„ Unit 
$ systemctl list-units --failed                #ğŸ¦åˆ—å‡ºæ‰€æœ‰åŠ è½½å¤±è´¥çš„ Unit
```

###### Unit çŠ¶æ€

`systemctl status`å‘½ä»¤ç”¨äºæŸ¥çœ‹ç³»ç»ŸçŠ¶æ€å’Œå•ä¸ª Unit çš„çŠ¶æ€ã€‚

```bash
$ systemctl status nginx.service                              # æ˜¾ç¤ºå•ä¸ª Unit çš„çŠ¶æ€     
$ systemctl status                                            # æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€
$ systemctl status bluetooth.service                          # æ˜¾ç¤ºå•ä¸ª Unit çš„çŠ¶æ€
$ systemctl -H root@rhel7.example.com status httpd.service    # æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„æŸä¸ª Unit çš„çŠ¶æ€
```

```vim
nginx.service - nginx - high performance web server                                          
   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled; vendor preset: disabled) 
   Active: active (running) since Tue 2021-09-28 10:23:24 CST; 19min ago                     
  Process: 24489 ExecStop=/usr/local/nginx/sbin/nginx -s stop (code=exited, status=1/FAILURE) 
  Process: 24512 ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf (code=exited, status=0/SUCCESS)                                                               
  Process: 24511 ExecStartPre=/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf (code=exited, status=0/SUCCESS)                                            
 Main PID: 24514 (nginx)                                                                     
    Tasks: 2                                                                                 
   Memory: 1000.0K                                                                           
   CGroup: /system.slice/nginx.service                                                       
           â”œâ”€24514 nginx: master process /usr/local/nginx/sbin/nginx -c /usr/local/nginx/con...
           â””â”€24515 nginx: worker process   
```

- `Loaded`è¡Œï¼šé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œæ˜¯å¦è®¾ä¸ºå¼€æœºå¯åŠ¨
- `Active`è¡Œï¼šè¡¨ç¤ºæ­£åœ¨è¿è¡Œ
- `Main PID`è¡Œï¼šä¸»è¿›ç¨‹ID
- `Status`è¡Œï¼šç”±åº”ç”¨æœ¬èº«ï¼ˆè¿™é‡Œæ˜¯ httpd ï¼‰æä¾›çš„è½¯ä»¶å½“å‰çŠ¶æ€
- `CGroup`å—ï¼šåº”ç”¨çš„æ‰€æœ‰å­è¿›ç¨‹
- æ—¥å¿—å—ï¼šåº”ç”¨çš„æ—¥å¿—

ğŸ¦é™¤äº†`status`å‘½ä»¤ï¼Œ`systemctl`è¿˜æä¾›äº†ä¸‰ä¸ªæŸ¥è¯¢çŠ¶æ€çš„ç®€å•æ–¹æ³•ï¼Œä¸»è¦ä¾›è„šæœ¬å†…éƒ¨çš„åˆ¤æ–­è¯­å¥ä½¿ç”¨ã€‚

```bash
# æ˜¾ç¤ºæŸä¸ª Unit æ˜¯å¦æ­£åœ¨è¿è¡Œ
$ systemctl is-active application.service

# æ˜¾ç¤ºæŸä¸ª Unit æ˜¯å¦å¤„äºå¯åŠ¨å¤±è´¥çŠ¶æ€
$ systemctl is-failed application.service

# æ˜¾ç¤ºæŸä¸ª Unit æœåŠ¡æ˜¯å¦å»ºç«‹äº†è‡ªå¯åŠ¨é“¾æ¥
$ systemctl is-enabled application.service
```

######  Unit ç®¡ç†

å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ä¸‹é¢è¿™äº›å‘½ä»¤ï¼Œç”¨äºå¯åŠ¨å’Œåœæ­¢ Unitï¼ˆğŸ¦ä¸»è¦æ˜¯ serviceï¼‰ã€‚

 ```bash
 # ç«‹å³å¯åŠ¨ä¸€ä¸ªæœåŠ¡
 $ sudo systemctl start apache.service
 
 # ç«‹å³åœæ­¢ä¸€ä¸ªæœåŠ¡
 $ sudo systemctl stop apache.service
 
 # é‡å¯ä¸€ä¸ªæœåŠ¡
 $ sudo systemctl restart apache.service
 
 # æ€æ­»ä¸€ä¸ªæœåŠ¡çš„æ‰€æœ‰å­è¿›ç¨‹
 $ sudo systemctl kill apache.service
 
 # é‡æ–°åŠ è½½ä¸€ä¸ªæœåŠ¡çš„é…ç½®æ–‡ä»¶
 $ sudo systemctl reload apache.service

 # é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶
 $ sudo systemctl daemon-reload
 
 # ğŸ¦æ˜¾ç¤ºæŸä¸ª Unit çš„æ‰€æœ‰åº•å±‚å‚æ•°
 $ systemctl show nginx.service
 
# æ˜¾ç¤ºæŸä¸ª Unit çš„æŒ‡å®šå±æ€§çš„å€¼
 $ systemctl show -p CPUShares httpd.service

 # è®¾ç½®æŸä¸ª Unit çš„æŒ‡å®šå±æ€§
 $ sudo systemctl set-property httpd.service CPUShares=500
 ```



###### ä¾èµ–å…³ç³»

Unit ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼šA ä¾èµ–äº Bï¼Œå°±æ„å‘³ç€ Systemd åœ¨å¯åŠ¨ A çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šå»å¯åŠ¨ Bã€‚

`systemctl list-dependencies`å‘½ä»¤åˆ—å‡ºä¸€ä¸ª Unit çš„æ‰€æœ‰ä¾èµ–ã€‚

```bash
$ systemctl list-dependencies nginx.service
```

ğŸ¦ä¸Šé¢å‘½ä»¤çš„è¾“å‡ºç»“æœä¹‹ä¸­ï¼Œæœ‰äº›ä¾èµ–æ˜¯ Target ç±»å‹ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œé»˜è®¤ä¸ä¼šå±•å¼€æ˜¾ç¤ºã€‚å¦‚æœè¦å±•å¼€ Targetï¼Œå°±éœ€è¦ä½¿ç”¨`--all`å‚æ•°ã€‚

 ```bash
 $ systemctl list-dependencies --all nginx.service
 ```



###### Unit é…ç½®

######      â‘  æ¦‚è¿°

æ¯ä¸€ä¸ª Unit éƒ½æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘Šè¯‰ Systemd æ€ä¹ˆå¯åŠ¨è¿™ä¸ª Unit ã€‚

Systemd é»˜è®¤ä»ç›®å½•`/etc/systemd/system/`è¯»å–é…ç½®æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œé‡Œé¢å­˜æ”¾çš„å¤§éƒ¨åˆ†æ–‡ä»¶éƒ½æ˜¯ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ç›®å½•`/usr/lib/systemd/system/`ï¼ŒçœŸæ­£çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨é‚£ä¸ªç›®å½•ã€‚

`systemctl enable`å‘½ä»¤ç”¨äºåœ¨ä¸Šé¢ä¸¤ä¸ªç›®å½•ä¹‹é—´ï¼Œå»ºç«‹ç¬¦å·é“¾æ¥å…³ç³»ã€‚

 ```bash
 $ sudo systemctl enable clamd@scan.service
 # ç­‰åŒäº
 $ sudo ln -s '/usr/lib/systemd/system/clamd@scan.service' '/etc/systemd/system/multi-user.target.wants/clamd@scan.service'
 ```



`systemctl enable`

å¦‚æœé…ç½®æ–‡ä»¶é‡Œé¢è®¾ç½®äº†å¼€æœºå¯åŠ¨ï¼Œ`systemctl enable`å‘½ä»¤ç›¸å½“äºæ¿€æ´»å¼€æœºå¯åŠ¨ã€‚

ä¸ä¹‹å¯¹åº”çš„ï¼Œ`systemctl disable`å‘½ä»¤ç”¨äºåœ¨ä¸¤ä¸ªç›®å½•ä¹‹é—´ï¼Œæ’¤é”€ç¬¦å·é“¾æ¥å…³ç³»ï¼Œç›¸å½“äºæ’¤é”€å¼€æœºå¯åŠ¨ã€‚

```bash
$ sudo systemctl disable clamd@scan.service
```

é…ç½®æ–‡ä»¶çš„åç¼€åï¼Œå°±æ˜¯è¯¥ Unit çš„ç§ç±»ï¼Œæ¯”å¦‚`sshd.socket`ã€‚å¦‚æœçœç•¥ï¼ŒSystemd é»˜è®¤åç¼€åä¸º`.service`ï¼Œæ‰€ä»¥`sshd`ä¼šè¢«ç†è§£æˆ`sshd.service`ã€‚



###### â‘¡é…ç½®æ–‡ä»¶çš„çŠ¶æ€

`systemctl list-unit-files`å‘½ä»¤ç”¨äºåˆ—å‡ºæ‰€æœ‰é…ç½®æ–‡ä»¶ã€‚æ³¨æ„ï¼Œä»é…ç½®æ–‡ä»¶çš„çŠ¶æ€æ— æ³•çœ‹å‡ºï¼Œè¯¥ Unit æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚è¿™å¿…é¡»æ‰§è¡Œå‰é¢æåˆ°çš„`systemctl status`å‘½ä»¤ã€‚

```bash
# åˆ—å‡ºæ‰€æœ‰é…ç½®æ–‡ä»¶
$ systemctl list-unit-files
# åˆ—å‡ºæŒ‡å®šç±»å‹çš„é…ç½®æ–‡ä»¶
$ systemctl list-unit-files --type=service
```

è¿™ä¸ªå‘½ä»¤ä¼šè¾“å‡ºä¸€ä¸ªåˆ—è¡¨,é™„å½•â‘ 

````bash
UNIT FILE              STATE
chronyd.service        enabled
clamd@.service         static
clamd@scan.service     disabled
````

é™„å½•â‘ 

- enabledï¼šå·²å»ºç«‹å¯åŠ¨é“¾æ¥
- disabledï¼šæ²¡å»ºç«‹å¯åŠ¨é“¾æ¥
- staticï¼šè¯¥é…ç½®æ–‡ä»¶æ²¡æœ‰`[Install]`éƒ¨åˆ†ï¼ˆæ— æ³•æ‰§è¡Œï¼‰ï¼Œåªèƒ½ä½œä¸ºå…¶ä»–é…ç½®æ–‡ä»¶çš„ä¾èµ–
- maskedï¼šè¯¥é…ç½®æ–‡ä»¶è¢«ç¦æ­¢å»ºç«‹å¯åŠ¨é“¾æ¥



xxx. service

â‘ è¿›å…¥systemctl status ng.serviceæ–‡ä»¶å¤¹

```bash
#systemctl
cd /usr/lib/systemd/system    #è¿›å…¥/usr/lib/systemd/system
vi tomcat.service #ä»¥tomcatä¸ºä¾‹ï¼Œ/usr/lib/systemd/systemä¸‹åˆ›å»ºtomcat.serviceæ–‡ä»¶
```

â‘¡ç¼–å†™ tomcat.service å¯åŠ¨æ–‡ä»¶

```shell
#tomcat.service
[Unit]
Description=tomcatapi
After=network.target

[Service]
Type=forking
ExecStart=/usr/local/apache-tomcat-8.5.29/bin/startup.sh #æœåŠ¡å¯åŠ¨çš„å‘½ä»¤ï¼ˆå¯¹åº”ä½ è‡ªå·±æœåŠ¡å™¨çš„å‘½ä»¤ï¼‰
ExecReload=
ExecStop=/usr/local/apache-tomcat-8.5.29/bin/shutdown.sh #æœåŠ¡åœæ­¢çš„å‘½ä»¤ï¼ˆåŒç†ï¼‰
PrivateTmp=true

[Install]
WantedBy=multi-user.target

```

â‘¢æ·»åŠ  tomcat.service æ–‡ä»¶çš„å¯åŠ¨æƒé™

```
chmod +x tomcat.service
```

â‘£æµ‹è¯•

```bash
 systemctl stop tomcat
 systemctl start tomcat
```



###### â‘¢é…ç½®æ–‡ä»¶çš„æ ¼å¼

é…ç½®æ–‡ä»¶å°±æ˜¯æ™®é€šçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚

`systemctl cat`å‘½ä»¤å¯ä»¥æŸ¥çœ‹é…ç½®æ–‡ä»¶çš„å†…å®¹ã€‚

 ```bash
 $ systemctl cat atd.service
 
 [Unit]
 Description=ATD daemon
 
 [Service]
 Type=forking
 ExecStart=/usr/bin/atd
 
 [Install]
 WantedBy=multi-user.target
 ```

ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œé…ç½®æ–‡ä»¶åˆ†æˆå‡ ä¸ªåŒºå—ã€‚æ¯ä¸ªåŒºå—çš„ç¬¬ä¸€è¡Œï¼Œæ˜¯ç”¨æ–¹æ‹¬å·è¡¨ç¤ºçš„åŒºåˆ«åï¼Œæ¯”å¦‚`[Unit]`ã€‚æ³¨æ„ï¼Œé…ç½®æ–‡ä»¶çš„åŒºå—åå’Œå­—æ®µåï¼Œéƒ½æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚

æ¯ä¸ªåŒºå—å†…éƒ¨æ˜¯ä¸€äº›ç­‰å·è¿æ¥çš„é”®å€¼å¯¹ã€‚

 ```bash
 [Section]
 Directive1=value
 Directive2=value
 ```

æ³¨æ„ï¼Œé”®å€¼å¯¹çš„ç­‰å·ä¸¤ä¾§ä¸èƒ½æœ‰ç©ºæ ¼ã€‚



###### â‘£é…ç½®æ–‡ä»¶çš„åŒºå—

`[Unit]`åŒºå—é€šå¸¸æ˜¯é…ç½®æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªåŒºå—ï¼Œç”¨æ¥å®šä¹‰ Unit çš„å…ƒæ•°æ®ï¼Œä»¥åŠé…ç½®ä¸å…¶ä»– Unit çš„å…³ç³»ã€‚

`[Install]`é€šå¸¸æ˜¯é…ç½®æ–‡ä»¶çš„æœ€åä¸€ä¸ªåŒºå—ï¼Œç”¨æ¥å®šä¹‰å¦‚ä½•å¯åŠ¨ï¼Œä»¥åŠæ˜¯å¦å¼€æœºå¯åŠ¨ã€‚

`[Service]`åŒºå—ç”¨æ¥ Service çš„é…ç½®ï¼Œåªæœ‰ Service ç±»å‹çš„ Unit æ‰æœ‰è¿™ä¸ªåŒºå—ã€‚



````bash
systemctl cat sshd.service

[Unit]
Description=OpenSSH server daemon
Documentation=man:sshd(8) man:sshd_config(5)

#Afterå­—æ®µè¡¨ç¤ºå¦‚æœnetwork.targetæˆ–sshd-keygen.serviceéœ€è¦å¯åŠ¨ï¼Œé‚£ä¹ˆsshd.serviceåº”è¯¥åœ¨å®ƒä»¬ä¹‹åå¯åŠ¨ã€‚å®šä¹‰sshd.serviceåº”è¯¥åœ¨å“ªäº›æœåŠ¡ä¹‹å‰å¯åŠ¨ã€‚
After=network.target sshd-keygen.service 

#Wantså­—æ®µï¼šè¡¨ç¤ºsshd.serviceä¸sshd-keygen.serviceä¹‹é—´å­˜åœ¨"å¼±ä¾èµ–"å…³ç³»ï¼Œå³å¦‚æœ"sshd-eygen.service"å¯åŠ¨å¤±è´¥æˆ–åœæ­¢è¿è¡Œï¼Œä¸å½±å“sshd.serviceç»§ç»­æ‰§è¡Œã€‚
Wants=sshd-keygen.service

[Service]
#EnvironmentFileå­—æ®µï¼šæŒ‡å®šå½“å‰æœåŠ¡çš„ç¯å¢ƒå‚æ•°æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶å†…éƒ¨çš„key=valueé”®å€¼å¯¹ï¼Œå¯ä»¥ç”¨$keyçš„å½¢å¼ï¼Œåœ¨å½“å‰é…ç½®æ–‡ä»¶ä¸­è·å–ã€‚
EnvironmentFile=/etc/sysconfig/sshd

#â™ ExecStartå­—æ®µï¼šå®šä¹‰å¯åŠ¨è¿›ç¨‹æ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚
#æ‰§è¡Œçš„å‘½ä»¤æ˜¯/usr/sbin/sshd -D $OPTIONSï¼Œå…¶ä¸­çš„å˜é‡$OPTIONSå°±æ¥è‡ªEnvironmentFileå­—æ®µæŒ‡å®šçš„ç¯å¢ƒå‚æ•°æ–‡ä»¶ã€‚
ExecStart=/usr/sbin/sshd -D $OPTIONS

ExecReload=/bin/kill -HUP $MAINPID

#Typeå­—æ®µå®šä¹‰å¯åŠ¨ç±»å‹ã€‚å®ƒå¯ä»¥è®¾ç½®çš„å€¼å¦‚ä¸‹,é™„å½•â‘ 
Type=simple

#KillModeå­—æ®µï¼šå®šä¹‰ Systemd å¦‚ä½•åœæ­¢ sshd æœåŠ¡ã€‚
#ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°†KillModeè®¾ä¸ºprocessï¼Œè¡¨ç¤ºåªåœæ­¢ä¸»è¿›ç¨‹ï¼Œä¸åœæ­¢ä»»ä½•sshd å­è¿›ç¨‹ï¼Œå³å­è¿›ç¨‹æ‰“å¼€çš„ SSH #session ä»ç„¶ä¿æŒè¿æ¥ã€‚è¿™ä¸ªè®¾ç½®ä¸å¤ªå¸¸è§ï¼Œä½†å¯¹ sshd å¾ˆé‡è¦ï¼Œå¦åˆ™ä½ åœæ­¢æœåŠ¡çš„æ—¶å€™ï¼Œä¼šè¿è‡ªå·±æ‰“å¼€çš„ SSH #session ä¸€èµ·æ€æ‰ã€‚,é™„å½•â‘¡
KillMode=process

#Restartå­—æ®µï¼šå®šä¹‰äº† sshd é€€å‡ºåï¼ŒSystemd çš„é‡å¯æ–¹å¼ã€‚
#Restartè®¾ä¸ºon-failureï¼Œè¡¨ç¤ºä»»ä½•æ„å¤–çš„å¤±è´¥ï¼Œå°±å°†é‡å¯sshdã€‚å¦‚æœ sshd æ­£å¸¸åœæ­¢ï¼ˆæ¯”å¦‚æ‰§è¡Œsystemctl stopå‘½
#ä»¤ï¼‰ï¼Œå®ƒå°±ä¸ä¼šé‡å¯,é™„å½•â‘¢
Restart=on-failure

#RestartSecå­—æ®µï¼šè¡¨ç¤º Systemd é‡å¯æœåŠ¡ä¹‹å‰ï¼Œéœ€è¦ç­‰å¾…çš„ç§’æ•°ã€‚ä¸Šé¢çš„ä¾‹å­è®¾ä¸ºç­‰å¾…42ç§’ã€‚
RestartSec=42s

[Install]
WantedBy=multi-user.target
````

é™„å½•â‘ :

`Type`å­—æ®µå®šä¹‰å¯åŠ¨ç±»å‹ã€‚å®ƒå¯ä»¥è®¾ç½®çš„å€¼å¦‚ä¸‹

- simpleï¼ˆé»˜è®¤å€¼ï¼‰ï¼š`ExecStart`å­—æ®µå¯åŠ¨çš„è¿›ç¨‹ä¸ºä¸»è¿›ç¨‹
- forkingï¼š`ExecStart`å­—æ®µå°†ä»¥`fork()`æ–¹å¼å¯åŠ¨ï¼Œæ­¤æ—¶çˆ¶è¿›ç¨‹å°†ä¼šé€€å‡ºï¼Œå­è¿›ç¨‹å°†æˆä¸ºä¸»è¿›ç¨‹
- oneshotï¼šç±»ä¼¼äº`simple`ï¼Œä½†åªæ‰§è¡Œä¸€æ¬¡ï¼ŒSystemd ä¼šç­‰å®ƒæ‰§è¡Œå®Œï¼Œæ‰å¯åŠ¨å…¶ä»–æœåŠ¡
- dbusï¼šç±»ä¼¼äº`simple`ï¼Œä½†ä¼šç­‰å¾… D-Bus ä¿¡å·åå¯åŠ¨
- notifyï¼šç±»ä¼¼äº`simple`ï¼Œå¯åŠ¨ç»“æŸåä¼šå‘å‡ºé€šçŸ¥ä¿¡å·ï¼Œç„¶å Systemd å†å¯åŠ¨å…¶ä»–æœåŠ¡
- idleï¼šç±»ä¼¼äº`simple`ï¼Œä½†æ˜¯è¦ç­‰åˆ°å…¶ä»–ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œæ‰ä¼šå¯åŠ¨è¯¥æœåŠ¡ã€‚ä¸€ç§ä½¿ç”¨åœºåˆæ˜¯ä¸ºè®©è¯¥æœåŠ¡çš„è¾“å‡ºï¼Œä¸ä¸å…¶ä»–æœåŠ¡çš„è¾“å‡ºç›¸æ··åˆ



é™„å½•â‘¡:

`KillMode`å­—æ®µå¯ä»¥è®¾ç½®çš„å€¼å¦‚ä¸‹ã€‚

- control-groupï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå½“å‰æ§åˆ¶ç»„é‡Œé¢çš„æ‰€æœ‰å­è¿›ç¨‹ï¼Œéƒ½ä¼šè¢«æ€æ‰
- processï¼šåªæ€ä¸»è¿›ç¨‹
- mixedï¼šä¸»è¿›ç¨‹å°†æ”¶åˆ° SIGTERM ä¿¡å·ï¼Œå­è¿›ç¨‹æ”¶åˆ° SIGKILL ä¿¡å·
- noneï¼šæ²¡æœ‰è¿›ç¨‹ä¼šè¢«æ€æ‰ï¼Œåªæ˜¯æ‰§è¡ŒæœåŠ¡çš„ stop å‘½ä»¤ã€‚



é™„å½•â‘¢:

`Restart`å­—æ®µå¯ä»¥è®¾ç½®çš„å€¼å¦‚ä¸‹ã€‚

- noï¼ˆé»˜è®¤å€¼ï¼‰ï¼šé€€å‡ºåä¸ä¼šé‡å¯
- on-successï¼šåªæœ‰æ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€ç ä¸º0ï¼‰ï¼Œæ‰ä¼šé‡å¯
- on-failureï¼šéæ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€ç é0ï¼‰ï¼ŒåŒ…æ‹¬è¢«ä¿¡å·ç»ˆæ­¢å’Œè¶…æ—¶ï¼Œæ‰ä¼šé‡å¯
- on-abnormalï¼šåªæœ‰è¢«ä¿¡å·ç»ˆæ­¢å’Œè¶…æ—¶ï¼Œæ‰ä¼šé‡å¯
- on-abortï¼šåªæœ‰åœ¨æ”¶åˆ°æ²¡æœ‰æ•æ‰åˆ°çš„ä¿¡å·ç»ˆæ­¢æ—¶ï¼Œæ‰ä¼šé‡å¯
- on-watchdogï¼šè¶…æ—¶é€€å‡ºï¼Œæ‰ä¼šé‡å¯
- alwaysï¼šä¸ç®¡æ˜¯ä»€ä¹ˆé€€å‡ºåŸå› ï¼Œæ€»æ˜¯é‡å¯



###### Target

å¯åŠ¨è®¡ç®—æœºçš„æ—¶å€™ï¼Œéœ€è¦å¯åŠ¨å¤§é‡çš„ Unitã€‚å¦‚æœæ¯ä¸€æ¬¡å¯åŠ¨ï¼Œéƒ½è¦ä¸€ä¸€å†™æ˜æœ¬æ¬¡å¯åŠ¨éœ€è¦å“ªäº› Unitï¼Œæ˜¾ç„¶éå¸¸ä¸æ–¹ä¾¿ã€‚Systemd çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ Targetã€‚

ç®€å•è¯´ï¼ŒTarget å°±æ˜¯ä¸€ä¸ª Unit ç»„ï¼ŒåŒ…å«è®¸å¤šç›¸å…³çš„ Unit ã€‚å¯åŠ¨æŸä¸ª Target çš„æ—¶å€™ï¼ŒSystemd å°±ä¼šå¯åŠ¨é‡Œé¢æ‰€æœ‰çš„ Unitã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè¯´ï¼ŒTarget è¿™ä¸ªæ¦‚å¿µç±»ä¼¼äº"çŠ¶æ€ç‚¹"ï¼Œå¯åŠ¨æŸä¸ª Target å°±å¥½æ¯”å¯åŠ¨åˆ°æŸç§çŠ¶æ€ã€‚

ä¼ ç»Ÿçš„`init`å¯åŠ¨æ¨¡å¼é‡Œé¢ï¼Œæœ‰ RunLevel çš„æ¦‚å¿µï¼Œè·Ÿ Target çš„ä½œç”¨å¾ˆç±»ä¼¼ã€‚ä¸åŒçš„æ˜¯ï¼ŒRunLevel æ˜¯äº’æ–¥çš„ï¼Œä¸å¯èƒ½å¤šä¸ª RunLevel åŒæ—¶å¯åŠ¨ï¼Œä½†æ˜¯å¤šä¸ª Target å¯ä»¥åŒæ—¶å¯åŠ¨ã€‚

```bash
# æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰ Target
$ systemctl list-unit-files --type=target

# æŸ¥çœ‹ä¸€ä¸ª Target åŒ…å«çš„æ‰€æœ‰ Unit
$ systemctl list-dependencies multi-user.target

# æŸ¥çœ‹å¯åŠ¨æ—¶çš„é»˜è®¤ Target
$ systemctl get-default

# è®¾ç½®å¯åŠ¨æ—¶çš„é»˜è®¤ Target
$ sudo systemctl set-default multi-user.target

# åˆ‡æ¢ Target æ—¶ï¼Œé»˜è®¤ä¸å…³é—­å‰ä¸€ä¸ª Target å¯åŠ¨çš„è¿›ç¨‹ï¼Œ
# systemctl isolate å‘½ä»¤æ”¹å˜è¿™ç§è¡Œä¸ºï¼Œ
# å…³é—­å‰ä¸€ä¸ª Target é‡Œé¢æ‰€æœ‰ä¸å±äºåä¸€ä¸ª Target çš„è¿›ç¨‹
$ sudo systemctl isolate multi-user.target
```

`Target` ä¸ ä¼ ç»Ÿ `RunLevel` çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ã€‚

```bahs
Traditional runlevel      New target name     Symbolically linked to...

Runlevel 0           |    runlevel0.target -> poweroff.target
Runlevel 1           |    runlevel1.target -> rescue.target
Runlevel 2           |    runlevel2.target -> multi-user.target
Runlevel 3           |    runlevel3.target -> multi-user.target
Runlevel 4           |    runlevel4.target -> multi-user.target
Runlevel 5           |    runlevel5.target -> graphical.target
Runlevel 6           |    runlevel6.target -> reboot.target
```

Targetä¸ init è¿›ç¨‹çš„ä¸»è¦å·®åˆ«

**ï¼ˆ1ï¼‰é»˜è®¤çš„ RunLevel**ï¼ˆåœ¨`/etc/inittab`æ–‡ä»¶è®¾ç½®ï¼‰ç°åœ¨è¢«é»˜è®¤çš„ Target å–ä»£ï¼Œä½ç½®æ˜¯`/etc/systemd/system/default.target`ï¼Œé€šå¸¸ç¬¦å·é“¾æ¥åˆ°`graphical.target`ï¼ˆå›¾å½¢ç•Œé¢ï¼‰æˆ–è€…`multi-user.target`ï¼ˆå¤šç”¨æˆ·å‘½ä»¤è¡Œï¼‰ã€‚

**ï¼ˆ2ï¼‰å¯åŠ¨è„šæœ¬çš„ä½ç½®**ï¼Œä»¥å‰æ˜¯`/etc/init.d`ç›®å½•ï¼Œç¬¦å·é“¾æ¥åˆ°ä¸åŒçš„ RunLevel ç›®å½• ï¼ˆæ¯”å¦‚`/etc/rc3.d`ã€`/etc/rc5.d`ç­‰ï¼‰ï¼Œç°åœ¨åˆ™å­˜æ”¾åœ¨`/lib/systemd/system`å’Œ`/etc/systemd/system`ç›®å½•ã€‚

**ï¼ˆ3ï¼‰é…ç½®æ–‡ä»¶çš„ä½ç½®**ï¼Œä»¥å‰`init`è¿›ç¨‹çš„é…ç½®æ–‡ä»¶æ˜¯`/etc/inittab`ï¼Œå„ç§æœåŠ¡çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨`/etc/sysconfig`ç›®å½•ã€‚ç°åœ¨çš„é…ç½®æ–‡ä»¶ä¸»è¦å­˜æ”¾åœ¨`/lib/systemd`ç›®å½•ï¼Œåœ¨`/etc/systemd`ç›®å½•é‡Œé¢çš„ä¿®æ”¹å¯ä»¥è¦†ç›–åŸå§‹è®¾ç½®ã€‚



###### æ—¥å¿—ç®¡ç†

Systemd ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ Unit çš„å¯åŠ¨æ—¥å¿—ã€‚å¸¦æ¥çš„å¥½å¤„å°±æ˜¯ï¼Œå¯ä»¥åªç”¨`journalctl`ä¸€ä¸ªå‘½ä»¤ï¼ŒæŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼ˆå†…æ ¸æ—¥å¿—å’Œåº”ç”¨æ—¥å¿—ï¼‰ã€‚æ—¥å¿—çš„é…ç½®æ–‡ä»¶æ˜¯`/etc/systemd/journald.conf`ã€‚

`journalctl`åŠŸèƒ½å¼ºå¤§ï¼Œç”¨æ³•éå¸¸å¤šã€‚

```bash
# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼ˆé»˜è®¤æƒ…å†µä¸‹ ï¼Œåªä¿å­˜æœ¬æ¬¡å¯åŠ¨çš„æ—¥å¿—ï¼‰
$ sudo journalctl

# æŸ¥çœ‹å†…æ ¸æ—¥å¿—ï¼ˆä¸æ˜¾ç¤ºåº”ç”¨æ—¥å¿—ï¼‰
$ sudo journalctl -k

# æŸ¥çœ‹ç³»ç»Ÿæœ¬æ¬¡å¯åŠ¨çš„æ—¥å¿—
$ sudo journalctl -b
$ sudo journalctl -b -0

# æŸ¥çœ‹ä¸Šä¸€æ¬¡å¯åŠ¨çš„æ—¥å¿—ï¼ˆéœ€æ›´æ”¹è®¾ç½®ï¼‰
$ sudo journalctl -b -1

# æŸ¥çœ‹æŒ‡å®šæ—¶é—´çš„æ—¥å¿—
$ sudo journalctl --since="2012-10-30 18:17:16"
$ sudo journalctl --since "20 min ago"
$ sudo journalctl --since yesterday
$ sudo journalctl --since "2015-01-10" --until "2015-01-11 03:00"
$ sudo journalctl --since 09:00 --until "1 hour ago"

# æ˜¾ç¤ºå°¾éƒ¨çš„æœ€æ–°10è¡Œæ—¥å¿—
$ sudo journalctl -n

# æ˜¾ç¤ºå°¾éƒ¨æŒ‡å®šè¡Œæ•°çš„æ—¥å¿—
$ sudo journalctl -n 20

# å®æ—¶æ»šåŠ¨æ˜¾ç¤ºæœ€æ–°æ—¥å¿—
$ sudo journalctl -f

# æŸ¥çœ‹æŒ‡å®šæœåŠ¡çš„æ—¥å¿—
$ sudo journalctl /usr/lib/systemd/systemd

# æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹çš„æ—¥å¿—
$ sudo journalctl _PID=1

# æŸ¥çœ‹æŸä¸ªè·¯å¾„çš„è„šæœ¬çš„æ—¥å¿—
$ sudo journalctl /usr/bin/bash

# æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—
$ sudo journalctl _UID=33 --since today

# æŸ¥çœ‹æŸä¸ª Unit çš„æ—¥å¿—
$ sudo journalctl -u nginx.service
$ sudo journalctl -u nginx.service --since today

# å®æ—¶æ»šåŠ¨æ˜¾ç¤ºæŸä¸ª Unit çš„æœ€æ–°æ—¥å¿—
$ sudo journalctl -u nginx.service -f

# åˆå¹¶æ˜¾ç¤ºå¤šä¸ª Unit çš„æ—¥å¿—
$ journalctl -u nginx.service -u php-fpm.service --since today

# æŸ¥çœ‹æŒ‡å®šä¼˜å…ˆçº§ï¼ˆåŠå…¶ä»¥ä¸Šçº§åˆ«ï¼‰çš„æ—¥å¿—ï¼Œå…±æœ‰8çº§
# 0: emerg
# 1: alert
# 2: crit
# 3: err
# 4: warning
# 5: notice
# 6: info
# 7: debug
$ sudo journalctl -p err -b

# æ—¥å¿—é»˜è®¤åˆ†é¡µè¾“å‡ºï¼Œ--no-pager æ”¹ä¸ºæ­£å¸¸çš„æ ‡å‡†è¾“å‡º
$ sudo journalctl --no-pager

# ä»¥ JSON æ ¼å¼ï¼ˆå•è¡Œï¼‰è¾“å‡º
$ sudo journalctl -b -u nginx.service -o json

# ä»¥ JSON æ ¼å¼ï¼ˆå¤šè¡Œï¼‰è¾“å‡ºï¼Œå¯è¯»æ€§æ›´å¥½
$ sudo journalctl -b -u nginx.serviceqq
 -o json-pretty

# æ˜¾ç¤ºæ—¥å¿—å æ®çš„ç¡¬ç›˜ç©ºé—´
$ sudo journalctl --disk-usage

# æŒ‡å®šæ—¥å¿—æ–‡ä»¶å æ®çš„æœ€å¤§ç©ºé—´
$ sudo journalctl --vacuum-size=1G

# æŒ‡å®šæ—¥å¿—æ–‡ä»¶ä¿å­˜å¤šä¹…
$ sudo journalctl --vacuum-time=1years
```



### ç”¨æˆ·

[ Linuxç¯å¢ƒä¸‹ä¸ºæ™®é€šç”¨æˆ·æ·»åŠ sudoæƒé™](https://blog.csdn.net/qq_39290007/article/details/81125750?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-3.no_search_link)

```bash
#åˆ›å»ºç”¨æˆ· 
useradd xiaoming #å½“ç”¨æˆ·åˆ›å»ºå,å°†åœ¨/home ä¸‹è‡ªåŠ¨åˆ›å»ºåŒåçš„å®¶ç›®å½• /home/xiaoming
useradd -d /home/tiger xiaoming #åˆ›å»ºå°æ˜è´¦å·,å¹¶è‡ªåŠ¨åˆ›å»ºä»–çš„å®¶ç›®å½•æ˜¯/home/tinger

visudo #æ³¨æ„ç¼–è¾‘/etc/sudoers æ–‡ä»¶,å°† è‡ªå·±å®‰æ’çš„ dev ç”¨æˆ·ç»„å¢åŠ  root æ‰€æœ‰æ‹¥æœ‰çš„æƒé™,è¿™é‡Œé€‰æ‹©éœ€è¦å¯†ç  ,é˜²å‘†è®¾è®¡

#æŸ¥çœ‹ç”¨æˆ·
cat /etc/passwd 

#åˆ›å»ºå¯†ç 
passwd xiaoming  å›è½¦åè¾“å…¥å¯†ç 

#åˆ é™¤ç”¨æˆ·
userdel xiaoming    #åªåˆ é™¤ç”¨æˆ·,ä¿ç•™å®¶ç›®å½•
userdel -r xiaoming #åˆ é™¤ç”¨æˆ·å’Œå…¶å®¶ç›®å½•

#æŸ¥è¯¢ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
id xiaoming

#åˆ‡æ¢ç”¨æˆ· swith user
su ibepo #åˆ‡æ¢ç”¨æˆ·
su -ibepo #åˆ‡æ¢ç”¨æˆ·,å¹¶è·³è½¬åˆ°åˆ‡æ¢çš„ç”¨æˆ·çš„å®¶ç›®å½•ä¸‹
su #åˆ‡æ¢è‡³ root ç”¨æˆ·
exit #è¿”å›åˆ°åŸæ¥çš„ç”¨æˆ·

#ä»¥ root çš„æƒé™è¿è¡ŒæŸæŒ‡ä»¤
sudo
sudo su - #ä»¥ root æƒé™åˆ‡æ¢è‡³ root ç”¨æˆ·,å¹¶åˆ‡æ¢åˆ° root ç›®å½•ä¸‹
```





### ç”¨æˆ·ç»„

```bash
#å¢åŠ ç»„
groupadd wudang #åˆ›å»ºæ­¦å½“ç»„

#åˆ é™¤ç»„
groupdel wudang

#å¢åŠ ä¸€ä¸ªç”¨æˆ·å¼ æ— å¿Œ,å°†ä»–æŒ‡å®šåˆ°æ­¦å½“ç»„ä¸­
useradd -g wudang zhangwuji

#ä¿®æ”¹ç”¨æˆ·ç»„,å¼ æ— å¿Œè¿™ä¸ªç”¨æˆ·ä¿®æ”¹åˆ°æ˜æ•™ç»„
groupadd mingjiao
usermod -g mingjiao zhagnwuji

#ç”¨æˆ·ã€ç”¨æˆ·ç»„çš„ç›¸å…³æ–‡ä»¶

#ç”¨æˆ·ä¿¡æ¯é…ç½®æ–‡ä»¶
/etc/passwd 
æ¯è¡Œçš„å«ä¹‰:ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½• shell

 #ç»„é…ç½®æ–‡ä»¶
/etc/group
æ¯è¡Œçš„å«ä¹‰: ç»„å:å£ä»¤ç»„æ ‡è¯†å·:ç»„å†…ç”¨æˆ·åˆ—è¡¨

#å¯†ç å’Œç™»å½•ä¿¡æ¯é…ç½®æ–‡ä»¶(åŠ å¯†çš„)
/etc/shadow 

#=================ç»„ç®¡ç†å’Œæƒé™ç®¡ç†================================

#åˆ†é…sudoæƒé™ç»™ç”¨æˆ·
sudoçš„å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹ï¼š

1ï¼Œå½“ç”¨æˆ·æ‰§è¡Œsudoæ—¶ï¼Œç³»ç»Ÿä¼šä¸»åŠ¨å¯»æ‰¾/etc/sudoersæ–‡ä»¶ï¼Œåˆ¤æ–­è¯¥ç”¨æˆ·æ˜¯å¦æœ‰æ‰§è¡Œsudoçš„æƒé™
2ï¼Œç¡®è®¤ç”¨æˆ·å…·æœ‰å¯æ‰§è¡Œsudoçš„æƒé™åï¼Œè®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·è‡ªå·±çš„å¯†ç ç¡®è®¤
3ï¼Œè‹¥å¯†ç è¾“å…¥æˆåŠŸï¼Œåˆ™å¼€å§‹æ‰§è¡Œsudoåç»­çš„å‘½ä»¤
4ï¼Œrootæ‰§è¡Œsudoæ—¶ä¸éœ€è¦è¾“å…¥å¯†ç (eudoersæ–‡ä»¶ä¸­æœ‰é…ç½®root ALL=(ALL) ALLè¿™æ ·ä¸€æ¡è§„åˆ™)
5ï¼Œè‹¥æ¬²åˆ‡æ¢çš„èº«ä»½ä¸æ‰§è¡Œè€…çš„èº«ä»½ç›¸åŒï¼Œä¹Ÿä¸éœ€è¦è¾“å…¥å¯†ç 

visudoä½¿ç”¨viæ‰“å¼€/etc/sudoersæ–‡ä»¶ï¼Œä½†æ˜¯åœ¨ä¿å­˜é€€å‡ºæ—¶ï¼Œvisudoä¼šæ£€æŸ¥å†…éƒ¨è¯­æ³•ï¼Œé¿å…ç”¨æˆ·è¾“å…¥é”™è¯¯ä¿¡æ¯
visudoéœ€è¦rootæƒé™
æ‰¾åˆ°#%wheel ALL=(ALL) ALL,åœ¨å…¶ä¸‹æ–¹æ·»åŠ å¦‚ä¸‹ä¸€è¡Œ,å¯¹ç”¨æˆ·ç»„devæˆäºˆsudoæƒé™

%dev ALL=ALL(ALL) ALL

```





### æœç´¢

```bash
find[æœç´¢èŒƒå›´][é€‰é¡¹]
#æ ¹æ®åç§°,æŸ¥æ‰¾/home æ–‡ä»¶å¤¹ä¸‹è¾¹çš„ a.txt æ–‡ä»¶
find /home -name a.txt
find /home -name mysql.*
#æ ¹æ®æ–‡ä»¶çš„æ‹¥æœ‰è€… æ¥æŸ¥æ‰¾
find /home -user zhangwuji
#æŸ¥æ‰¾ linux ä¸‹å¤§äº 10M çš„æ–‡ä»¶
find /home -size +20M
```

```bash
#head è¾“å…¥æ–‡ä»¶å¼€å¤´éƒ¨åˆ†çš„å†…å®¹
head -n 5 #æ˜¾ç¤ºæ–‡ä»¶å¤´äº”è¡Œçš„å†…å®¹,ä¸åŠ é€‰é¡¹,é»˜è®¤æ˜¾ç¤ºå‰ 10 è¡Œ

#tail é»˜è®¤æ˜¾ç¤ºæ–‡ä»¶ç»“æŸéƒ¨åˆ†çš„å‰10 è¡Œ
tai -n 10
tail -f #å®æ–½è¿½è¸ªè¯¥æ–‡æ¡£çš„æ‰€æœ‰æ›´æ–°,é‡ç‚¹
```

```bash
#è¯•è¯•ç›‘æ§ä¸€ä¸ªæ–‡ä»¶,å¦‚æœè¯¥æ–‡ä»¶æ›´æ–°åˆ™è¿½åŠ æ—¥æœŸ
1 ã€ å½“ä¸€ä¸ªç»ˆç«¯ ls -l >>mydata.txt
2 ã€ æ­¤ç»ˆç«¯çš„ tail -f mydata.txt ä¼šå˜åŒ–
```



### å‹ç¼©

```bash
#å½“æˆ‘ä»¬ç”¨ gzip å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©å,ä¸ä¼šä¿ç•™ä¹‹å‰çš„æ–‡ä»¶
gzip hello.txt
gunzip 

#zip å‹ç¼©æ–‡ä»¶ unzip è§£å‹æ–‡ä»¶
#å¸¸ç”¨é€‰é¡¹ 
 -r :é€’å½’å‹ç¼©,å³å‹ç¼©ç›®å½•
# æŒ‡å®šè§£å‹åˆ°çš„å­˜æ”¾ç›®å½•
unzip -d 

tar æ‰“åŒ…æŒ‡ä»¤,æœ€åæ‰“åŒ…çš„æ–‡ä»¶æ˜¯ xxx.tar.gz
-z æ‰“åŒ…åŒæ—¶å‹ç¼©
-c äº§ç”Ÿ.tar æ‰“åŒ…æ–‡ä»¶
-v æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
-x è§£åŒ….tar æ–‡ä»¶
-f æŒ‡å®šè¦ç´ åçš„æ–‡ä»¶å

#å‹ç¼©å¤šä¸ªæ–‡ä»¶ å°†/home/1.txt å’Œ/home/2.txt æ–‡ä»¶ æœ‰æ‰€æˆ a.tar.gz
tar -cvzf a.tar.gz 1.txt 2.txt

#å°† mysql.tar.gz è§£å‹åˆ°/opt/www ä¸‹
tar -xvzf mysql.tar.gz -C /opt/www

```





### vimium

```

å•ä¸ªé¡µé¢çš„æ“ä½œ

j å‘ä¸‹æ»šåŠ¨é¡µé¢ (scrollDown)
k å‘ä¸Šæ»šåŠ¨é¡µé¢ (scrollUp)
d å‘ä¸‹æ»šåŠ¨åŠå±é¡µé¢ (scrollPageDown)
u å‘ä¸Šæ»šåŠ¨åŠå±é¡µé¢ (scrollPageUp)
gg å‘ä¸Šæ»šåŠ¨åˆ°é¡µé¢æœ€ä¸Šæ–¹ (scrollToTop)
G å‘ä¸‹æ»šåŠ¨åˆ°é¡µé¢æœ€åº•éƒ¨ (scrollToBottom)
yy èµ‹å€¼å½“å‰urlåˆ°å‰ªåˆ‡æ¿ Copy the current URL to the clipboard
gi èšç„¦é¡µé¢ç¬¬ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡† Focus the first text input on the page (focusInput)
f Open a link in the current tab (LinkHints.activateMode)
F Open a link in a new tab

å¤šæ ‡ç­¾é¡µæ“ä½œ

yt é‡æ–°æ‰“å¼€ä¸€ä¸ªå½“å‰æ ‡ç­¾é¡µ Duplicate current tab (duplicateTab)
W  å°†å½“å‰tabç§»åŠ¨åˆ°æ–°çª—å£  (moveTabToNewWindow)
T   é€šè¿‡æ‰“å¼€çš„tabè¿›è¡Œæœç´¢ Search through your open tabs
```

## hombrew

```shell
brew ls tmux #æŸ¥çœ‹è½¯ä»¶å®‰è£…çš„ä½ç½®
```

## ideaVim

```SHELL
:actionlist #åˆ—å‡ºidea æ‰€æœ‰çš„åŠ¨ä½œæ˜ å°„
```

```shell
gs        #å‰å¾€ç±»çš„æ˜¯å®ç°
<leader>s #æŸ¥çœ‹ç±»çš„æ–¹æ³•åˆ—è¡¨
<leader>` #æ‰“å¼€æ–‡ä»¶æµè§ˆå™¨   
<leader>h #æ–‡ä»¶æµè§ˆå™¨çš„æ˜¾ç¤ºå’Œéšè—
<leader>u #æŸ¥çœ‹æ­¤æ–¹æ³•åœ¨åˆ«çš„ç±»ä¸­çš„æ‰€æœ‰è°ƒç”¨
<leader>t #æ‰“å¼€é‡æ„ pop
<leader>n #åŠ æ–­ç‚¹
<leader>i #maven install
<leader>p #æœ€è¿‘é¡¹ç›®
<leader>g #æ‰“å¼€æ„é€  pop
```



## alacritty

`ctrl+shift+space`æ¿€æ´»viæ¨¡å¼





## tmux

```shell
#åˆ›å»ºå›è¯
tmux new -s <sessionName>

#é€€å‡º
exit æˆ–è€… Ctrl+d

#æ‰“å¼€ sessionåˆ—è¡¨
ctrl+b s æˆ–è€… tmux ls
#é‡å‘½åå›è¯
ctrl+b $
#ç¦»å¼€å›è¯,åå°è¿è¡Œ
ctrl+b d æˆ–è€… tmux detach
#è¿›å…¥ session
tmux attach -t <sessionName>
#åˆ é™¤æ‰€æœ‰session
Ctrl+b :kill-server
#åˆ é™¤session
Ctrl+b :kill-session
#åˆ é™¤æŒ‡å®šsession
tmux kill-session -t $session_name
#åˆ—å‡ºohmytmux æ‰€æœ‰çš„å¿«æ·é”®
ctrl+b ?
#çƒ­é”®
ohmytmux é»˜è®¤è®¾ç½®äº†çƒ­é”® ctrl+f å’Œ ctrl+a

#åˆ›å»ºçª—å£
ctrl+b c
#åˆ‡æ¢åˆ° 2å·çª—å£
ctrl+b 2
#é‡å‘½åçª—å£
ctrl+b ,
#å…³é—­çª—å£
ctrl+b &

#æ°´å¹³åˆ‡åˆ†
ctrl+b %  
#å‚ç›´åˆ‡åˆ†
ctrl+b "  
#å…³é—­çª—æ ¼
ctrl+b x`
```



ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… tmuxï¼Œlinuxä¸macéƒ½å¯ä»¥ä½¿ç”¨[brew (opens new window)](http://houdunren.gitee.io/note/linux/2 å¸¸ç”¨å·¥å…·.html#brew)è¿›è¡Œå®‰è£…

```shell
# Mac
$ brew install tmux

# Ubuntu æˆ– Debian
$ sudo apt-get install tmux

# CentOS æˆ– Fedorå¯ä»¥ä½¿ç”¨yum/dnf/brewç­‰æ–¹å¼å®‰è£…ï¼Œbrewç‰ˆæœ¬æ›´é«˜äº›
$ yum install tmux
```

### å­—ä½“å›¾æ ‡

æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤å®‰è£…å­—ä½“å›¾æ ‡åˆ°ç³»ç»Ÿä¸­ï¼Œæœ‰äº›é£æ ¼éœ€è¦å›¾æ ‡æ—¶å°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†

```text
cd
git clone https://github.com/powerline/fonts.git --depth=1
cd fonts
./install.sh
cd ..
rm -rf fonts
```

ä½¿ç”¨çš„æ˜¯ item2 éœ€è¦è¿›è¡Œä»¥ä¸‹è®¾ç½®

![image-20200109152424996](https://gitee.com/ibepo/ogcip/raw/master/20220127130350.png)

### [#](https://doc.houdunren.com/soft/10 tmux.html#å®‰è£…é£æ ¼)å®‰è£…é£æ ¼

ä¸‹é¢ä»‹ç»ä¸¤æ¬¾é£æ ¼åŒ…

**tmux-onedark-theme**

å¤§å”å–œæ¬¢é¢œè‰²ä¸é‚£ä¹ˆé²œè‰³çš„ [tmux-onedark-theme (opens new window)](https://github.com/odedlaz/tmux-onedark-theme)é£æ ¼

![image-20200109160737009](https://gitee.com/ibepo/ogcip/raw/master/20220127110837.png)

å®‰è£…æ–¹å¼å¦‚ä¸‹

1. Clone é¡¹ç›®ä»£ç 

   ```text
   git clone https://github.com/odedlaz/tmux-onedark-theme
   ```

2. åˆ é™¤åŸ~/.tmux.confæ–‡ä»¶ï¼ˆæ³¨æ„ä¸æ˜¯åˆ é™¤å†…å®¹ï¼Œå› ä¸ºå­˜åœ¨çš„.tmux.confå¯èƒ½æ˜¯è½¯é“¾æ¥ï¼‰ï¼Œç„¶åæ–°å»ºé…ç½®æ–‡ä»¶ `~/.tmux.conf` æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œå¦‚æœæƒ³æ˜¾ç¤ºå®Œæ•´æ—¥æœŸå°±å°†å‰2~4è¡Œæ³¨é‡Šæ‰ã€‚

   ```text
   run-shell ~/tmux-onedark-theme/tmux-onedark-theme.tmux
   set -g @onedark_widgets " "
   set -g @onedark_time_format "%I:%M "
   set -g @onedark_date_format "%m/%d"
   set-option -g status-position bottom
   ```

3. åŠ è½½é…ç½®

   ```text
   tmux source-file ~/.tmux.conf
   ```

**gpakosz/.tmux**

tmux çš„é£æ ¼åŒ…å¾ˆå¤šï¼Œä¸‹é¢ä»‹ç» [gpakosz/.tmux (opens new window)](https://github.com/gpakosz/.tmux)é£æ ¼åŒ…çš„å®‰è£…æ–¹æ³•

![Screenshot](https://gitee.com/ibepo/ogcip/raw/master/20220127110843.gif)

é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…é£æ ¼ï¼Œä¹‹åé€šè¿‡ä¿®æ”¹ `ï½/.tmux.conf.local` æ¥å®šä¹‰ç•Œé¢

```text
cd
git clone https://github.com/gpakosz/.tmux.git
ln -s -f .tmux/.tmux.conf
cp .tmux/.tmux.conf.local .
```

é‡æ–°åŠ è½½ tmux é…ç½®é¡¹ä»¥ä½¿é£æ ¼ç”Ÿæ•ˆ

```text
tmux source-file ~/.tmux.conf
```

### ä¼šè¯ç®¡ç†

ä¼šè¯æ˜¯æœ€å¤§çš„å•ä½ï¼ŒåŒ…å«çª—å£ä¸çª—æ ¼

| å‘½ä»¤                | è¯´æ˜                                     | å¿«æ·é”®   |
| ------------------- | ---------------------------------------- | -------- |
| tmux new -s         | åˆ›å»ºä¼šè¯                                 |          |
| tmux detach         | é€€å‡ºå½“å‰ä¼šè¯ï¼Œä¼šè¯è¿›ç¨‹ä»ç„¶åœ¨åå°è¿è¡Œ     | Ctrl+b d |
| tmux ls             | æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„ ä¼šè¯                      | Ctrl+b s |
| tmux attach -t      | é‡æ–°æ¥å…¥æŸä¸ªå·²å­˜åœ¨çš„ä¼šè¯                 |          |
| tmux kill-session   | æ€æ­»æŸä¸ªä¼šè¯                             |          |
| tmux switch -t      | åˆ‡æ¢ä¼šè¯                                 |          |
| tmux rename-session | é‡æ–°å‘½åä¼šè¯                             | Ctrl+b $ |
| tmux at -d          | é‡ç»˜çª—å£ï¼Œåœ¨ä¸åŒå±å¹•ä¸Šä¿æŒçª—å£ä¸ºæœ€å°å°ºå¯¸ |          |

tmuxé»˜è®¤ä¼šåŒæ­¥ä¼šè¯åˆ°æ‰€æœ‰çª—å£ï¼Œå¹¶ä½¿ç”¨å°ºå¯¸æœ€å°çª—å£çš„å°ºå¯¸ï¼Œè¿™ä¼šé€ æˆå¤§çª—å£æœ‰å°ç‚¹ã€‚

![image-20200123210737845](https://gitee.com/ibepo/ogcip/raw/master/20220127110850.png)

ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ¥è§£å†³

```shell
tmux at -d #ç®€å†™ä¸º tmux a -d
```

### çª—å£ç®¡ç†

çª—å£å±äºä¼šè¯ï¼Œçª—å£åŒ…å«å¤šä¸ªçª—æ ¼

| å‘½ä»¤                  | è¯´æ˜           | å¿«æ·é”®   |
| --------------------- | -------------- | -------- |
| tmux new-window -n    | åˆ›å»ºæ–°çª—å£     | Ctrl+b c |
| tmux select-window -t | åˆ‡æ¢çª—å£       |          |
| tmux rename-window    | é‡å‘½åå½“å‰çª—å£ | Ctrl+b , |

åˆ‡æ¢çª—å£å¿«æ·é”®

| å¿«æ·é”®   | è¯´æ˜                                              |
| -------- | ------------------------------------------------- |
| Ctrl+b p | åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªçª—å£ï¼ˆæŒ‰ç…§çŠ¶æ€æ ä¸Šçš„é¡ºåºï¼‰            |
| Ctrl+b n | åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£                                  |
| Ctrl+b   | åˆ‡æ¢åˆ°æŒ‡å®šç¼–å·çš„çª—å£ï¼Œnumber æ˜¯çŠ¶æ€æ ä¸Šçš„çª—å£ç¼–å· |
| Ctrl+b w | ä»åˆ—è¡¨ä¸­é€‰æ‹©çª—å£                                  |
| ctrl+b & | å…³é—­å½“å‰çª—å£                                      |
| ctrl+b x | åˆ é™¤çª—å£                                          |

### [#](https://doc.houdunren.com/soft/10 tmux.html#çª—æ ¼ç®¡ç†)çª—æ ¼ç®¡ç†

**æ‹†åˆ†çª—æ ¼**

| å‘½ä»¤                 | è¯´æ˜             |
| -------------------- | ---------------- |
| tmux split-window -h | åˆ’åˆ†å·¦å³ä¸¤ä¸ªçª—æ ¼ |
| tmux split-window    | åˆ’åˆ†ä¸Šä¸‹ä¸¤ä¸ªçª—æ ¼ |

**ç§»åŠ¨çª—æ ¼**

| å‘½ä»¤                | è¯´æ˜               |
| ------------------- | ------------------ |
| tmux select-pane -U | å…‰æ ‡åˆ‡æ¢åˆ°ä¸Šæ–¹çª—æ ¼ |
| tmux select-pane -D | å…‰æ ‡åˆ‡æ¢åˆ°ä¸‹æ–¹çª—æ ¼ |
| tmux select-pane -L | å…‰æ ‡åˆ‡æ¢åˆ°å·¦è¾¹çª—æ ¼ |
| tmux select-pane -R | å…‰æ ‡åˆ‡æ¢åˆ°å³è¾¹çª—æ ¼ |
| tmux swap-pane -U   | å½“å‰çª—æ ¼ä¸Šç§»       |
| tmux swap-pane -D   | å½“å‰çª—æ ¼ä¸‹ç§»       |

**çª—æ ¼å¿«æ·é”®**

| å¿«æ·é”®            | è¯´æ˜                                       |
| ----------------- | ------------------------------------------ |
| Ctrl+b %          | åˆ’åˆ†å·¦å³ä¸¤ä¸ªçª—æ ¼                           |
| Ctrl+b "          | åˆ’åˆ†ä¸Šä¸‹ä¸¤ä¸ªçª—æ ¼                           |
| Ctrl+b ;          | åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªçª—æ ¼                           |
| Ctrl+b o          | å…‰æ ‡åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—æ ¼                       |
| Ctrl+b {          | å½“å‰çª—æ ¼å·¦ç§»                               |
| Ctrl+b }          | å½“å‰çª—æ ¼å³ç§»                               |
| Ctrl+b Ctrl+o     | å½“å‰çª—æ ¼ä¸Šç§»                               |
| Ctrl+b Alt+o      | å½“å‰çª—æ ¼ä¸‹ç§»                               |
| Ctrl+b x          | å…³é—­å½“å‰çª—æ ¼                               |
| Ctrl+b !          | å°†å½“å‰çª—æ ¼æ‹†åˆ†ä¸ºä¸€ä¸ªç‹¬ç«‹çª—å£               |
| Ctrl+b z          | å½“å‰çª—æ ¼å…¨å±æ˜¾ç¤ºï¼Œå†ä½¿ç”¨ä¸€æ¬¡ä¼šå˜å›åŸæ¥å¤§å° |
| Ctrl+b q          | æ˜¾ç¤ºçª—æ ¼ç¼–å·                               |
| Ctrl+b Alt+æ–¹å‘é”® | è°ƒæ•´çª—æ ¼å¤§å°                               |

### [#](https://doc.houdunren.com/soft/10 tmux.html#ä¿å­˜ä¼šè¯)ä¿å­˜ä¼šè¯

é»˜è®¤æƒ…å†µä¸‹å½“é‡èµ·ç³»ç»Ÿåï¼Œéœ€è¦é‡æ–°å®šä¹‰tmuxçª—å£ï¼Œè¿™å¾ˆä¸æ˜¯æ–¹ä¾¿ã€‚

### [#](https://doc.houdunren.com/soft/10 tmux.html#å®‰è£…æ’ä»¶)å®‰è£…æ’ä»¶

æˆ‘ä»¬éœ€è¦å®‰è£… [tmp (opens new window)](https://github.com/tmux-plugins/tpm)ä¸[tmux-resurrect (opens new window)](https://github.com/tmux-plugins/tmux-resurrect)æ’ä»¶

```text
git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
git clone https://github.com/tmux-plugins/tmux-resurrect ~/.tmux/plugins/resurrect
```

ä¿®æ”¹é…ç½®æ–‡ä»¶ `~/.tmux.conf`æ·»åŠ ä»¥ä¸‹å†…å®¹

```text
# è‡ªåŠ¨ä¿å­˜ä¼šè¯
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-save-interval '15'
set -g @continuum-restore 'on'
set -g @resurrect-capture-pane-contents 'on'
run '~/.tmux/plugins/tpm/tpm'

run-shell ~/.tmux/plugins/resurrect/resurrect.tmux
```

è¿”å›ç»ˆç«¯é‡æ–°åŠ è½½é…ç½®é¡¹

```text
tmux source ~/.tmux.conf
```

ç„¶åæ‰§è¡Œå‘½ä»¤å®‰è£…æ’ä»¶

```text
prefix + I 
```

### [#](https://doc.houdunren.com/soft/10 tmux.html#ä¿å­˜ä¼šè¯-2)ä¿å­˜ä¼šè¯

æ’ä»¶å®‰è£…åå°±å¯ä»¥ç®¡ç†ä¼šè¯äº†ï¼Œä¸‹ä¾‹ä¸­çš„ prefixå°±æ˜¯.tmux.confæ–‡ä»¶ä¸­å®šä¹‰çš„prefix

ä¿å­˜ä¼šè¯

```text
prefix + Ctrl-s
```

æ¢å¤ä¼šè¯

```text
prefix + Ctrl-r
```

## [#](https://doc.houdunren.com/soft/10 tmux.html#å¤§å”é…ç½®)å¤§å”é…ç½®

ä¸‹é¢æ˜¯æˆ‘é…ç½®å¥½çš„.tmux.confæ–‡ä»¶å†…å®¹ï¼Œä½†è¦æ³¨æ„é‡Œé¢æœ‰æ’ä»¶çš„é…ç½®ï¼Œæ‰€ä»¥éœ€è¦ä¿è¯å·²ç»å®‰è£…äº†ç›¸å…³æ’ä»¶ã€‚

```shell
run-shell ~/tmux-onedark-theme/tmux-onedark-theme.tmux

set -g @onedark_widgets "houdunren.com < Bç«™/æŠ–éŸ³@åç›¾äºº #(ip)"
set -g @onedark_time_format "%I:%M %p"
set -g @onedark_date_format "%Y/%m/%d"
set-option -g default-terminal "screen-256color"
set -g default-terminal "screen-256color"

# è§£å†³neovimä¸­escå“åº”æ…¢
set -s escape-time 0
set-option -g status-position bottom

# è‡ªåŠ¨ä¿å­˜ä¼šè¯
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-save-interval '15'
set -g @continuum-restore 'on'
set -g @resurrect-capture-pane-contents 'on'
run '~/.tmux/plugins/tpm/tpm'

run-shell ~/.tmux/plugins/resurrect/resurrect.tmux

# è§£é™¤é»˜è®¤å‰ç¼€
unbind C-b
# è®¾ç½®è‡ªå®šä¹‰å‰ç¼€
set -g prefix C-f
# é‡‡ç”¨vimçš„æ“ä½œæ–¹å¼
setw -g mode-keys vi
# çª—å£åºå·ä»1å¼€å§‹è®¡æ•°
set -g base-index 1
# å¼€å¯é¼ æ ‡æ¨¡å¼
set-option -g mouse on

# é€šè¿‡å‰ç¼€+KJHLå¿«é€Ÿåˆ‡æ¢pane
#up
bind-key k select-pane -U
#down
bind-key j select-pane -D
#left
bind-key h select-pane -L
#right
bind-key l select-pane -R
```

[tmux-plugins/tpm: Tmux Plugin Manager (github.com)](https://github.com/tmux-plugins/tpm)





## è½¯è¿æ¥

### linux

```shell
ln -s  /home/ubuntu/dotfiels/.oh-my-zsh ~/.oh-my-zsh
```

### macox

```shell
ln -s /Users/ibepo/dotfiles/.oh-my-zsh ~/.oh-my-zsh
```



## vim

![image-20211122155323410](https://gitee.com/ibepo/ogcip/raw/master/20211122155324.png)

```
ctrl+u åˆ é™¤å‘½ä»¤è¡Œå¼€å§‹è‡³å…‰æ ‡å¤„
ctrl+k åˆ é™¤å…‰æ ‡å¤„è‡³å‘½ä»¤è¡Œç»“å°¾
ctrl+a å…‰æ ‡ç§»åŠ¨åˆ°æœ€å‰é¢
ctrl+e å…‰æ ‡ç§»åŠ¨åˆ°æœ€åé¢
```

```shell
vim å…¨é€‰ï¼Œå…¨éƒ¨å¤åˆ¶ï¼Œå…¨éƒ¨åˆ é™¤
å…¨é€‰ï¼ˆé«˜äº®æ˜¾ç¤ºï¼‰ï¼šæŒ‰escåï¼Œç„¶åggvGæˆ–è€…ggVG
å…¨éƒ¨å¤åˆ¶ï¼šæŒ‰escåï¼Œç„¶åggyG
å…¨éƒ¨åˆ é™¤ï¼šæŒ‰escåï¼Œç„¶ådG
è§£æï¼š
ggï¼šæ˜¯è®©å…‰æ ‡ç§»åˆ°é¦–è¡Œï¼Œåœ¨vimæ‰æœ‰æ•ˆï¼Œviä¸­æ— æ•ˆ 
v ï¼š æ˜¯è¿›å…¥Visual(å¯è§†ï¼‰æ¨¡å¼ \
G ï¼šå…‰æ ‡ç§»åˆ°æœ€åä¸€è¡Œ 
é€‰ä¸­å†…å®¹ä»¥åå°±å¯ä»¥å…¶ä»–çš„æ“ä½œäº†ï¼Œæ¯”å¦‚ï¼š 
d  åˆ é™¤é€‰ä¸­å†…å®¹ 
y  å¤åˆ¶é€‰ä¸­å†…å®¹åˆ°0å·å¯„å­˜å™¨ 
+y  å¤åˆ¶é€‰ä¸­å†…å®¹åˆ°ï¼‹å¯„å­˜å™¨ï¼Œä¹Ÿå°±æ˜¯ç³»ç»Ÿçš„å‰ªè´´æ¿ï¼Œä¾›å…¶ä»–ç¨‹åºç”¨ 
```

```shelll

 ln -s /home/ubuntu/dotfiles/nvim/  ~/.config/nvim
```



### vimrc

[VIMå­¦ä¹ ç¬”è®° é…ç½®æ–‡ä»¶(vimrc) - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/154383194)



### é«˜é¢‘æ“ä½œ

- `:w` å¿«é€Ÿä¿å­˜
- `%`  åœ¨èŠ±æ‹¬å·æˆ–è€…ä¸­æ‹¬å·ä¸­é—´å¼€å§‹å’Œç»“å°¾è¿›è¡Œè·³è½¬
- `<C-[>` é€€å‡º insert æ¨¡å¼ï¼Œä¸ `esc` ç±»ä¼¼
- `0` å¿«é€Ÿç§»åŠ¨åˆ°è¡Œé¦–
- `gg` å¿«é€Ÿç§»åŠ¨åˆ°æ–‡ä»¶é¦–
- `G` å¿«é€Ÿç§»åŠ¨è‡³æ–‡ä»¶å°¾
- `<c-o>` ç§»åŠ¨è‡³æœ€è¿‘ä¸€æ¬¡ä½ç½®
- `<c-i>` è¿”å›å½“å‰ç¼–è¾‘ä½ç½®
- `zz` æŠŠå…‰æ ‡ç§»åŠ¨è‡³æœ¬å±ä¸­é—´
- `:12` å¿«é€Ÿç§»åŠ¨è‡³ç‰¹å®šè¡Œ
- `dd` å‰ªåˆ‡æœ¬è¡Œ
- `yy` å¤åˆ¶æœ¬è¡Œ
- `yi{` å¤åˆ¶æ‹¬å·ä¸­å†…å®¹
- `=i{` è‡ªåŠ¨ç¼©è¿›
- `<c-p>` è‡ªåŠ¨è¡¥å…¨
- `"*yy` å¤åˆ¶åˆ°ç³»ç»Ÿå‰ªåˆ‡æ¿
- `*` å¿«é€ŸæŸ¥æ‰¾å…³é”®å­—ï¼Œç±»ä¼¼äºsublime/vscode çš„ `Command + d`
- `:noh` å–æ¶ˆå…³é”®å­—é«˜äº®
- `o` å¿«é€Ÿè¿›å…¥ insert æ¨¡å¼ï¼Œå¹¶å®šä½åˆ°ä¸‹ä¸€è¡Œ
- `u` æ’¤é”€
- `:vs` å‚ç›´åˆ†é…
- `:sp` æ°´å¹³åˆ†å±
- `<c-w> +hjkl` çª—å£é—´ç§»åŠ¨

### ç§»åŠ¨

#### å­—æ¯é—´è·³åŠ¨

<img src="https://gitee.com/ibepo/ogcip/raw/master/20211122150127.png" alt="image-20211122150126543" style="zoom:50%;" />

- `f{char}`  å‘åæŸ¥æ‰¾ç›¸å…³å­—æ¯
- `F{char}` å‘å‰æŸ¥æ‰¾ç›¸å…³å­—æ¯
- `;` é‡å¤ä¸Šæ¬¡å­—ç¬¦æŸ¥æ‰¾
- `,` åå‘é‡å¤ä¸Šæ¬¡æŸ¥æ‰¾



#### å•è¯é—´è·³åŠ¨

<img src="https://gitee.com/ibepo/ogcip/raw/master/20211122104214.png" alt="image-20211122104214437" style="zoom:50%;" />

- `w` è·³åˆ°ä¸€ä¸ªå•è¯å¼€å¤´
- `b` è·³åˆ°æœ¬å•è¯æˆ–ä¸Šä¸€ä¸ªå•è¯çš„å¼€å¤´
- `e` è·³åˆ°æœ¬å•è¯æˆ–ä¸‹ä¸€ä¸ªå•è¯çš„ç»“å°¾
- `ge` è·³åˆ°ä¸Šä¸€ä¸ªå•è¯ç»“å°¾

#### è¡Œé—´è·³åŠ¨

<img src="https://gitee.com/ibepo/ogcip/raw/master/20211122133225.png" alt="image-20211122133224492" style="zoom:50%;" />

- `O`     è·³åˆ°è¡Œé¦–
- `^`     è·³åˆ°ä»è¡Œé¦–å¼€å§‹ç¬¬ä¸€ä¸ªéç©ºå­—ç¬¦
- `$`     è·³åˆ°è¡Œå°¾
- `gg`   è·³åˆ°ç¬¬ä¸€è¡Œ
- `G`     è·³åˆ°æœ€åä¸€è¡Œ



### åŠ¨ä½œ

<img src="https://gitee.com/ibepo/ogcip/raw/master/20211122151017.png" alt="image-20211122151017105" style="zoom:50%;" />

- `i`å’Œ`a`çš„åŒºåˆ«å°±æ˜¯åŒ…ä¸åŒ…æ‹¬`é”šç‚¹å­—ç¬¦`

- `i`å’Œ`a`å±äº`è·‘é©¬åœˆåœ°`çš„`èŒƒå›´ç¼©å°å™¨`,è¦é…åˆä¸Šç›¸åº”çš„è¡Œä¸º,

  `c`ä¿®æ”¹,åˆ é™¤ä¹‹å‰çš„å¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼

  `d`åˆ é™¤,ä¸ä»…å¦‚æ­¤ç¼–è¾‘æ¨¡å¼ 

â€‹       `y`å¤åˆ¶

- `ciw`  **change inner word**  é€‰ä¸­å½“å‰çš„å•è¯,å¹¶åˆ é™¤å®ƒ,è¿›å…¥ä¿®æ”¹æ¨¡å¼

- `dw`     å¯ä»¥ä»å…‰æ ‡å¤„åˆ é™¤è‡³ä¸€ä¸ªå•è¯çš„æœ«å°¾

-  `d$` ä»å½“å‰å…‰æ ‡åˆ é™¤åˆ°è¡Œæœ«

- `diw`   delect inner word

- `yiw`   copy innner word

- `dib`   åˆ é™¤æ‹¬å·å†…å†…å®¹

- `ci[`   åˆ é™¤æ•°ç»„å†…å†…å®¹

- `ci` `  åˆ é™¤æ¨¡æ¿å­—ç¬¦ä¸²çš„å†…å®¹

- `2dd` åˆ é™¤ä¸¤è¡Œ

- `2cc`åˆ é™¤å¹¶ç¼–è¾‘ä¸¤è¡Œ

- `2yy`å¤åˆ¶ä¸¤è¡Œ

- ```shell
  #vim is awesome
  ```

  `dfa`  åˆ é™¤`vim is a`

  `d^`    ä»æ­¤å¤„åˆ é™¤åˆ°å¼€å¤´

  `d$`   ä»æ­¤å¤„åˆ é™¤åˆ°ç»“å°¾

- `die` åˆ é™¤å…¨éƒ¨

- `yie` å¤åˆ¶å…¨éƒ¨

### æ—¥å¸¸æ€»ç»“

- `zz`  å°†å…‰æ ‡æ‰€åœ¨ä½ç½®,ç§»åŠ¨åˆ°å±å¹•çš„ä¸­å¤®
- `ctrl+u` å‰è¿›ä¸€é¡µ
- `ctrl+d` åé€€ä¸€é¡µ
- `normal æ¨¡å¼ä¸‹` æŒ‰`shift+a` åœ¨å½“å‰è¡Œçš„è¡Œå°¾,append
- `normal æ¨¡å¼ä¸‹` æŒ‰`shift+i` åœ¨å½“å‰è¡Œçš„è¡Œé¦–,append
- `shift+z+q`  ç­‰åŒäº`:q!` , å¼ºåˆ¶é€€å‡ºä¸ä¿å­˜
- `shift+z+z` ç­‰åŒäº`:wq`,é€€å‡ºå¹¶ä¿å­˜
- `xp` äº¤æ¢å‰åä¸¤ä¸ªå­—ç¬¦
- `ddp`äº¤æ¢ä¸¤è¡Œ
- `bi`åœ¨å½“å‰å•è¯çš„å‰è¾¹æ’å…¥å•è¯
- `ea`åœ¨å½“å‰å•è¯çš„åè¾¹æ’å…¥å•è¯

| æ ‡è¯†ç¬¦å·               | ä»£è¡¨å«ä¹‰                                   |
| ---------------------- | ------------------------------------------ |
| `<Esc>`                | ä»£è¡¨ `Escape` é”®                           |
| `<CR>`                 | ä»£è¡¨ `Enter` é”®                            |
| `<C-Esc>`              | ä»£è¡¨ `Ctrl-Esc`                            |
| `<S-F1>`               | è¡¨ç¤º `Shift-F1`                            |
| `<D>`                  | ä»£è¡¨ `Command` é”®ï¼Œå¯¹äº Mac ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨ |
| `<M-key>` æˆ– `<A-key>` | ä»£è¡¨ `Alt` é”®                              |

<img src="https://gitee.com/ibepo/ogcip/raw/master/20211126154057.png" alt="image-20211126154056356" style="zoom:50%;" />



![image-20211215085550135](https://gitee.com/ibepo/ogcip/raw/master/20211215085550.png)



Plug-vim çš„ä¸­å›½åœ°å€é•œåƒ

```shell
curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
https://gitee.com/ibepo/dotfiles/raw/master/.config/nvim/autoload/plug.vim
```



## æ’ä»¶

```shell
Plug 'mg979/vim-visual-multi'
```

- `S-Right`,ç”¨ shift+é¼ æ ‡å³é”®é€‰æ‹©`chart`,é€šè¿‡`n`å‘ä¸‹ç§»åŠ¨,é€šè¿‡`N`å‘ä¸Šç§»åŠ¨, å’Œ`'lfv89/vim-interestingwords`åŠŸèƒ½ç±»ä¼¼



```shell
Plug 'junegunn/vim-peekaboo'
```

- `"`è°ƒå‡ºå¯„å­˜å™¨å†å²è®°å½•



```shell
CocConfig coc-explorer
```

- `tt` toggle coc-explorer
- `<leader>e` æ‰“å¼€explorer



```shell
Plug 'easymotion/vim-easymotion'
let g:EasyMotion_do_mapping = 0        "å–æ¶ˆç¼ºçœæ˜ å°„
map <leader>f <Plug>(easymotion-bd-f)  "é›™å‘æœå°‹ï¼Œæœå°‹çµæœä¸é™åˆ¶åœ¨æ­¤è¡Œ
map <leader>s <Plug>(easymotion-s2)    "ä½¿ç”¨å…©å€‹å­—æ¯æœ€ç‚ºé™åˆ¶å»æœå°‹
```



```shell
Plug 'justinmk/vim-sneak'
```

- ç®€åŒ–ç‰ˆçš„] easymotion
- `f+{char}{char}`è‡ªåŠ¨è·³è½¬



```shell
Plug 'jiangmiao/auto-pairs'
```

- ä½¿ç”¨ auto-pairs æ’ä»¶ï¼Œå¯ä»¥åœ¨ Vim æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¾“å…¥å·¦å¤§æ‹¬å·åè‡ªåŠ¨è¡¥å…¨å³å¤§æ‹¬å·
- åœ¨ä¸€å¯¹æ‹¬å·ä¹‹é—´æŒ‰å›è½¦é”®ï¼Œå°†è‡ªåŠ¨åˆ†ä¸º 3 è¡Œå¹¶è°ƒæ•´ç¼©è¿›å’Œå…‰æ ‡ä½ç½®



```shell
Plug 'airblade/vim-gitgutter'
```

- `<leader>gf` æŠ˜å æœªä¿®æ”¹çš„ä»£ç 



```shell
Plug 'tpope/vim-surround'
```

| é”®                    | åŸå†…å®¹               | ç»“æœ                   |
| --------------------- | -------------------- | ---------------------- |
| å•è¯åŠ å¼•å·ysiw'       | houdunren.com        | 'houdunren.com'        |
| æ·»åŠ æ ‡ç­¾ ysiwt h2     | houdunren.com        | houdunren.com          |
| æ•´è¡ŒåŠ å¼•å· yss"       | houdunren.com åç›¾äºº | "houdunren.com åç›¾äºº" |
| æ›¿æ¢ä¸ºå•å¼•å· cs"'     | "houdunren"          | 'houdunren.com'        |
| æ•´è¡Œæ›¿æ¢ cS'"         | 'houdunren'          | "houdunren"            |
| æ›¿æ¢å¼•å·ä¸ºæ ‡ç­¾cs"t h2 | 'houdunren'          | houdunren              |
| åˆ é™¤ç»°å· ds'          | 'ds'                 | ds                     |
| åˆ é™¤æ ‡ç­¾ dst          | houdunren            | Houdunren              |

```shell
Plug 'terryma/vim-smooth-scroll'
```
- `c+j` å¹³æ»‘å‘ä¸‹æ»šåŠ¨ä¸€å±
- `c+k` å¹³æ»‘å‘ä¸Šæ»šåŠ¨ä¸€å±

## spacevim

### å®‰è£…spacevim

```shell
curl -sLf https://spacevim.org/cn/install.sh | bash
```
## Traefik

### ç®€ä»‹

å¦‚æœçœ‹è¿‡æˆ‘[ä¹‹å‰çš„æ–‡ç« ](https://soulteary.com/tags/traefik.html)ï¼Œé‚£ä¹ˆä½ ä¼š Traefik è¿™ä¸ªè½¯ä»¶åº”è¯¥æœ‰ä¸€äº›ç®€å•çš„ç†è§£ï¼Œæä¾›ç±»ä¼¼ Nginx çš„è´Ÿè½½èƒ½åŠ›ï¼Œä¸åŒçš„æ˜¯å¯ä»¥è‡ªåŠ¨åŒ–é…ç½® â€œ`upstream`â€ï¼Œæˆ–è€…è¯´æ˜¯å…é…ç½®å³å¼€å³é£Ÿçš„`consul`ã€‚å®˜æ–¹çš„å®šä¹‰å¦‚ä¸‹ï¼š

> A reverse proxy / load balancer thatâ€™s easy, dynamic, automatic, fast, full-featured, open source, production proven, provides metrics, and integrates with every major cluster technologiesâ€¦ No wonder itâ€™s so popular!

ç®€å•æ¥è¯´å°±æ˜¯ï¼Œä¸è®ºä½ ç”¨å®ƒæ¥åšè´Ÿè½½å‡è¡¡è¿˜æ˜¯åå‘ä»£ç†ï¼Œéƒ½æ˜¯ç¬¦åˆå®ƒçš„è®¾è®¡ç†å¿µçš„ï¼Œä¹Ÿæä¾›äº†å¤§é‡çš„åŠŸèƒ½æ”¯æ’‘ï¼Œè®©ä½ èƒ½å¤Ÿåœ¨ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œç®€å•çš„é…ç½®å°±èƒ½å®ç°ä¸€å®šè§„æ¨¡çš„é«˜æ€§èƒ½åº”ç”¨ã€‚

å®é™…ä½¿ç”¨çš„è¯ï¼Œä¸è®ºæ˜¯é…åˆ `K8S`ã€`compose`ã€`Etcd`ã€`rancher`ã€`tradition docker`éƒ½æ˜¯å¯ä»¥çš„ã€‚

æˆ‘ä¸ªäººä½¿ç”¨åœ¨ `compose` çš„åœºæ™¯ä¸‹ï¼Œä»¥ä¸‹é…ç½®çš†ä»¥æ­¤ä¸ºä¾‹ï¼Œå…¶ä»–ç¯å¢ƒé…ç½®å¤§ä½“ä¸€è‡´ï¼Œç»†èŠ‚ç¨æœ‰ä¸åŒï¼Œç­‰å›å¤´ä¹°å‡ å°å¾®å¡”æœåŠ¡å™¨ï¼Œå†æŠ˜è…¾ä¸ªäººçš„ `K8S` å§ï¼ˆæ¯•ç«Ÿå•èŠ‚ç‚¹æ²¡ä»€ä¹ˆæ„æ€ï¼‰ã€‚

### é€‚åˆçš„åœºæ™¯

- å¦‚æœä½ çš„æœºå™¨æˆ–è€… IP èµ„æºæœ‰é™ï¼Œä½†æ˜¯ä½ å´éœ€è¦éƒ¨ç½²å¤šä¸ªç«™ç‚¹ï¼ŒåˆæœŸæœ›èƒ½å¤Ÿè®©ç«™ç‚¹åº”ç”¨ä¿æŒé«˜åº¦éš”ç¦»ã€‚
- ä½ å·²ç»åŒçƒ¦ä¼ ç»Ÿæ–¹æ¡ˆä¸­ä½¿ç”¨ `haproxy` æˆ–è€… `nginx` å¯¹äºå¤šä¸ªåº”ç”¨çš„å‰åç«¯æ‰©å®¹ä¿®æ”¹è¦æ¥å›ä¿®æ”¹çš„éº»çƒ¦äº‹å„¿ã€‚
- ä½ ä¸æƒ³åœ¨æœåŠ¡ç«¯æŒ‚è½½ `SSL`ï¼Œé…ç½®åŠ å¯†ç®—æ³•ï¼Œæ·»åŠ  `gzip` ç­‰æœ¬è¯¥ `Gateway` æä¾›çš„èƒ½åŠ›ï¼Œå¸Œæœ›è®©æ¯ä¸€å±‚çš„åŠŸèƒ½ä¿æŒç®€å•çº¯ç²¹ã€‚
- 1åˆ†é’Ÿå†…æ‹¥æœ‰æœ‰ä¸€ä¸ªè½»é‡é«˜æ•ˆçš„æœ¬åœ°å¼€å‘ç¯å¢ƒã€‚
- æ— é¡»é‡å¯å³å¯æ›´æ–°é…ç½®
- è‡ªåŠ¨çš„æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡
- ä¸ `docker` çš„å®Œç¾é›†æˆï¼ŒåŸºäº `container label` çš„é…ç½®

[(HTTPS æ·±å…¥æµ…å‡º - ä»€ä¹ˆæ˜¯ SNIï¼Ÿ](https://blog.csdn.net/firefile/article/details/80532161)

### é…ç½®

![image-20211112102052045](https://gitee.com/ibepo/ogcip/raw/master/20211112102052.png)



`traefik` ä¸€èˆ¬éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥ç®¡ç†è·¯ç”±ï¼ŒæœåŠ¡ï¼Œè¯ä¹¦ç­‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ `docker` å¯åŠ¨ `traefik` æ—¶æ¥æŒ‚è½½é…ç½®æ–‡ä»¶

å®ƒçš„é…ç½®åˆ†ä¸º `static`éƒ¨åˆ†å’Œ `dynamic`ä¸¤éƒ¨åˆ†,

å…¶ä¸­`entrypoints` `provider` `connection`  `infromation`å¯é€šè¿‡`static `é…ç½®ä¹Ÿå¯ä»¥é€šè¿‡` docker-compose.yml`çš„ `label`è®¾ç½®

å¦å¤–`routers`ã€ `services`ã€ `middlewares` `certificates`é€šè¿‡`dynamic`åŠ¨æ€é…ç½®

å…³äºé™æ€é…ç½®ä¸€äº›ä½¿ç”¨çš„è§„åˆ™

- å‘ç°è·¯ç”±çš„è§„åˆ™

â€‹        ä»¥ä¸Šçš„é…ç½®,è¡¨ç¤ºå¦‚æœæ²¡æœ‰`Rule`,å°†é»˜è®¤é€šè¿‡`<Name>.ibepo.cn`çš„å½¢å¼å‘ç°è·¯ç”±

```toml
  [providers.docker]
  endpoint = "unix:///var/run/docker.sock"
  defaultRule = "Host(`{{ normalize .Name }}.ibepo.cn`)"
```

- æ—¥å¿—

  æ—¥å¿—æä¸ºé‡è¦ï¼Œå½“æŸä¸ªè·¯ç”±é…ç½®ä¸æˆåŠŸï¼Œæˆ–è€… https é…ç½®å¤±è´¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—æ–‡ä»¶æ‰¾åˆ°è››ä¸é©¬è¿¹

  ```toml
  # Writing Logs to a File, in JSON
  [log]
    filePath = "/path/to/log-file.log"
    format = "json"
  ```

- è¯·æ±‚æ—¥å¿—

```toml
[accessLog]
filePath = "./traefik-access.json"
format = "json"
```

è¯·æ±‚æ—¥å¿—æ–‡ä»¶é…ç½®ä¸º `json` æ ¼å¼ï¼Œç»“æ„åŒ–æ•°æ®æ–¹ä¾¿è°ƒè¯•

- entryPoint

```toml
[entryPoints]
  [entryPoints.web]
    address = ":80"

  [entryPoints.web-secure]
    address = ":443"
```

è€ƒè™‘åˆ°éšç§ä»¥åŠå®‰å…¨ï¼Œä¸å¯¹å¤–å…¬å¼€çš„æœåŠ¡å¯ä»¥é…ç½® `Basic Auth`ï¼Œ`Digest Auth` æˆ–è€… `WhiteList`ï¼Œæˆ–è€…ç›´æ¥æ­å»º VPNï¼Œåœ¨å†…ç½‘å†…è¿›è¡Œè®¿é—®ã€‚è‡³äº `Basic Auth` ç­‰ï¼Œå¯ä»¥å‚è€ƒ [traefik middlewares](https://docs.traefik.io/middlewares/overview/)

- prometheus metrics

```toml
[metrics.prometheus]
  buckets = [0.1,0.3,1.2,5.0]
  entryPoint = "metrics"
```

[Prometheus (opens new window)](https://prometheus.io/)ä½œä¸ºæ—¶åºæ•°æ®åº“ï¼Œå¯ä»¥ç”¨æ¥ç›‘æ§ traefik çš„æ—¥å¿—ï¼Œæ”¯æŒæ›´åŠ çµæ´»çš„æŸ¥è¯¢ï¼ŒæŠ¥è­¦ä»¥åŠå¯è§†åŒ–ã€‚traefik é»˜è®¤è®¾ç½® prometheus ä½œä¸ºæ—¥å¿—æ”¶é›†å·¥å…·ã€‚å¦å¤–å¯ä»¥ä½¿ç”¨ `grafana` åšä¸º `prometheus` çš„å¯è§†åŒ–å·¥å…·ã€‚

### Docker Providerï¼ŒRouter and Service

![image-20211112103815283](https://gitee.com/ibepo/ogcip/raw/master/20211112103815.png)

- `Providers` æœåŠ¡æä¾›è€…ï¼Œå¦‚ dockerï¼Œå¦‚ä¸€ä¸ª http service
- `Routers` åˆ†æè¯·æ±‚çš„ `Host`ï¼Œ`Header` æˆ–è€… `Path`
- `Services` é€‰æ‹©åˆé€‚çš„ `Provider` (è´Ÿè½½å‡è¡¡ç­‰)

æˆ‘ä»¬ä½¿ç”¨ `Docker` ä½œä¸º `Provider`ï¼Œè€Œ `Router` ä¸ `Service` å¯ä»¥é€šè¿‡ `container labels` æ¥è¿›è¡Œé…ç½®ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ `docker-compose.yaml` ä¸­çš„ `labels` æ¥é…ç½®

æˆ‘ä»¬å¯ä»¥é€šè¿‡ `traefik.http.routers.<container-name>.rule` æ¥é…ç½®è·¯ç”±è§„åˆ™ï¼Œç±»ä¼¼ä¸ `nginx` ä¸­çš„ `location`

```yml
labels:
  - "traefik.http.routers.blog.rule=Host(`traefik.io`) || (Host(`containo.us`) && Path(`/traefik`))"
```

### è´Ÿè½½å‡è¡¡

å¦‚æœè¦ä¸º `docker provider` è¿›è¡Œè´Ÿè½½å‡è¡¡æ€ä¹ˆåŠ?

åªéœ€è¦ä½¿ç”¨ `docker-compose up --scale` å¯¹å®¹å™¨æ¨ªå‘æ‰©å®¹å³å¯å®Œæˆ

```shell
$ docker-compose up --scale whoami=3
WARNING: The scale command is deprecated. Use the up command with the --scale flag instead.
Starting whoami_whoami_1 ... done
Creating whoami_whoami_2 ... done
Creating whoami_whoami_3 ... done
```

åœ¨ `traefik dashboard` ä¸­æŸ¥çœ‹è¯¥ `service`æ—¶ï¼Œå·²è´Ÿè½½åˆ°ä¸‰ä¸ªå®¹å™¨



### ç°è‰²å‘å¸ƒ



### Traefik Dashboard

`traefik` é»˜è®¤æœ‰ä¸€ä¸ª `dashboard`ï¼Œé€šè¿‡ `:8080` ç«¯å£æš´éœ²å‡ºå»ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨ä¸­ç›´æ¥é€šè¿‡ `<IP>:8080` è®¿é—®ï¼Œä½†æ˜¯

1. ä½¿ç”¨ `IP` åœ°å€è‚¯å®šä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é…ç½® `Host`
2. åœ¨å…¬ç½‘ç¯å¢ƒä¸‹è®¿é—®æœ‰å®‰å…¨æ€§é—®é¢˜ï¼Œæ­¤æ—¶å¯ä»¥é…ç½® `basicAuth`ï¼Œ`digestAuth`ï¼Œ`IpWhiteList` æˆ–è€… `openVPN` ç­‰ä¸­é—´ä»¶

å†æ¬¡æ›´æ”¹ `traefik` çš„ `docker-compose.yaml` æ–‡ä»¶å¦‚ä¸‹ï¼š

```
version: '3'

services:
  reverse-proxy:
    image: traefik:v2.2
    restart: always
    ports:
      - "80:80"
      - "8080:8080"
    volumes:
      - ./traefik.toml:/etc/traefik/traefik.toml
      - /var/run/docker.sock:/var/run/docker.sock
    container_name: traefik
    labels:
      - "traefik.http.routers.api.rule=Host(`traefik.ibepo.local`)"
      - "traefik.http.routers.api.service=api@internal"
```

æ­¤æ—¶å¯ä»¥é€šè¿‡ `traefik.ibepo.local` æ¥è®¿é—® `dashboard`

### https è¯ä¹¦

`https` å·²ç»æˆä¸ºä¸€ä¸ªç°ä»£ç½‘ç«™çš„æ ‡é…ï¼Œä»¥è‡³äºå½“ä¸€ä¸ªç½‘ç«™æ²¡æœ‰ `https` æ—¶ï¼ŒæŸäº›æµè§ˆå™¨éƒ½ä¼šæŠŠå®ƒæ ‡è¯†ä¸ºä¸å®‰å…¨ã€‚è€Œé™¤äº†å®‰å…¨æ–¹é¢ï¼Œ`https` å¯¹ç½‘ç«™çš„SEOä¹Ÿå½±å“å¾ˆå¤šï¼Œè€Œå¯¹äºæŸäº›æ–°å‹çš„æµè§ˆå™¨ APIï¼Œä¹Ÿåªæœ‰åœ¨ `https` ä¸‹æ‰èƒ½ä½¿ç”¨ã€‚ä¸ç®¡æ€ä¹ˆè¯´ï¼Œ`https` ä¹Ÿæˆä¸ºä¸€ä¸ªç½‘ç«™çš„åˆšéœ€ã€‚

è€Œå½“ä½ ä½¿ç”¨äº† `traefik` ä½œä¸ºåå‘ä»£ç†æ—¶ï¼Œä½ å¯ä»¥é…ç½® `ACME` è‡ªåŠ¨ä¸ºåŸŸåæä¾›è¯ä¹¦ï¼Œåªéœ€å‡ è¡Œå³å¯è§£å†³é—®é¢˜ã€‚å…è´¹çš„è¯ä¹¦ï¼Œå½“ç„¶æ˜¯é€šè¿‡ `Let's Encrypt` æ¥è§£å†³ã€‚

#### ACME é…ç½®

é€šè¿‡å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è‡ªåŠ¨ç­¾å‘è¯ä¹¦å¹¶ä¸”è‡ªåŠ¨ç»­æœŸï¼Œæˆ‘ä»¬åœ¨ `traefik.toml` ä¸­è¿›è¡Œç›¸å…³é…ç½®

```toml
[certificatesResolvers.le.acme]
  email = "xianger94@qq.com"
  storage = "acme.json"

  [certificatesResolvers.le.acme.tlsChallenge]
```

å…¶ä¸­ï¼Œ`storage` æŒ‡å­˜æ”¾è¯ä¹¦çš„ä½ç½®

#### æœåŠ¡é…ç½®

å¦‚æœä½ éœ€è¦ä¸ºä½ çš„æœåŠ¡æä¾› https æµé‡ï¼Œåªéœ€è¦æ·»åŠ ä¸¤è¡Œä»£ç 

```yaml
labels:
  - traefik.http.routers.whoami.tls=true
  - traefik.http.routers.whoami.tls.certresolver=le
```

æˆ‘ä»¬ä¾ç„¶ä½¿ç”¨ `whoami` åšæµ‹è¯•ï¼Œ`docker-compose.yaml` æ–‡ä»¶å†…å®¹å¦‚ä¸‹

```yaml
version: '3'

services:
  whoami:
    image: containous/whoami
    labels:
      - traefik.http.routers.whoami.rule=Host(`whoami.shanyue.tech`)
      - traefik.http.routers.whoami.tls=true
      - traefik.http.routers.whoami.tls.certresolver=le
    # environments:
    #   TMUX
    
networks:
  default:
    external:
      name: traefik_default
```

æœåŠ¡å¯åŠ¨åï¼Œä½¿ç”¨ `curl` æµ‹è¯•æœåŠ¡æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° `X-Forwarded-Proto` ä¸º `https`ï¼Œé…ç½®æˆåŠŸ

```bash
$ curl https://whoami.shanyue.tech
Hostname: c9c3cc850e2b
IP: 127.0.0.1
IP: 172.18.0.2
RemoteAddr: 172.18.0.3:35320
GET / HTTP/1.1
Host: whoami.shanyue.tech
User-Agent: curl/7.29.0
Accept: */*
Accept-Encoding: gzip
X-Forwarded-For: 59.110.159.217
X-Forwarded-Host: whoami.shanyue.tech
X-Forwarded-Port: 443
X-Forwarded-Proto: https
X-Forwarded-Server: 9d783174aca9
X-Real-Ip: 59.110.159.217
```

### `Path`å’Œ`PathPrefix`

```
Path: /sub/             åŒ¹é…è¯·æ±‚çš„å­ç›®å½•
PathStrip: /sub/        åŒ¹é…è¯·æ±‚çš„å­ç›®å½•ï¼Œå¹¶æŠŠå­ç›®å½•å»æ‰åçš„è¯·æ±‚è½¬å‘åˆ°åç«¯
PathPrefix: /sub/       åŒ¹é…è¯·æ±‚çš„å­ç›®å½•åŠåŒ…å«è¯¥å­ç›®å½•çš„è¯·æ±‚
PathPrefixStrip: /sub/  åŒ¹é…è¯·æ±‚çš„å­ç›®å½•åŠåŒ…å«è¯¥å­ç›®å½•çš„è¯·æ±‚,å¹¶æŠŠå­ç›®å½•å»æ‰åçš„è¯·æ±‚è½¬å‘åˆ°åç«¯
```

```Toml
# ä½¿ç”¨è‡ªå®šä¹‰æ¨¡æ¿ï¼ˆå¯é€‰ï¼‰
# filename = "docker.tmpl"

# å¯¹å®¹å™¨é»˜è®¤è¿›è¡Œæš´éœ²ï¼ˆé»˜è®¤å¼€å¯ï¼‰
#   å¦‚æœå…³é—­é€‰é¡¹ï¼Œåˆ™å®¹å™¨ä¸åŒ…å« `traefik.enable=true` æ ‡ç­¾ï¼Œå°±ä¸ä¼šè¢«æš´éœ²
exposedbydefault = false

# ä½¿ç”¨ç»‘å®šç«¯å£çš„IPåœ°å€å–ä»£å†…éƒ¨ç§æœ‰ç½‘ç»œï¼ˆé»˜è®¤å…³é—­ï¼‰
usebindportip = false

# ä½¿ç”¨ Swarm Mode ï¼ˆé»˜è®¤å…³é—­ï¼‰
swarmmode = false
```



## Docker



###  docker çš„å®‰è£…

1. **å®‰è£…åº•å±‚å·¥å…·**

`sudo yum install â€y yumâ€utils deviceâ€mapperâ€persistentâ€data lvm2`

è¿™æ˜¯æˆ‘ä»¬å®‰è£…Dockerçš„åº•å±‚å·¥å…·ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨çš„ç»™æˆ‘ä»¬æç¤ºä¸‹è½½ï¼Œå¾ˆå¿«ä¸‹è½½å°±å®Œæˆäº†ã€‚

2.**åŠ å…¥é˜¿é‡Œäº‘yumä»“åº“æé€Ÿdockerä¸‹è½½è¿‡ç¨‹**

`sudo yumâ€configâ€manager â€â€addâ€repo http://mirrors.aliyun.com/dockerâ€ce/linu `

å¢åŠ é˜¿é‡Œäº‘çš„Dockerä¸‹è½½ä»“åº“ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒDockerå®˜æ–¹æ˜¯ä»ä»–çš„å›½å¤–çš„æœåŠ¡å™¨ä¸‹è½½é€Ÿåº¦æ˜¯éå¸¸æ…¢çš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬æ˜¯ä½¿ç”¨yum config managerç»„ä»¶æ¥æŒ‡å®šä¸€ä¸ªæ–°çš„ä¸‹è½½æºï¼ŒæŒ‡å‘çš„æ˜¯é˜¿é‡Œçš„åº”ç”¨æœåŠ¡å™¨ï¼Œé€šè¿‡é˜¿é‡Œæ¥æé«˜æˆ‘ä»¬Dockerçš„ä¸‹è½½é€Ÿåº¦ã€‚

3. **æ›´æ–°ä¸€ä¸‹ä»“åº“çš„æºä¿¡æ¯**

`sudo yum makecache fast`

**4.** **è‡ªåŠ¨å®‰è£…ä¸‹è½½Docker**

`sudo yum â€y install dockerâ€ce`

åœ¨è¿™é‡Œå®ƒå°±ä¼šè‡ªåŠ¨çš„ä¸‹è½½è§£æï¼Œå¯ä»¥çœ‹åˆ°åˆ©ç”¨é˜¿é‡Œäº‘ä¸‹è½½é€Ÿåº¦æ˜¯éå¸¸å¿«çš„,æˆ‘ä»¬çš„Dockerä¾¿è‡ªåŠ¨å®‰è£…æˆåŠŸã€‚

5. **å¯åŠ¨DockeræœåŠ¡**

`sudo service docker start`

æœ€åå’±ä»¬æ¥éªŒè¯ä¸€ä¸‹

**6.** **éªŒè¯dockeræ˜¯å¦å¯åŠ¨æˆåŠŸ**

`docker version`

è‡³æ­¤docker-ceç‰ˆæœ¬å®‰è£…æˆåŠŸ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å’Œwindowsç¯å¢ƒå®Œå…¨ç›¸åŒçš„å‘½ä»¤ï¼Œdockerå®ƒçš„å®‰è£…è¿‡ç¨‹ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿå¯èƒ½æœ‰ä¸åŒï¼Œä½†æ˜¯å‘½ä»¤æ¯ä¸ªå¹³å°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œdocker versionæ˜¾ç¤ºæˆ‘ä»¬å½“å‰å·²å®‰è£…çš„ç‰ˆæœ¬ï¼Œè¿™é‡Œæ˜¯1809.7ï¼Œè¿™ä¸ªç‰ˆæœ¬å…¶å®å°±æ˜¯å¯¹åº”äºæˆ‘ä»¬windowsçš„2.0.3ã€‚

7.**AliyunåŠ é€Ÿé•œåƒä¸‹è½½**

[é•œåƒåŠ é€Ÿå™¨ - Docker â€”â€” ä»å…¥é—¨åˆ°å®è·µ (gitbook.io)](https://yeasy.gitbook.io/docker_practice/install/mirror)

[Dockerå®˜æ–¹ä¸­å›½åŒºåŠ é€Ÿé•œåƒ | sleeleçš„åšå®¢](https://sleele.com/2018/12/29/dockerå®˜æ–¹ä¸­å›½åŒºåŠ é€Ÿé•œåƒ/)

Centoså‘½ä»¤è¡Œè¾“å…¥ä¸‹é¢çš„æŒ‡ä»¤åŠ å…¥Aliyunå®¹å™¨é•œåƒï¼ŒåŠ é€Ÿé•œåƒçš„ä¸‹è½½https://cr.console.aliyun.com/cn-shanghai/instances/mirrors

![image-20210910115155976](https://gitee.com/ibepo/ogcip/raw/master/20210930122520.png)

```  shell 
sudo mkdir â€p /etc/docker
sudo tee /etc/docker/daemon.json
{
"registryâ€mirrors": ["https://fskvstob.mirror.aliyuncs.com"]
} EOF
sudo systemctl daemonâ€reload
sudo systemctl restart docker 
```

```shell
#å¯åŠ¨å…³é—­docker
systemctl start docker #é€šè¿‡ systemctl å¯åŠ¨docker
systemctl stop docker # é€šè¿‡ systemctl å…³é—­docker
systemctl restart docker#é€šè¿‡systemctl é‡å¯docker
systemctl enable docker #é€šè¿‡systemctl è®¾ç½®dockerå¼€æœºè‡ªå¯åŠ¨

#å¦ä¸€ä¸ªåŠ é€Ÿé•œåƒ
# viè¿›å…¥dockerçš„é•œåƒç¼–è¾‘ç•Œé¢ è¾“å…¥ustcæºåœ°å€
vi /etc/docker/daemon.json
{
"registry-mirrors":["https://docker.mirrors.ustc.edu.cn"]
}
#ï¼šwqé€€å‡º
```

###  docker å¸¸ç”¨å‘½ä»¤

```shell
docker images #æŸ¥çœ‹å½“å‰docker ä¸‹è½½çš„é•œåƒ
docker ps #æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
docker ps -a #åˆ—å‡ºæ‰€æœ‰å®¹å™¨ åŒ…æ‹¬å·²åœæ­¢çš„
docker inspect ã€å®¹å™¨idã€‘ #æŸ¥çœ‹æ­¤å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯

#ä¸€ä¸ªå®Œæ•´çš„è¿è¡Œå‘½ä»¤
docker run \
--name=chatBot \
--volume="/panghu/work/wechatbot/index.js":/bot/index.js \
aibotk/wechat-bot #å¯åŠ¨ å‘½å æŒ‡å®šç›®å½•æŒ‚è½½æ•°æ®åˆ¸


#æ•°æ®å·
docker volume ls     #æŸ¥çœ‹æŒ‚è½½åˆ° /var/lib/docker/volumes/ä¸‹çš„æ•°æ®åˆ¸
ls /var/lib/docker/volumes/     #æŸ¥çœ‹æ­¤æ–‡ä»¶å¤¹çš„å†…å®¹

#è¿›å…¥å®¹å™¨
docker exec -it [å®¹å™¨ id] /bin/bash #é€šè¿‡å‘½ä»¤è¡Œ è¿›å…¥å®¹å™¨å†…éƒ¨

#ç½‘è·¯æ®µ
docker network inspect my-bridge #æŸ¥çœ‹åŠ å…¥åˆ°ç½‘è·¯ç»„çš„å®¹å™¨
docker network create â€d bridge myâ€bridge #åˆ›å»ºè™šæ‹Ÿç½‘æ®µ

#åˆ é™¤
docker rm - f containid     #å¼ºåˆ¶åˆ é™¤å®¹å™¨
docker rmi -f iamgesid      #å¼ºåˆ¶åˆ é™¤é•œåƒ
docker network rm my-bridge #å¼ºåˆ¶åˆ é™¤ç½‘ç»œç»„

#docker æ—¥å¿—
docker logs -ft --tail=10 --since="2016-07-01" chatBot 
-f : è·Ÿè¸ªæ—¥å¿—è¾“å‡º
--since :æ˜¾ç¤ºæŸä¸ªå¼€å§‹æ—¶é—´çš„æ‰€æœ‰æ—¥å¿—
-t : æ˜¾ç¤ºæ—¶é—´æˆ³
--tail :ä»…åˆ—å‡ºæœ€æ–°Næ¡å®¹å™¨æ—¥å¿—


#æ˜¾ç¤ºæ‰€æœ‰å®¹å™¨çš„å†…ç½‘ ip
docker inspect --format='{{.Name}} - {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' $(docker ps -aq)    

#åå°å¯åŠ¨å®¹å™¨
docker run -d centos
#è¿™æ · docker å®¹å™¨ä½¿ç”¨åå°è¿è¡Œ,å°±å¿…é¡»è¦æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹,docker å‘ç°æ²¡æœ‰åº”ç”¨,å°±ä¼šè‡ªåŠ¨åœæ­¢
#nginx å®¹å™¨å¯åŠ¨å,å‘ç°è‡ªå·±æ²¡æœ‰æä¾›æœåŠ¡,å°±ç«‹åˆ»åœæ­¢äº†
docker run -d -it centos #è¿™æ ·å°±è¡Œäº†

docker ps #åˆ—å‡ºæ‰€æœ‰å®¹å™¨
docker port #æŸ¥çœ‹å®¹å™¨ç«¯å£æ˜ å°„
docker stats #æŸ¥çœ‹èµ„æºå ç”¨


#docker å†…éƒ¨shell å®‰è£…å·¥å…· æ‰¾ä¸ç€ä»“åº“çš„å¤„ç†åŠæ³•
$apt-get update
```

ç½‘ç»œç›¸å…³

```shell
#åˆ›å»ºç½‘æ¡¥
$ docker network create â€d bridge myâ€bridge
# æŸ¥çœ‹ç½‘æ®µ
$ docker network ls
```

#### æŸ¥çœ‹å®¹å™¨çŠ¶æ€

```shell
$ docker stats
```



### docker éƒ¨ç½²å®¹å™¨

<img src="https://gitee.com/ibepo/ogcip/raw/master/20210930122525.png" alt="image-20210910121026566" style="zoom:55%;" />




####  docker éƒ¨ç½² [Portainer]

```shell

#æ‹‰å»é•œåƒ
docker pull portainer/portainer

#docker è¿è¡Œ
docker run -p 9000:9000 -p 8000:8000 --name portainer \
--restart=always \
-v /var/run/docker.sock:/var/run/docker.sock \
-v /mydata/portainer/data:/data \
-d portainer/portainer

#è®¿é—® ip:9000
id:root1234  pwd:root1234
```


#### docker éƒ¨ç½² [ MySQL 5.7] 

  [docker ä¸­ mysql çš„éƒ¨ç½²å’Œå¯åŠ¨](https://juejin.cn/post/6844904095950569480#heading-1)

[docker ä¸­å¼€å¯ binglog](https://www.cnblogs.com/cpw6/p/11597553.html)

[dockeræ­å»ºmysql ä¸»ä»å¤åˆ¶](https://mp.weixin.qq.com/s/sV1Ox9k7Lu1mykwjQ1Y8Ww)

```shell
docker run \
â€p 3306:3306 \ 
â€â€network myâ€bridge \ #--network my-bridge ä»£è¡¨å°†dbå®¹å™¨åŠ å…¥åˆ°my-bridgeè™šæ‹Ÿç½‘æ®µ,è¿™æ ·æ‰å¯ä»¥å’Œå…¶ä»–å®¹å™¨é€šä¿¡ 
â€â€name db \
â€v /usr/local/bsbdj/sql:/dockerâ€entrypointâ€initdb.d \
â€v /usr/local/bsbdj/data:/var/lib/mysql \
-v /etc/mysql:/etc/mysql  #æœ¬åœ°é…ç½®è·¯å¾„,ä¹‹åå¯ä»¥æ”¾å…¥ my.cnf,å¼€å¯ binglog å’Œåšä¸€äº›é…ç½®
â€e MYSQL_ROOT_PASSWORD=root \ 
â€d mysql:5.7
```

- docker run ...mysql 5.7 ä»£è¡¨åˆ›å»ºå¹¶è‡ªåŠ¨è¿è¡Œmysql 5.7 å®¹å™¨ï¼Œå¦‚æœå®¿ä¸»æœºæ²¡æœ‰ mysql 5.7é•œåƒï¼Œåˆ™è‡ªåŠ¨ä¼šä»dockerhubè¿›è¡Œä¸‹è½½ã€‚ 
- --name dbæ˜¯å®¹å™¨çš„åå­— 
- -p 3306:3306 ä»£è¡¨å°†å®¹å™¨å†…éƒ¨MySQL5.7 æ˜ å°„åˆ°å®¿ä¸»æœºçš„3306ç«¯å£ï¼Œè¿™æ ·æ‰å¯ä»¥ä»å¤–ç•Œè¿›è¡Œè®¿é—® 
- --network my-bridge ä»£è¡¨å°†dbå®¹å™¨åŠ å…¥åˆ°my-bridgeè™šæ‹Ÿç½‘æ®µ,è¿™æ ·æ‰å¯ä»¥ å’Œå…¶ä»–å®¹å™¨é€šä¿¡ 
- -v /usr/local/bsbdj/sql ... ä»£è¡¨å°†å®¿ä¸»æœºçš„sqlç›®å½•æŒ‚è½½åˆ°å®¹å™¨å†…çš„docker- entrypoint-initdb.dï¼Œæ ¹æ®dockerhub çš„æè¿°ï¼Œæ”¾å…¥docker-entrypoint-initdb.d ç›®å½•ä¸‹çš„SQLæ–‡ä»¶ä¼šåœ¨MySQLå®¹å™¨åˆ›å»ºåè‡ªåŠ¨æ‰§è¡Œï¼Œå®Œæˆæ•°æ®åˆå§‹åŒ–ä»»åŠ¡ã€‚ 
- -v /usr/local/bsbdj/data ...åŒæ ·æ˜¯æŒ‚è½½ï¼Œå› ä¸ºå®¹å™¨å¾ˆå®¹æ˜“åˆ›å»ºæˆ–è¿ç§»ï¼Œå¦‚æœå°† MySQLæ•°æ®æ–‡ä»¶ä¿å­˜åœ¨å®¹å™¨å†…éƒ¨ï¼Œå®¹å™¨é”€æ¯æ•°æ®å°±ä¼šä¸¢å¤±ï¼Œå› æ­¤åŒæ ·ä½¿ç”¨-vå‘½ä»¤å°† å®¹å™¨å†…äº§ç”Ÿçš„æ•°æ®æ–‡ä»¶æŒ‚è½½åˆ°å®¿ä¸»æœºçš„dataç›®å½•ä¸‹ï¼Œè¿™æ ·å³ä½¿å®¹å™¨é”€æ¯æ•°æ®ä¹Ÿä¸ä¼šä¸¢ å¤±ã€‚
- -e MYSQL_ROOT_PASSWORD=root ,mysqlå®¹å™¨è¦æ±‚çš„ç¯å¢ƒå‚æ•°ï¼Œè¯´æ˜åˆ›å»ºå®¹å™¨æ—¶é»˜è®¤æ•°æ®åº“rootå¯†ç ä¸ºroot. 
- -d ä»£è¡¨é‡‡ç”¨åå°æ¨¡å¼è¿è¡Œï¼Œä¸åŠ -dåˆ™é‡‡ç”¨å‰å°ç‹¬å æ–¹å¼è¿è¡Œ

```shell
#è¿™ä¸ªè„šæœ¬ä»¥é—®ç­”äº¤äº’çš„æ–¹å¼æ‰§è¡Œï¼ŒæŒ‰æç¤ºæ“ä½œå°±å¯ä»¥äº†ã€‚æ³¨æ„ä¿®æ”¹ root è´¦å·å¯†ç çš„é‚£ä¸€æ­¥ï¼Œè®¾ç½®ä¸€ä¸ªè‡ªå·±èƒ½è®°ä½çš„å¯†##ç ã€‚æœ¬åœ°å¼€å‘ç”¨çš„ï¼Œä¸ç”¨æå¤ªå¤æ‚ã€‚
mysql_secure_installation

```



#### docker éƒ¨ç½² [Minio]

[ğŸ”—dockerä¸­minioè§£å†³æµè§ˆå™¨æ— æ³•è®¿é—®çš„é—®é¢˜](https://blog.csdn.net/qq_38132995/article/details/118812013)

```
#docker æ‹‰å»æœ€æ–°é•œåƒ
docker pull minio/minio
# è¿›å…¥minio å‘½ä»¤è¡Œ
docker run -it --entrypoint=/bin/sh minio/mc
# æ­£ç¡®çš„å¯åŠ¨æ–¹å¼,ä¹‹å‰æµ‹è¯•çš„æµè§ˆå™¨ä¼šæ‰“ä¸å¼€,å› ä¸ºä½  console ç«¯å£ä¼šåŠ¨æ€å˜åŒ–,è¿™ç›´æ¥ç»™å®ƒå†™æ­» å°±æ²¡é—®é¢˜äº†
docker run -p 9090:9000 --name minio   -v /mydata/minio/data:/data   -v /mydata/minio/config:/root/.minio   -d minio/minio server /data --console-address ":9000" --address ":9090"
```

#### docker éƒ¨ç½² [Elasticsearch]

```
docker pull docker.io/elasticsearch:7.4.2

docker images

#-dï¼šåå°å¯åŠ¨
#--nameï¼šå®¹å™¨åç§°
#-pï¼šç«¯å£æ˜ å°„
#-eï¼šè®¾ç½®ç¯å¢ƒå˜é‡
#discovery.type=single-nodeï¼šå•æœºè¿è¡Œ
#b0e9f9f047e6ï¼šé•œåƒid
#å¦‚æœå¯åŠ¨ä¸äº†ï¼Œå¯ä»¥åŠ å¤§å†…å­˜è®¾ç½®ï¼š-e ES_JAVA_OPTS="-Xms512m -Xmx512m"
docker run
-d
--name es
-p 9200:9200
-p 9300:9300
-e "http.cors.allow-  origin=http://39.102.138.62:8085" -e ES_JAVA_OPTS="-Xms412m -Xmx412m" -e "discovery.type=single-node"
b1179d41a7b4
 
docker exec -it es /bin/bash
```

#### dockeréƒ¨ç½² [elasticvue]

```
 docker run --name esvue  -p 7010:8080 -d cars10/elasticvue 
 docker exec -it esvue /bin/bash
```

#### docker éƒ¨ç½² [ build é•œåƒ]

```shell
#dockfile
FROM openjdk:11
ADD ./app /usr/local/bsbdj
WORKDIR /usr/local/bsbdj 
CMD ["java","â€jar", "bsbdj.jar"]
```



```shell
docker run \ 
â€â€name app1 \
â€â€network myâ€bridge \ 
â€p 8080:8080 \ 
â€d itlaoqi/bsbdj:1.0

docker run \
â€â€name app2 \
â€â€network myâ€bridge \ 
â€p 8081:8080 \ 
â€d itlaoqi/bsbdj:1.0

docker run \
â€â€name app3 \
â€â€network myâ€bridge \
â€p 8082:8080 \ 
â€d itlaoqi/bsbdj:1.0
```

#### docker éƒ¨ç½² Ngnix

```shell
docker run \
â€â€name nginx \
â€v /usr/local/bsbdj/nginx/nginx.conf:/etc/nginx/nginx.conf \ #è¿™é‡Œçš„ ngnix é…ç½®éœ€è¦æ³¨æ„ä¸‹
â€â€network myâ€bridge \ 
â€p 80:80 \
â€d nginx
```

#### ä¸€é”®å‘å¸ƒè„šæœ¬sh

(ngnix+ä¸‰ä¸ªåç«¯æœåŠ¡ä¸€é”®å¼éƒ¨ç½²)

```shell
docker network create â€d bridge myâ€bridge

docker run \ 
â€p 3306:3306 \
â€â€network myâ€bridge \
â€â€name db \
â€v /usr/local/bsbdj/sql:/dockerâ€entrypointâ€initdb.d \
â€v /usr/local/bsbdj/data:/var/lib/mysql \ 
â€e MYSQL_ROOT_PASSWORD=root \ 
â€d mysql:5.7 

#è¿™é‡Œæ˜¯æ„å»ºé•œåƒ
cd /usr/local/bsbdj 
docker build â€t itlaoqi/bsbdj:1.0 .

docker run \ 
â€â€name app1 \ 
â€â€network myâ€bridge \
â€p 8080:8080 \ 
â€d itlaoqi/bsbdj:1.0 

docker run â€â€name app2 \
â€â€network myâ€bridge \ 
â€p 8081:8080 \
â€d itlaoqi/bsbdj:1.0 

docker run \ 
â€â€name app3 \ 
â€â€network myâ€bridge \ 
â€p 8082:8080 \ 
â€d itlaoqi/bsbdj:1.0 

docker run â€â€name nginx \
â€v /usr/local/bsbdj/nginx/nginx.conf:/etc/nginx/nginx.conf \
â€â€network myâ€bridge \
â€p 80:80 \
â€d nginx
```



### docker å…«è‚¡æ–‡

#### docker stack

```yaml
#ä¸¾ä¾‹è¯´æ˜ docker stack çš„ç”¨æ³•
#YAML
version: '3.1'
 
services:
 
  wordpress:
    image: wordpress
    restart: always
    ports:
      - 8080:80
    environment:
      WORDPRESS_DB_HOST: db
      WORDPRESS_DB_USER: exampleuser
      WORDPRESS_DB_PASSWORD: examplepass
      WORDPRESS_DB_NAME: exampledb
    volumes:
      - wordpress:/var/www/html
 
  db:
    image: mysql:5.7
    restart: always
    environment:
      MYSQL_DATABASE: exampledb
      MYSQL_USER: exampleuser
      MYSQL_PASSWORD: examplepass
      MYSQL_RANDOM_ROOT_PASSWORD: '1'
    volumes:
      - db:/var/lib/mysql
 
volumes:
  wordpress:
  db:
```

```bash
#docker_cli
docker stack deploy -c stack.yml wordpress #-c æŒ‡å®šymlæ–‡ä»¶ï¼Œdeployå¯ä»¥æ¢æˆup
```



#### docker.sock

[op-note/docker.md at master Â· shfshanyue/op-note (github.com)](https://github.com/shfshanyue/op-note/blob/master/docker.md)

[dockerï¼Œcontainerdï¼Œruncï¼Œdocker-shim - ç®€ä¹¦ (jianshu.com)](https://www.jianshu.com/p/52c0f12b0294)

[å…³äº/var/run/docker.sock - Fundebug - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/fundebug/p/6723464.html)

>è¿è¡Œè¿‡Docker Hubçš„Dockeré•œåƒçš„è¯ï¼Œä¼šå‘ç°å…¶ä¸­ä¸€äº›å®¹å™¨æ—¶éœ€è¦æŒ‚è½½**/var/run/docker.sock**æ–‡ä»¶ã€‚**è¿™ä¸ªæ–‡ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆæœ‰äº›å®¹å™¨éœ€è¦ä½¿ç”¨å®ƒï¼Ÿ**ç®€å•åœ°è¯´ï¼Œå®ƒæ˜¯**Dockerå®ˆæŠ¤è¿›ç¨‹(Docker daemon)**é»˜è®¤ç›‘å¬çš„**UnixåŸŸå¥—æ¥å­—(Unix domain socket)**ï¼Œå®¹å™¨ä¸­çš„è¿›ç¨‹å¯ä»¥é€šè¿‡å®ƒä¸Dockerå®ˆæŠ¤è¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚

![image-20211009094548684](https://gitee.com/ibepo/ogcip/raw/master/20211009094609.png)

#### Portainer

ä¸å¦¨çœ‹ä¸€ä¸‹ [Portainer](http://portainer.io/)ï¼Œå®ƒæä¾›äº†å›¾å½¢åŒ–ç•Œé¢ç”¨äºç®¡ç†`Dockerä¸»æœº`å’Œ`Swarmé›†ç¾¤`ã€‚å¦‚æœä½¿ç”¨`Portainer`ç®¡ç†æœ¬åœ°Dockerä¸»æœºçš„è¯ï¼Œéœ€è¦ç»‘å®š`/var/run/docker.sock`.

è®¿é—®9000ç«¯å£å¯ä»¥æŸ¥çœ‹å›¾å½¢åŒ–ç•Œé¢ï¼Œå¯ä»¥ç®¡ç†å®¹å™¨(container)ï¼Œé•œåƒ(image)ï¼Œæ•°æ®å·(volume)...

Portaineré€šè¿‡ç»‘å®šçš„`/var/run/docker.sock`æ–‡ä»¶ä¸`Dockerå®ˆæŠ¤è¿›ç¨‹(Docker daemon)`é€šä¿¡ï¼Œæ‰§è¡Œå„ç§ç®¡ç†æ“ä½œã€‚

#### Dockerå®ˆæŠ¤è¿›ç¨‹çš„API

å®‰è£…Dockerä¹‹åï¼ŒDockerå®ˆæŠ¤è¿›ç¨‹ä¼šç›‘å¬UnixåŸŸå¥—æ¥å­—ï¼š/var/run/docker.sockã€‚è¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡Docker daemonçš„é…ç½®é€‰é¡¹çœ‹å‡ºæ¥(åœ¨ubuntuä¸Šæ‰§è¡Œcat /etc/default/docker )ï¼š

```
-H unix:///var/run/docker.sock
```

æ³¨: ç›‘å¬ç½‘ç»œTCPå¥—æ¥å­—æˆ–è€…å…¶ä»–å¥—æ¥å­—éœ€è¦é…ç½®ç›¸åº”çš„**-H**é€‰é¡¹ã€‚

#### å¥—æ¥å­—æ–¹å¼,å®Œæˆå®¹å™¨å…¨å‘¨æœŸ

**1. åˆ›å»ºnginxå®¹å™¨**

curlå‘½ä»¤é€šè¿‡Unixå¥—æ¥å­—å‘é€**{â€œImageâ€:â€nginxâ€}**åˆ°Dockerå®ˆæŠ¤è¿›ç¨‹çš„**/containers/create**æ¥å£ï¼Œè¿™ä¸ªå°†ä¼šåŸºäºNginxé•œåƒåˆ›å»ºå®¹å™¨å¹¶è¿”å›å®¹å™¨çš„IDã€‚

```shell
curl -XPOST --unix-socket /var/run/docker.sock\
-d â€˜{â€œImageâ€:â€nginxâ€}â€™ \
-H â€˜Content-Type: application/jsonâ€™ \
http:``//localhost/containers/create
```

è¾“å‡ºè¿”å›äº†å®¹å™¨ID:

```shell
{â€œIdâ€:â€fcb65c6147efb862d5ea3a2ef20e793c52f0fafa3eb04e4292cb4784c5777d65",â€Warningsâ€:``null``}
```

**2. å¯åŠ¨nginxå®¹å™¨**

ä½¿ç”¨è¿”å›çš„å®¹å™¨IDï¼Œè°ƒç”¨**/containers/<ID>/start**æ¥å£ï¼Œå³å¯å¯åŠ¨æ–°åˆ›å»ºçš„å®¹å™¨ã€‚

```shell
curl -XPOST --unix-socket /var/run/docker.sock\
http://localhost/containers/fcb65c6147efb862d5ea3a2ef20e793c52f0fafa3eb04e4292cb4784c5777d65/start
```

æ³¨æ„: ç»‘å®šDockerå¥—æ¥å­—ä¹‹åï¼Œå®¹å™¨çš„æƒé™ä¼šå¾ˆé«˜ï¼Œå¯ä»¥æ§åˆ¶Dockerå®ˆæŠ¤è¿›ç¨‹ã€‚å› æ­¤ï¼Œè¿™ä¸€ç‚¹å¿…é¡»è°¨æ…ä½¿ç”¨ï¼Œåªèƒ½ç”¨äºè¶³å¤Ÿä¿¡ä»»çš„å®¹å™¨ã€‚

### docker-compose

#### å‘½ä»¤

docker-composeçš„å®Œæ•´å‘½ä»¤çš„ç”¨æ³•æ˜¯ï¼š`docker-compose [-f <arg>...] [options] [COMMAND] [ARGS...]` ä¸»è¦åˆ†ä¸º2æ®µï¼Œä¸€æ˜¯optionsï¼ŒäºŒæ˜¯COMMANDã€‚

å¸¸ç”¨optionsæœ‰ï¼š

- `-f, --file FILE` æŒ‡å®šä½¿ç”¨çš„ Compose æ¨¡æ¿æ–‡ä»¶ï¼Œé»˜è®¤ä¸º `docker-compose.yml`ï¼Œå¯ä»¥å¤šæ¬¡æŒ‡å®šã€‚
- `-p, --project-name NAME` æŒ‡å®šé¡¹ç›®åç§°ï¼Œé»˜è®¤å°†ä½¿ç”¨æ‰€åœ¨ç›®å½•åç§°ä½œä¸ºé¡¹ç›®åã€‚
- `--verbose` è¾“å‡ºæ›´å¤šè°ƒè¯•ä¿¡æ¯ã€‚
- `-v, --version` æ‰“å°ç‰ˆæœ¬å¹¶é€€å‡ºã€‚
- `--env-file PATH`è®¾ç½®ç¯å¢ƒå˜é‡

å¸¸ç”¨COMMANDæœ‰ï¼š

- buildï¼šæ„å»ºï¼ˆé‡æ–°æ„å»ºï¼‰é¡¹ç›®ä¸­çš„æœåŠ¡å®¹å™¨ã€‚

- configï¼šéªŒè¯ Compose æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œè‹¥æ­£ç¡®åˆ™æ˜¾ç¤ºé…ç½®ï¼Œè‹¥æ ¼å¼é”™è¯¯æ˜¾ç¤ºé”™è¯¯åŸå› ã€‚

- downï¼šæ­¤å‘½ä»¤å°†ä¼šåœæ­¢ `up` å‘½ä»¤æ‰€å¯åŠ¨çš„å®¹å™¨ï¼Œå¹¶ç§»é™¤ç½‘ç»œ

- `docker-compose exec serviceåç§° COMMAND`ï¼šè¿›å…¥æŒ‡å®šçš„å®¹å™¨ã€‚

- imagesï¼šåˆ—å‡º Compose æ–‡ä»¶ä¸­åŒ…å«çš„é•œåƒã€‚

- `docker-compose logs <serviceåç§°>`ï¼šæŸ¥çœ‹æœåŠ¡å®¹å™¨çš„è¾“å‡ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker-compose å°†å¯¹ä¸åŒçš„æœåŠ¡è¾“å‡ºä½¿ç”¨ä¸åŒçš„é¢œè‰²æ¥åŒºåˆ†ã€‚å¯ä»¥é€šè¿‡ `--no-color` æ¥å…³é—­é¢œè‰²ã€‚

- scaleï¼šé€šè¿‡`service=num` è®¾ç½®æŒ‡å®šæœåŠ¡è¿è¡Œçš„å®¹å™¨ä¸ªæ•°ã€‚å¦‚`docker-compose scale web=3 db=2`

- upï¼šå°†å°è¯•è‡ªåŠ¨å®ŒæˆåŒ…æ‹¬æ„å»ºé•œåƒï¼Œï¼ˆé‡æ–°ï¼‰åˆ›å»ºæœåŠ¡ï¼Œå¯åŠ¨æœåŠ¡ï¼Œå¹¶å…³è”æœåŠ¡ç›¸å…³å®¹å™¨çš„ä¸€ç³»åˆ—æ“ä½œã€‚å¤§éƒ¨åˆ†æ—¶å€™éƒ½å¯ä»¥ç›´æ¥é€šè¿‡è¯¥å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªé¡¹ç›®ã€‚é»˜è®¤æƒ…å†µï¼Œ

  ```
  docker-compose up
  ```

  å¯åŠ¨çš„å®¹å™¨éƒ½åœ¨å‰å°ï¼Œæ§åˆ¶å°å°†ä¼šåŒæ—¶æ‰“å°æ‰€æœ‰å®¹å™¨çš„è¾“å‡ºä¿¡æ¯ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚å½“é€šè¿‡

  ```
  Ctrl-C 
  ```

  åœæ­¢å‘½ä»¤æ—¶ï¼Œæ‰€æœ‰å®¹å™¨å°†ä¼šåœæ­¢ã€‚å¦‚æœä½¿ç”¨

  ```
  docker-compose up -d
  ```

  ï¼Œå°†ä¼šåœ¨åå°å¯åŠ¨å¹¶è¿è¡Œæ‰€æœ‰çš„å®¹å™¨ã€‚ä¸€èˆ¬æ¨èç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨è¯¥é€‰é¡¹ã€‚

  - `-d` åœ¨åå°è¿è¡ŒæœåŠ¡å®¹å™¨ã€‚
  - `--no-color` ä¸ä½¿ç”¨é¢œè‰²æ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡çš„æ§åˆ¶å°è¾“å‡ºã€‚
  - `--no-deps` ä¸å¯åŠ¨æœåŠ¡æ‰€é“¾æ¥çš„å®¹å™¨ã€‚
  - `--force-recreate` å¼ºåˆ¶é‡æ–°åˆ›å»ºå®¹å™¨ï¼Œä¸èƒ½ä¸ `--no-recreate` åŒæ—¶ä½¿ç”¨ã€‚
  - `--no-recreate` å¦‚æœå®¹å™¨å·²ç»å­˜åœ¨äº†ï¼Œåˆ™ä¸é‡æ–°åˆ›å»ºï¼Œä¸èƒ½ä¸ `--force-recreate` åŒæ—¶ä½¿ç”¨ã€‚
  - `--no-build` ä¸è‡ªåŠ¨æ„å»ºç¼ºå¤±çš„æœåŠ¡é•œåƒã€‚
  - `-t, --timeout TIMEOUT` åœæ­¢å®¹å™¨æ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰ã€‚



æˆ‘ä»¬ä½¿ç”¨ `Compose` è¿›è¡Œåº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è°ƒè¯•ï¼Œå»ºè®®æ‰§è¡Œï¼š

```bash
docker-compose up
```

å› ä¸ºå¯ä»¥åœ¨ç»ˆç«¯ä¸­ç›´æ¥çœ‹åˆ°åº”ç”¨çš„å®é™…è¿è¡Œæ—¥å¿—ï¼Œå¦‚æœå‡ºé”™ï¼Œå¯ä»¥æŒ‰ä¸‹ `CTRL+C` ç»„åˆé”®ï¼Œä¸­æ–­æ‰§è¡Œï¼Œè¿”å›è°ƒè¯•ã€‚

å½“ä½ çš„åº”ç”¨**å®Œå…¨å°±ç»ª**ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦é•¿æœŸç¨³å®šçš„è¿è¡Œè¿™ä¸ªæœåŠ¡çš„æ—¶å€™ï¼Œå†ä½¿ç”¨ `Compose` çš„æ—¶å€™ï¼Œåˆ™å¯ä»¥æ·»åŠ ä¸€ä¸ª `-d` å‚æ•°ï¼Œè®©åº”ç”¨ä»¥ daemon æ¨¡å¼æ‰§è¡Œã€‚

```bash
docker-compose up -d
```

è¿™æ—¶ï¼Œåº”ç”¨ä¼šä¹–ä¹–çš„é™é»˜åœ¨åå°æ‰§è¡Œï¼Œä¸ä¼šå‘ç»ˆç«¯è¾“å‡ºä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå¦‚æœåº”ç”¨å¼‚å¸¸ï¼Œæˆ‘ä»¬éœ€è¦è°ƒè¯•ï¼Œæƒ³çœ‹åˆ°åº”ç”¨æ—¥å¿—è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥äº†ã€‚

```bash
docker-compose logs -f
```

å¦‚æœå‘ç°åº”ç”¨æ‰§è¡Œå‡ºé”™ï¼Œä½¿ç”¨ `docker-compose down` ç»“æŸåº”ç”¨è¿è¡Œåï¼Œè°ƒæ•´ç¼–æ’é…ç½®æ–‡ä»¶ï¼Œé‡æ–°ä½¿ç”¨ä¸å¸¦å‚æ•°çš„çš„ `docker-compose up` å¯åŠ¨åº”ç”¨ï¼Œå¾…åº”ç”¨å®Œå…¨å°±ç»ªåï¼Œå†æ·»åŠ  `daemon` å‚æ•°å°±å¯ä»¥äº†ã€‚



#### é…ç½®æ–‡ä»¶

composeé»˜è®¤çš„æ¨¡æ¿æ–‡ä»¶åç§°ä¸º `docker-compose.yml`ï¼Œæ ¼å¼ä¸º YAML æ ¼å¼ã€‚æ³¨æ„æ¯ä¸ªæœåŠ¡éƒ½å¿…é¡»é€šè¿‡ `image` æŒ‡ä»¤æŒ‡å®šé•œåƒæˆ– `build` æŒ‡ä»¤ï¼ˆéœ€è¦ Dockerfileï¼‰ç­‰æ¥è‡ªåŠ¨æ„å»ºç”Ÿæˆé•œåƒã€‚å…¶å¸¸ç”¨çš„æŒ‡ä»¤æœ‰ï¼š

- servicesï¼šåé¢ä¸€è¡Œæ¥çš„æ˜¯æœåŠ¡åï¼Œå½“composeè¿è¡Œä¹‹å ï¼Œå…¶å®¹å™¨åä¸ºï¼š`é¡¹ç›®å_æœåŠ¡å_1`

- imageï¼šåæ¥é•œåƒåï¼Œimageä¸bulidåªèƒ½å‡ºç°ä¸€ä¸ª

- bulidï¼šåæ¥ `Dockerfile` æ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚Composeå°†ä¼šåˆ©ç”¨å®ƒè‡ªåŠ¨æ„å»ºè¿™ä¸ªé•œåƒï¼Œç„¶åä½¿ç”¨è¿™ä¸ªé•œåƒã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ `context` æŒ‡ä»¤æŒ‡å®š `Dockerfile` æ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œå†ä½¿ç”¨ `dockerfile` æŒ‡ä»¤æŒ‡å®š `Dockerfile` æ–‡ä»¶åã€‚

- commandï¼š**è¦†ç›–**å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤ã€‚

- depends_onï¼šå…ˆå¯åŠ¨å®¹å™¨æ‰€ä¾èµ–çš„æœåŠ¡åï¼Œå†æ¥å¯åŠ¨è‡ªå·±çš„ã€‚

- environmentï¼šè®¾ç½®ç¯å¢ƒå˜é‡ã€‚åªç»™å®šåç§°çš„å˜é‡ä¼šè‡ªåŠ¨è·å–è¿è¡Œ Compose ä¸»æœºä¸Šå¯¹åº”å˜é‡çš„å€¼ï¼Œå¯ä»¥ç”¨æ¥é˜²æ­¢æ³„éœ²ä¸å¿…è¦çš„æ•°æ®ã€‚

- env_fileï¼šä»æ–‡ä»¶ä¸­è·å–ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä¸ºå•ç‹¬çš„æ–‡ä»¶è·¯å¾„æˆ–åˆ—è¡¨ã€‚å¦‚æœå˜é‡å¾ˆå¤šï¼Œå¯ä»¥å°†å˜é‡å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œç„¶åä½¿ç”¨env_fileæ¥é…ç½®æ–‡ä»¶è·¯å¾„ã€‚å¦å¤–ï¼šCompose æ¨¡æ¿æ–‡ä»¶æ”¯æŒåŠ¨æ€è¯»å–ä¸»æœºçš„ç³»ç»Ÿç¯å¢ƒå˜é‡å’Œå½“å‰ç›®å½•ä¸‹çš„ `.env` æ–‡ä»¶ä¸­çš„å˜é‡ã€‚è‹¥å½“å‰ç›®å½•å­˜åœ¨ `.env` æ–‡ä»¶ï¼Œæ‰§è¡Œ `docker-compose` å‘½ä»¤æ—¶å°†ä»è¯¥æ–‡ä»¶ä¸­è¯»å–å˜é‡ã€‚

- portsï¼šæš´éœ²ç«¯å£ä¿¡æ¯ã€‚ä½¿ç”¨å®¿ä¸»ç«¯å£ï¼šå®¹å™¨ç«¯å£ `(HOST:CONTAINER)` æ ¼å¼ï¼Œæˆ–è€…ä»…ä»…æŒ‡å®šå®¹å™¨çš„ç«¯å£ï¼ˆå®¿ä¸»å°†ä¼šéšæœºé€‰æ‹©ç«¯å£ï¼‰éƒ½å¯ä»¥ã€‚

- expose: åªæŠŠæ­¤ç«¯å£æš´éœ²ç»™ link åˆ°å®¹å™¨çš„å®¹å™¨, æš´éœ²ç«¯å£ï¼Œä½†ä¸æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œåªè¢«è¿æ¥çš„æœåŠ¡è®¿é—®ã€‚ä»…å¯ä»¥æŒ‡å®šå†…éƒ¨ç«¯å£ä¸ºå‚æ•°

- >  å­å®¹å™¨ä¾æ—§å…¨éƒ¨ä½¿ç”¨ `expose` ä½¿ç”¨ç§æœ‰åŒ–çš„æ–¹æ³•å¯¼å‡ºç«¯å£ç»™ç½‘å…³---è‹æ´‹

- extra_hosts: - "git.lab.com:127.0.0.1" ,æ”¹dockerå®¹å™¨ä¸­çš„hostsæ–‡ä»¶(docker å‘½ä»¤è¡Œä¸­æ˜¯é€šè¿‡å‚æ•°`--add-host`æ¥æ·»åŠ åŸŸåå’ŒIPä¿¡æ¯åˆ°å®¹å™¨çš„`/etc/hosts`æ–‡ä»¶ä¸­t)

- volumesï¼šæ•°æ®å·æ‰€æŒ‚è½½è·¯å¾„è®¾ç½®ã€‚å¯ä»¥è®¾ç½®ä¸ºå®¿ä¸»æœºè·¯å¾„(`HOST:CONTAINER`)æˆ–è€…æ•°æ®å·åç§°(`VOLUME:CONTAINER`)ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®è®¿é—®æ¨¡å¼ ï¼ˆ`HOST:CONTAINER:ro`ï¼‰ã€‚å¦‚æœè·¯å¾„ä¸ºæ•°æ®å·åç§°ï¼Œå¿…é¡»åœ¨æ–‡ä»¶ä¸­é…ç½®æ•°æ®å·ã€‚

- network external trueï¼Œå¦‚æœåœ¨`docker-compose`æ–‡ä»¶ä¸­è®¾ç½®`external`ä¸º`true`ï¼Œé‚£ä¹ˆä½¿ç”¨`docker-compose up -d`æ¥å¯åŠ¨æœåŠ¡æ—¶ï¼Œé¦–å…ˆ`docker`å¼•æ“ä¼šæŸ¥æ‰¾`external`å£°æ˜çš„ç½‘ç»œï¼Œæ‰¾åˆ°åè¿›è¡Œè¿æ¥ã€‚å¦åˆ™ä¼šæç¤ºé”™è¯¯

- `labels`ä¸ºå®¹å™¨æ·»åŠ  Docker å…ƒæ•°æ®ï¼ˆmetadataï¼‰ä¿¡æ¯ã€‚ä¾‹å¦‚å¯ä»¥ä¸ºå®¹å™¨æ·»åŠ è¾…åŠ©è¯´æ˜ä¿¡æ¯ã€‚

- ###### networks é…ç½®å®¹å™¨è¿æ¥çš„ç½‘ç»œã€‚

####  æœ€ä½³å®è·µ 

```yaml
version: '3.8'

services:
  portainer:
    image: portainer/portainer
    container_name: "portainer"
    restart: always
    networks:
       - traefik
    ports:
      - "8000:8000"
      - "9000:9000"
    volumes:
      - "/var/run/docker.sock:/var/run/docker.sock"
      - "${PWD}/portainer/data:/data"

  trafik:
    image: traefik:v2.5
    container_name: "trafik"
    restart: always
    networks:
       - traefik
    ports:
      - "80:80"
      - "8080:8080"
      - "443:443"
    volumes:
      # ä»…é™æ ‡å‡†çš„ Linux ç¯å¢ƒ
      - "/etc/localtime:/etc/localtime:ro"
      - "/etc/timezone:/etc/timezone:ro"
      - "/var/run/docker.sock:/var/run/docker.sock"
      # - ./trafik/traefik.toml:/etc/traefik.toml:ro
      - "./trafik/config/:/etc/traefik/config/:ro"
      - "./trafik/ssl:/data/ssl"
      - "./trafik/logs:/data/logs"
    command:
      - "--global.sendanonymoususage=false"
      - "--global.checknewversion=false"
      - "--entrypoints.http.address=:80"
      - "--entrypoints.https.address=:443"
      - "--api=true"
      - "--api.insecure=true"
      - "--api.dashboard=true"
      - "--api.debug=false"
      - "--ping=false"
      - "--log.level=warn"
      - "--log.format=common"
      - "--accesslog=false"
      - "--providers.docker=true"
      - "--providers.docker.watch=true"
      - "--providers.docker.exposedbydefault=false"
      - "--providers.docker.endpoint=unix:///var/run/docker.sock"
      - "--providers.docker.swarmMode=false"
      - "--providers.docker.useBindPortIP=false"
      - "--providers.docker.network=traefik"
      - "--providers.file=true"
      - "--providers.file.watch=true"
      - "--providers.file.directory=/etc/traefik/config"
      - "--providers.file.debugloggeneratedtemplate=true" 
    # labels:
    #   å¯¹å¤–æš´éœ²å®¹å™¨æœåŠ¡
    #   - "traefik.enable=true"
    #   - "traefik.docker.network=traefik"
      # é»˜è®¤è¯·æ±‚è½¬å‘ https ç«¯å£
      # - "traefik.http.routers.traefik-dash-default.middlewares=https-redirect@file"
      # - "traefik.http.routers.traefik-dash-default.entrypoints=http"
      # - "traefik.http.routers.traefik-dash-default.rule=Host(`dashboard.guava.lab.com`)"
      # - "traefik.http.routers.traefik-dash-default.service=dashboard@internal"
      # # å¤„ç†ç½‘é¡µ
      # - "traefik.http.routers.traefik-dash-web.entrypoints=http"
      # - "traefik.http.routers.traefik-dash-web.rule=PathPrefix(`/2`)"
      # - "traefik.http.routers.traefik-dash-web.tls=true"
      # - "traefik.http.routers.traefik-dash-web.service=dashboard@internal"
      # # å¤„ç†æ¥å£
      # - "traefik.http.routers.traefik-dash-api.entrypoints=http"
      # - "traefik.http.routers.traefik-dash-api.rule=Host(`dashboard.guava.lab.com`) && (PathPrefix(`/api`) || PathPrefix(`/dashboard`))"
      # - "traefik.http.routers.traefik-dash-api.tls=true"
      # - "traefik.http.routers.traefik-dash-api.service=api@internal"
    # healthcheck:
    #   test: ["CMD-SHELL", "wget -q --spider --proxy off localhost:8080/ping || exit 1"]
    #   interval: 3s
    #   retries: 12
    logging:
      driver: "json-file"
      options:
        max-size: "1m"  

  whoami:
    # A container that exposes an API to show its IP address
    image: containous/whoami
    networks:
       - traefik
    labels:
      # å£°æ˜å…¬å¼€æ­¤å®¹å™¨è®¿é—®
      - "traefik.enable=true"
      # æœåŠ¡å°†å“åº”çš„åŸŸ
      - "traefik.http.routers.whoami.rule=PathPrefix(`/w`)"
      # åªå…è®¸æ¥è‡ªé¢„å®šä¹‰çš„å…¥å£ç‚¹â€œhttpâ€çš„è¯·æ±‚
      - "traefik.http.routers.whoami.entrypoints=http"
      - "traefik.docker.network=traefik"

  nginx:
    container_name: nginx
    image: nginx:1.21.1-alpine
    restart: always
    # ports:
    #    - "9999:80"
    # expose:
    #    - "80"  #è¿™é‡Œå¦‚æœä¸å†™æˆxx:xx çš„å½¢å¼,ä¼šéšæœºç»™å®¿ä¸»æœºåˆ†é…ç«¯å£å·
    volumes:
       - "/usr/share/zoneinfo/Asia/Shanghai:/etc/localtime:ro"
       - ./nginx/html:/usr/share/nginx/html:ro
       # - "./nginx/conf/nginx.conf:/etc/nginx/nginx.conf"
       # - "./nginx/conf.d:/etc/nginx/conf.d"
       - "./nginx/logs:/var/log/nginx"
    networks:
       - traefik
    labels:
       - "traefik.enable=true"
       - "traefik.http.routers.nginx.entrypoints=http"
       - "traefik.docker.network=traefik"
       - "traefik.http.routers.nginx.rule=PathPrefix(`/h5`)"
    logging:
      driver: "json-file"
      options:
        max-size: "1m"
  # mysql:
     # image: mysql:5.7
     #command:
     # - --default_authentication_plugin=mysql_native_password
     # - --character-set-server=utf8mb4
     # - --collation-server=utf8mb4_unicode_ci
     # volumes:
       # - db_data:/var/lib/mysql
     # restart: always
     # environment:
       # MYSQL_ROOT_PASSWORD: 123456
       # MYSQL_DATABASE: wordpress
       # MYSQL_USER: root
       # MYSQL_PASSWORD: root1234
   
networks:
  traefik:
    external: true

```



#### å…«è‚¡æ–‡

[dockerå…¥é—¨æ•™ç¨‹å…­:å®¹å™¨ç¼–æ’compose | æ— åè€å’BLOG (wumingx.com)](https://www.wumingx.com/k8s/docker-compose.html)



### lazydocker

```shell
docker run -it --name lazydocker -v /var/run/docker.sock:/var/run/docker.sock -v /usr/local/work/LazyDocker/.config/lazydocker:/.config/jesseduffield/lazydocker lazyteam/lazydocker
```



## MySQL

![image-20211117090608776](https://gitee.com/ibepo/ogcip/raw/master/20211117090609.png)



`TokuDB`åœ¨äº‹åŠ¡æœºåˆ¶ä¸‹,é€‚åˆ`å†™å¤šè¯»å°‘`çš„æ•°æ®å¤‡ä»½

`MyISAM`çš„ sql è¯­å¥æ˜¯ä¸²è¡Œæ‰§è¡Œ

`innoDB`å…è®¸å¹¶å‘è¯»å†™



### CRUDæ“ä½œ

![image-20211117142654164](https://gitee.com/ibepo/ogcip/raw/master/20211117142654.png)

#### æ’å…¥

##### æ‰¹é‡æ’å…¥å¿½ç•¥é”™è¯¯

å½“æ‰¹é‡æ’å…¥æ•°æ®æ—¶,å› ä¸ºä¸€æ¡è®°å½•çš„é—®é¢˜,é€ æˆå…¨éƒ¨æ•°æ®æ’å…¥å¤±è´¥

```mysql
INSERT INTO t_dept (deptno, dname, loc )
VALUES
	(40,"ä¼åˆ’éƒ¨","åŒ—äº¬"),
	(50,"åŸ¹è®­éƒ¨","ä¸Šæµ·"),
	(60,"åå‹¤éƒ¨","åŒ—äº¬"),
	(70,"æŠ€æœ¯éƒ¨","åŒ—äº¬"),
	(80,"å¸‚åœºéƒ¨","åŒ—äº¬");
```

æ­¤æ—¶å¯ä»¥ç”¨å…³é”®å­—`IGNORE`å¿½ç•¥é”™è¯¯æ•°æ®

```mysql
INSERT  IGNORE  INTO t_dept (deptno, dname, loc )
VALUES
	(40,"ä¼åˆ’éƒ¨","åŒ—äº¬"),
	(50,"åŸ¹è®­éƒ¨","ä¸Šæµ·"),
	(60,"åå‹¤éƒ¨","åŒ—äº¬"),
	(70,"æŠ€æœ¯éƒ¨","åŒ—äº¬"),
	(80,"å¸‚åœºéƒ¨","åŒ—äº¬");
```

##### å®ç°ä¸å­˜åœ¨å°±æ’å…¥,å­˜åœ¨å°±æ›´æ–°

````mysql
INSERT  INTO t_emp_ip (id,empno,ip)
VALUES
(5,8004,"192.168.2.555"),
(6,8005,"192.168.2.353"),
(7,8006,"192.168.2.666"),
(8,8007,"192.168.2.363"),
(9,8228,"192.168.2.888")
ON duplicate KEY  UPDATE  ip=values(ip);
````

è¿™ä¸ª`ON DUPLICATE KEY UPDATE`	æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹,å°±æ˜¯è¦çœ‹`ä¸»é”®çº¦æŸ`å’Œ`å”¯ä¸€çº¦æŸ`,å¦‚æœ`ä¸»é”®çº¦æŸ`æˆ–è€…`å”¯ä¸€çº¦æŸ`å­˜åœ¨,å°±ä¼šåœ¨åŸæ¥çš„åŸºç¡€ä¸Šä¿®æ”¹åè¾¹`ip=values(ip)`çš„æ•°æ®,å¦‚æœä¸å­˜åœ¨å°±æ‰§è¡Œæ’å…¥

#### æŸ¥è¯¢

##### å­æŸ¥è¯¢

`mysql`æ•°æ®åº“é»˜è®¤å…³é—­äº†ç¼“å­˜,æ‰€ä»¥æ¯ä¸ªå­æŸ¥è¯¢éƒ½æ˜¯`ç›¸å…³å­æŸ¥è¯¢`

`ç›¸å…³å­æŸ¥è¯¢`å°±æ˜¯è¦å¾ªç¯æ‰§è¡Œå¤šæ¬¡çš„å­æŸ¥è¯¢

![image-20211117141354669](https://gitee.com/ibepo/ogcip/raw/master/20211117141355.png)

- `Mybatis` ç­‰æŒä¹…å±‚æ¡†æ¶å¼€å¯äº†ç¼“å­˜åŠŸèƒ½,å…¶ä¸­ä¸€çº§ç¼“å­˜å°±ä¼šä¿å­˜`å­æŸ¥è¯¢ç»“æœ`,æ‰€ä»¥åœ¨ mybatis æ¡†æ¶ä¸­å¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨`å­æŸ¥è¯¢`,**ä½†æ˜¯å‰ææ˜¯è¦é…ç½®`ä¸€å¯¹ä¸€å…³ç³»`æˆ–è€…`ä¸€å¯¹å¤šå…³ç³»`**
- ç»“è®º:`sql æ§åˆ¶å°`ä¸è¦ä½¿ç”¨`å­æŸ¥è¯¢`,åœ¨`æŒä¹…å±‚æ¡†æ¶`ä¸­å¯ä»¥ä½¿ç”¨`å­æŸ¥è¯¢`

##### å¦‚ä½•æ›¿ä»£å­æŸ¥è¯¢

- ä½¿ç”¨ `From` å­æŸ¥è¯¢,ä»£æ›¿ `Where `å­æŸ¥è¯¢

![image-20211117141934292](https://gitee.com/ibepo/ogcip/raw/master/20211117141934.png)

`FORM`å­å¥åœ¨æŸ¥è¯¢ä¸­æœ€å…ˆè¢«æ‰§è¡Œ,è€Œä¸”åªæŸ¥è¯¢ä¸€æ¬¡,æ‰€ä»¥ä¸æ˜¯ç›¸å…³å­æŸ¥è¯¢

`join on`å­å¥,å°†`from`è¿æ¥çš„è¡¨å’Œ`join`è¿æ¥çš„è¡¨äº§ç”Ÿä¸€ä¸ª`ç¬›å¡å°”ç§¯`,å†ç”¨ `on`åšç­›é€‰

`on`å¯ä»¥ç†è§£ä¸ºåœ¨`ä»€ä¹ˆ..æ¡ä»¶ä¹‹ä¸Š`

##### å¤–è¿æ¥çš„ JOINæ¡ä»¶

- å†…è¿æ¥é‡Œ,æŸ¥è¯¢æ¡ä»¶å†™åœ¨ `on`å­å¥æˆ–è€… `where` å­å¥,æ•ˆæœæ˜¯ç›¸åŒçš„

![image-20211117142535288](https://gitee.com/ibepo/ogcip/raw/master/20211117142535.png)

![image-20211117143643048](https://gitee.com/ibepo/ogcip/raw/master/20211117143643.png)



- å¤–è¿æ¥é‡Œ,æŸ¥è¯¢æ¡ä»¶å†™åœ¨ on å­å¥æˆ–è€… where å­å¥ä¸­,æ•ˆæœä¸åŒ

![image-20211117143802581](https://gitee.com/ibepo/ogcip/raw/master/20211117143803.png)

##### è¡¨è¿æ¥ä¿®æ”¹

update è¯­å¥ä¸­çš„ where å­æŸ¥è¯¢å¦‚ä½•æ”¹ä¸ºè¡¨è¿æ¥

- å­æŸ¥è¯¢æ–¹å¼

```mysql
#é€šè¿‡éƒ¨é—¨è¡¨æ‰¾å‡ºå«åš"SALES"çš„ éƒ¨é—¨code,
#æ›´æ–°å‘˜å·¥è¡¨ä¸­ç›¸å…³ éƒ¨é—¨code çš„ sal å­—æ®µ
UPDATE t_emp
SET sal = 1000
WHERE deptno = ( SELECT deptno FROM t_dept WHERE dname = 'SALES' )
```

- è¡¨è¿æ¥æ–¹å¼

  ä¸¤å¼ è¡¨åšå†…è¿æ¥,å¯ä»¥åŒæ—¶ update ä¸¤å¼ è¡¨ä¸­çš„æ•°æ®

```mysql
UPDATE  t_emp e JOIN t_dept d ON e.deptno =d.deptno 
AND d.dname ='SALES'
SET e.sal =1000 , d.dname ='é”€å”®éƒ¨';
```



###  MySQLç´¢å¼•å¤±æ•ˆ,å…¨è¡¨æ‰«æ

 [ é˜¿é‡Œå¼€å‘è§„èŒƒè§£è¯»ï¼Œå°å¿ƒMySQLç´¢å¼•é€‰æ‹©æ€§é™·é˜±](https://www.bilibili.com/video/BV1xv411P7BY?spm_id_from=333.999.0.0)

> é˜¿é‡Œå·´å·´çš„çº¦æŸ,é¡µé¢æœç´¢ä¸¥ç¦å·¦æ¨¡ç³Šæˆ–è€…å…¨æ¨¡ç³Š,å¦‚æœéœ€è¦èµ°æœç´¢å¼•æ“è§£å†³(ç´¢å¼•æ–‡ä»¶å…·æœ‰ b-tree çš„æœ€å·¦å‰ç¼€åŒ¹é…ç‰¹æ€§,å¦‚æœå·¦è¾¹çš„å€¼æœªç¡®å®š,é‚£ä¹ˆæ— æ³•ä½¿ç”¨ç´¢å¼•)



#####    ä»€ä¹ˆæ˜¯ç´¢å¼•é€‰æ‹©æ€§é™·é˜±? 

ğŸ“Œ  mysql æ˜¯ä»¥ä¸»é”®ç´¢å¼•å’ŒäºŒçº§ç´¢å¼•ä¸ºä¸»æ­å»ºçš„,å½“äºŒçº§ç´¢å¼•ä¸Šå‘½ä¸­è¿‡å¤šå•ä½,ä¼˜åŒ–å™¨å°±ä¼šè®¤ä¸ºé¢„æœŸäºŒçº§ç´¢å¼•åœ¨å›è¡¨å¤§é¢ç§¯æ‰«æä¸»é”®ç´¢å¼•,ä¸ºäº†èŠ‚çœè¿™ä¸ªå›è¡¨çš„é€Ÿåº¦,è¿˜ä¸å¦‚ç›´æ¥å…¨è¡¨æ‰«æä¸»é”®ç´¢å¼•,ä¼˜åŒ–å™¨å°±ä¼šä¸èµ°ç´¢å¼•

ğŸ“Œ  å‘½ä¸­ç´¢å¼•å€¼è¶…è¿‡æ€»é‡25%,å°±æœ‰å¯èƒ½é€ æˆç´¢å¼•é€‰æ‹©æ€§é™·é˜±,å¯¼è‡´å…¨è¡¨æ‰«æ ps:ä¸€åˆ‡ä»¥ explain æ‰§è¡Œè®¡åˆ’ä¸ºå‡†

ğŸ“Œ å¸¸è§æ¡ˆä¾‹:
 åœ¨ä¸šåŠ¡è¡¨ä¸­åªæŸ¥è¯¢é€»è¾‘åˆ =0 çš„æ•°æ®(è¿™é‡Œæœ‰ä¸ªåªæ˜¯,å°±æ˜¯ä¸šåŠ¡è¡¨éƒ½æ˜¯é€»è¾‘åˆ é™¤,ä¸ä¼šçœŸåˆ é™¤,æ¯”å¦‚è®¢å•è¡¨,æµæ°´è¡¨ç­‰)
 æŸ¥è¯¢æ ¼åŠ›é›†å›¢å¹´è–ª<5 ä¸‡çš„äººå‘˜å·¥èµ„
 åŒ»é™¢æŠ¤å£«æŸ¥è¯¢æ€§åˆ«ä¸ºå¥³çš„å·¥ä½œäººå‘˜ 
 æ­¤ä¸‰è€…éƒ½æ˜¯å‘½ä¸­ç™»å½•å¤ªå¤šçš„ç´¢å¼•,æ‰€ä»¥è¿˜ä¸å¦‚ä¸ç›´æ¥èµ°å…¨è¡¨æ‰«æ

![ç´¢å¼•å‘½ä¸­å’Œæœªå‘½ä¸­çš„åœ¨æ‰§è¡Œè®¡åˆ’ä¸­çš„ä½“ç°](https://gitee.com/ibepo/ogcip/raw/master/20210930122632.png)



#####   ç´¢å¼•é€‰æ‹©æ€§é™·é˜±å¦‚ä½•è§£å†³?

 ğŸ“Œ é€šè¿‡ç»„åˆç´¢å¼•æé«˜é€‰æ‹©æ€§é—®é¢˜(ä¸šåŠ¡ç›¸å…³)
  select * from æŠ¤å£«è¡¨ where ç§‘å®¤="å¦‡ç§‘"and æ€§åˆ«="å¥³",åœ¨ç§‘å®¤å’Œæ€§åˆ«ä¸Šå»ºç«‹ç»„åˆç´¢å¼•

 ğŸ“Œé€šè¿‡å¼•å…¥å¼•æ“ç´¢å¼• es æ›´æ¢æ•°æ®æº
  ä¾‹å¦‚:å°†æŠ¤å£«è¡¨å¯¼å…¥ es,es æ˜¯åŸºäºåˆ†ç‰‡å¤šçº¿ç¨‹æ£€ç´¢,è§£å†³æŸ¥è¯¢æ…¢çš„é—®é¢˜,ä½†æ˜¯è¿™ä¸ªä¼šå¢åŠ å¤æ‚åº¦ å¢åŠ ä¸€äº›æ–°çš„é—®é¢˜
  å¢åŠ äº†é¢å¤–çš„å¼•æ“,è€ƒè™‘å¯ç”¨æ€§é—®é¢˜
   æ•°æ®ä¸€è‡´æ€§é—®é¢˜ æ˜¯ mq æ•°æ®åŒæ­¥ æ˜¯canal åšbinglog ,å¦‚æœæ•æ„Ÿè¿™ä¸ªæ—¶é—´éœ€è¦è€ƒè™‘åˆ†å¸ƒå¼é”çš„é—®é¢˜

 ğŸ“Œå¼ºåˆ¶ä½¿ç”¨ç´¢å¼•(æœ‰æ—¶ä¼šæœ‰å¥‡æ•ˆ,ä»¥å®é™…è¿è¡Œæ•ˆæœä¸ºå‡†)
  explain select * from question forece index(answer) where answer='a';

 ğŸ“Œå¢åŠ ç¼“å­˜,æé«˜å…¨è¡¨æ‰«æé€Ÿåº¦(é’èƒ½åŠ›)
 innodb_buffer_pool_size=16G
 innodb_buffer_pool_instances=2



#####  MySQLè„è¯»ã€å¹»è¯»ã€ä¸å¯é‡å¤è¯»

> MySQLé»˜è®¤Repeatable Read(RR)-å¯é‡å¤è¯»
> MySQL 5.1ä»¥åé»˜è®¤å­˜å‚¨å¼•æ“å°±æ˜¯InnoDB
> å› æ­¤MySQLé»˜è®¤RRä¹Ÿèƒ½è§£å†³å¹»è¯»é—®é¢˜



 ğŸ“Œ   **è„è¯»**æ˜¯è¯»å–åˆ°äº†å…¶ä»–äº‹åŠ¡ä¸­æ­£åœ¨å¤„ç†çš„æœªæäº¤æ•°æ®, 

â€‹         äº‹åŠ¡ b åœ¨æäº¤äº‹åŠ¡ä¹‹å‰ä¿®æ”¹ä¸ºå¼ è€ä¸‰äº† ,ç»“æœè®©äº‹åŠ¡ a è¯»åˆ°äº†,ç»“æœäº‹åŠ¡ b   å›æ»šäº†,è¿™æ—¶å€™æ•°æ®ç¼–ç¨‹äº†å¼ ä¸‰

 ğŸ“Œ  **ä¸å¯é‡å¤åº¦** æ˜¯æŒ‡**å¹¶å‘æ›´æ–°**æ—¶,å¦ä¸€ä¸ªäº‹åŠ¡å‰åæŸ¥è¯¢ç›¸åŒæ•°æ®æ—¶çš„æ•°æ®ä¸ç¬¦åˆé¢„æœŸ

â€‹        äº‹åŠ¡aç¬¬ä¸€æ¬¡ è¯»æ˜¯ å¼ ä¸‰ ,è¿™æ—¶å€™äº‹åŠ¡ b ä¿®æ”¹ä¸ºå¼ è€ä¸‰ ,äº‹åŠ¡ a ç¬¬äºŒæ¬¡è¯»å˜æˆäº†å¼ è€ä¸‰

ğŸ“Œ  **å¹»è¯»**æ˜¯å¹¶å‘**æ–°å¢ã€åˆ é™¤**è¿™ç§ä¼šäº§ç”Ÿæ•°é‡å˜åŒ–çš„æ“ä½œ

â€‹       äº‹åŠ¡aç¬¬ä¸€è¯»ä¸‰æ¡æ•°æ® äº‹åŠ¡b å†™äº†ä¸€æ¡ äº‹åŠ¡ a å†è¯»å˜æˆäº†å››æ¡

ğŸ“Œ  äº‹åŠ¡éš”ç¦»çº§åˆ«

â€‹		è¯»æœªæäº¤  è¯»å·²æäº¤  å¯é‡å¤è¯»(innodb ä¼šå¤„ç†æ‰å¹»è¯»)  ä¸²è¡ŒåŒ–



```shell
#è·å–å½“å‰äº‹åŠ¡éš”ç¦»ç•Œåˆ«ï¼Œé»˜è®¤RRå¯é‡å¤è¯»
SHOW VARIABLES LIKE 'transaction_isolation'; # REPEATABLE-READ

#è®¾ç½®å½“å‰ä¼šè¯äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸ºâ€œè¯»æœªæäº¤â€
SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

```

![image-20210910155205141](https://gitee.com/ibepo/ogcip/raw/master/20210930122651.png)

![image-20210910153814448](https://gitee.com/ibepo/ogcip/raw/master/20210930122657.png)

![image-20210910154016692](https://gitee.com/ibepo/ogcip/raw/master/20210930122703.png)



![image-20210910154225837](https://gitee.com/ibepo/ogcip/raw/master/20210930122710.png)

####  MVCCæœºåˆ¶

> åœ¨MySQL InnoDBå­˜å‚¨å¼•æ“ä¸‹
> RCã€RRåŸºäºMVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰è¿›è¡Œå¹¶å‘äº‹åŠ¡æ§åˆ¶
> MVCCæ˜¯åŸºäºâ€æ•°æ®ç‰ˆæœ¬â€å¯¹å¹¶å‘äº‹åŠ¡è¿›è¡Œè®¿é—®

<img src="https://gitee.com/ibepo/ogcip/raw/master/20210930122715.png" alt="image-20210910160806338"  />

###### undo_log ç‰ˆæœ¬é“¾æ¡

 ğŸ“Œ  undolog å°±æ˜¯å›æ»šæ—¥å¿—çš„æ„æ€,æ˜¯ innodb ç‰¹æœ‰çš„æ—¥å¿—,çœŸå®çš„æ•°æ® å…¶å®æ˜¯è¿˜æœ‰ä¸¤ä¸ªå­—æ®µçš„

| å­—æ®µ        |         è§£é‡Š         |
| ----------- | :------------------: |
| trx_id      | æ·»åŠ çš„è¿™æ¡æ•°æ®çš„äº‹åŠ¡ |
| db_rool_ptr | é“¾è¡¨å¤´,ç”¨äºå¾€ä¸‹éå†  |

<img src="https://gitee.com/ibepo/ogcip/raw/master/20210930122720.png" alt="image-20210910161138670" style="zoom:50%;" />

![image-20210915111506579](https://gitee.com/ibepo/ogcip/raw/master/20210930122725.png)

###### Readview (å¿«ç…§è¯») 

ğŸ“Œ **å¿«ç…§è¯»**(Readview)å°±æ˜¯æœ€æ™®é€šçš„ select æŸ¥è¯¢ SQL è¯­å¥

â€‹        SQL æ‰§è¡Œæ—¶, **MVCC** æå–æ•°æ®çš„ä¾æ®,**ä¸”åªæœ‰è¿™æ—¶å€™ç”¨åˆ°äº† MVCC æ§åˆ¶**

â€‹       **Readview** æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„,åŒ…å«å››ä¸ªå­—æ®µ

| å­—æ®µ           |                             è§£é‡Š                             |
| -------------- | :----------------------------------------------------------: |
| m_ids          |                    å½“å‰æ´»è·ƒçš„äº‹åŠ¡ç¼–å·é›†åˆ                    |
| min_trx_id     |                       æœ€å°æ´»è·ƒäº‹åŠ¡ç¼–å·                       |
| max_trx_id     |              é¢„åˆ†é…äº‹åŠ¡ç¼–å·,å½“å‰æœ€å¤§äº‹åŠ¡ç¼–å·+1               |
| creator_trx_id | ReadViewåˆ›å»ºè€…çš„äº‹åŠ¡ç¼–å·,ä¸€èˆ¬æ˜¯ è°ƒç”¨ `select` å‘½ä»¤çš„é‚£ä¸ªäº‹åŠ¡ |

:one: è¯»å·²æäº¤(RC)

è¯»å·²æäº¤åœ¨æ¯ä¸€æ¬¡æ‰§è¡Œå¿«ç…§è¯»(select)æ—¶ç”Ÿæˆ ReadView

![image-20210910164505490](https://gitee.com/ibepo/ogcip/raw/master/20210930122730.png)

è¿™é‡Œå°±è¦æ ¹æ®ç”Ÿæˆçš„ Readview å’Œ undolog ç‰ˆæœ¬é“¾è¿›è¡Œåˆ¤æ–­å¯¹æ¯”äº† 

è§„åˆ™å¦‚ä¸‹:

> undolog ç‰ˆæœ¬é“¾ç°åœ¨éå†å¾—åˆ°è¿™ä¸€è¡Œæ•°æ® `temp`å’Œ readview ä¸­çš„å­—æ®µè¿›è¡Œé€»è¾‘åˆ¤æ–­,å¦‚æœæ¡ä»¶ç¬¦åˆå°±çœ‹å°ä¸€æ¡

â‘  `temp`ä¸­çš„ `trx_id` æ˜¯ä¸æ˜¯ `creator_trx_id`?

æˆç«‹è¯´æ˜å°±æ˜¯è‡ªå·±è¿™ä¸ªäº‹åŠ¡ä¿®æ”¹çš„,é‡‡ç”¨è¿™ä¸ª temp ä½œä¸ºç»“æœ,å°±æ˜¯è‡ªå·±è¿™ä¸ªäº‹åŠ¡,å…ˆæ‰§è¡Œäº† update åœ¨æ‰§è¡Œäº† select

â‘¡`temp`ä¸­çš„ `trx_id`<`min_trx_id`?

æˆç«‹è¯´æ˜æ•°æ®å·²ç»æäº¤äº†å¯ä»¥è®¿é—®,è¯´æ˜temp æ˜¯åœ¨

â‘¢`temp`ä¸­çš„ `trx_id`<`max_trx_id`?

![image-20210910164134776](https://gitee.com/ibepo/ogcip/raw/master/20210930122736.png)



###### å½“å‰è¯»

ğŸ“Œ **å½“å‰è¯»**æ˜¯æŒ‡æ‰§è¡Œä»¥ä¸‹è¯­å¥æ˜¯è¿›è¡Œæ•°æ®è¯»å–çš„æ–¹å¼

â€‹    `Insert` ` Update` `Delete` 

â€‹    `Select ... for update`

â€‹    `Select ...lock in share mode`

####  bin_log



![image-20210910130843984](https://gitee.com/ibepo/ogcip/raw/master/20210930122743.png)

```
$ vi my.cnf

[mysqld]
server_id=1
log-bin=master
binlog_format=row


# æ˜¯å¦å¯ç”¨binlogæ—¥å¿—
show variables like 'log_bin';

# æŸ¥çœ‹è¯¦ç»†çš„æ—¥å¿—é…ç½®ä¿¡æ¯
show global variables like '%log%';

# mysqlæ•°æ®å­˜å‚¨ç›®å½•
show variables like '%dir%';

# æŸ¥çœ‹binlogçš„ç›®å½•
show global variables like "%log_bin%";

# æŸ¥çœ‹å½“å‰æœåŠ¡å™¨ä½¿ç”¨çš„biglogæ–‡ä»¶åŠå¤§å°
show binary logs;

# æŸ¥çœ‹ä¸»æœåŠ¡å™¨ä½¿ç”¨çš„biglogæ–‡ä»¶åŠå¤§å°

# æŸ¥çœ‹æœ€æ–°ä¸€ä¸ªbinlogæ—¥å¿—æ–‡ä»¶åç§°å’ŒPosition
show master status;


# äº‹ä»¶æŸ¥è¯¢å‘½ä»¤
# IN 'log_name' ï¼šæŒ‡å®šè¦æŸ¥è¯¢çš„binlogæ–‡ä»¶å(ä¸æŒ‡å®šå°±æ˜¯ç¬¬ä¸€ä¸ªbinlogæ–‡ä»¶)
# FROM pos ï¼šæŒ‡å®šä»å“ªä¸ªposèµ·å§‹ç‚¹å¼€å§‹æŸ¥èµ·(ä¸æŒ‡å®šå°±æ˜¯ä»æ•´ä¸ªæ–‡ä»¶é¦–ä¸ªposç‚¹å¼€å§‹ç®—)
# LIMIT [offset,] ï¼šåç§»é‡(ä¸æŒ‡å®šå°±æ˜¯0)
# row_count ï¼šæŸ¥è¯¢æ€»æ¡æ•°(ä¸æŒ‡å®šå°±æ˜¯æ‰€æœ‰è¡Œ)
show binlog events [IN 'log_name'] [FROM pos] [LIMIT [offset,] row_count];

# æŸ¥çœ‹ binlog å†…å®¹
show binlog events;

# æŸ¥çœ‹å…·ä½“ä¸€ä¸ªbinlogæ–‡ä»¶çš„å†…å®¹ ï¼ˆin åé¢ä¸ºbinlogçš„æ–‡ä»¶åï¼‰
show binlog events in 'master.000003';

# è®¾ç½®binlogæ–‡ä»¶ä¿å­˜äº‹ä»¶ï¼Œè¿‡æœŸåˆ é™¤ï¼Œå•ä½å¤©
set global expire_log_days=3; 

# åˆ é™¤å½“å‰çš„binlogæ–‡ä»¶
reset master; 

# åˆ é™¤slaveçš„ä¸­ç»§æ—¥å¿—
reset slave;

# åˆ é™¤æŒ‡å®šæ—¥æœŸå‰çš„æ—¥å¿—ç´¢å¼•ä¸­binlogæ—¥å¿—æ–‡ä»¶
purge master logs before '2019-03-09 14:00:00';

# åˆ é™¤æŒ‡å®šæ—¥å¿—æ–‡ä»¶
purge master logs to 'master.000003';
```

![image-20210913093935918](https://gitee.com/ibepo/ogcip/raw/master/20210930122749.png)

![image-20210915104742055](https://gitee.com/ibepo/ogcip/raw/master/20210930122753.png)



### PerconaTookit

```shell
#å®‰è£…ä¾èµ–åŒ…
yum install -y perl-DBI
yum install -y perl-DBD-mysql
yum install -y perl-IO-Socket-SSL
yum install -y perl-Digest-MD5
yum install -y perl-TermReadKey
```

![image-20211116181349491](https://gitee.com/ibepo/ogcip/raw/master/20211116181349.png)

##### çº¿ä¸Šå®æ—¶ä¿®æ”¹è¡¨ç»“æ„

```shell
docker run -it perconalab/percona-toolkit \
  pt-online-schema-change --host=39.102.138.62 --port=3306 --user=root --password=123456\
  D=cms,t=b_side\
  --alter "MODIFY CODE int(13) NOT NULL DEFAULT '2'"\
  --print --execute
```





## Nginx

### å®‰è£…

```bash
/usr/local/nginx/sbin/nginx #å¯åŠ¨ nginx
/usr/local/nginx/sbin/nginx -s reload ##é‡æ–°åŠ è½½Nginxé…ç½®æ–‡ä»¶ï¼Œç„¶åä»¥ä¼˜é›…çš„æ–¹å¼é‡å¯Nginx
/usr/local/nginx/sbin/nginx -s stop #å¼ºåˆ¶åœæ­¢NginxæœåŠ¡

nginx -t #æ£€æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼Œç„¶åé€€å‡º
```

![image-20210507102156114](https://gitee.com/ibepo/ogcip/raw/master/20210930122800.png)

### é…ç½®

```nginx
#nginx.conf
user  nobody;
worker_processes  1;

events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;


# rootæ˜¯å®šä½åˆ°æœåŠ¡å™¨çœŸå®ç›®å½•çš„ä¸€ä¸ªç›®å½•ä½œä¸ºåˆå§‹ç›®å½• å†åŠ ä¸Šlocationä¸­çš„ç›®å½•
# æ¯”å¦‚ rootæ˜¯/panghu/s,è¿™ä¸ªä½œä¸ºbasepath+locationä¸­çš„/s/,é‚£ä¹ˆè®¿é—®localhost/s/,å°±èƒ½è®¿é—®åˆ°è¯¥ç›®å½•ä¸‹
# ä¸€ä¸ªserverä¸­çš„ä¼˜å…ˆçº§æ˜¯æ­£åˆ™è¡¨è¾¾å¼>æ·±è·¯å¾„>æµ…è·¯å¾„
    server {
        server_tokens off;
        listen       80;
        server_name  localhost;
        location  / {
            root   /panghu/work/h5;
            index  index.html index.htm;
        }
        location /s/{
                 root   /panghu/work
                 index  index.html index.htm;
        }
                #location ~\.(gif|jpg|png){
                #   # root   /panghu/work/s;
                #}
    }

}
```



```shell
# Nginxé…ç½®æ–‡ä»¶
/etc/nginx/nginx.conf # nginx ä¸»é…ç½®æ–‡ä»¶
/etc/nginx/nginx.conf.default

# å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶
/usr/bin/nginx-upgrade
/usr/sbin/nginx

# nginxåº“æ–‡ä»¶
/usr/lib/systemd/system/nginx.service # ç”¨äºé…ç½®ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹
/usr/lib64/nginx/modules # Nginxæ¨¡å—ç›®å½•

# å¸®åŠ©æ–‡æ¡£
/usr/share/doc/nginx-1.16.1
/usr/share/doc/nginx-1.16.1/CHANGES
/usr/share/doc/nginx-1.16.1/README
/usr/share/doc/nginx-1.16.1/README.dynamic
/usr/share/doc/nginx-1.16.1/UPGRADE-NOTES-1.6-to-1.10

# é™æ€èµ„æºç›®å½•
/usr/share/nginx/html/404.html
/usr/share/nginx/html/50x.html
/usr/share/nginx/html/index.html

# å­˜æ”¾Nginxæ—¥å¿—æ–‡ä»¶
/var/log/nginx

```

```shell
# å¼€æœºé…ç½®
systemctl enable nginx # å¼€æœºè‡ªåŠ¨å¯åŠ¨
systemctl disable nginx # å…³é—­å¼€æœºè‡ªåŠ¨å¯åŠ¨

# å¯åŠ¨Nginx
systemctl start nginx # å¯åŠ¨NginxæˆåŠŸåï¼Œå¯ä»¥ç›´æ¥è®¿é—®ä¸»æœºIPï¼Œæ­¤æ—¶ä¼šå±•ç¤ºNginxé»˜è®¤é¡µé¢

# åœæ­¢Nginx
systemctl stop nginx

# é‡å¯Nginx
systemctl restart nginx

# é‡æ–°åŠ è½½Nginx
systemctl reload nginx

# æŸ¥çœ‹ Nginx è¿è¡ŒçŠ¶æ€
systemctl status nginx

# æŸ¥çœ‹Nginxè¿›ç¨‹
ps -ef | grep nginx

# æ€æ­»Nginxè¿›ç¨‹
kill -9 pid # æ ¹æ®ä¸Šé¢æŸ¥çœ‹åˆ°çš„Nginxè¿›ç¨‹å·ï¼Œæ€æ­»Nginxè¿›ç¨‹ï¼Œ-9 è¡¨ç¤ºå¼ºåˆ¶ç»“æŸè¿›ç¨‹


```



### å‚è€ƒ

[å‰ç«¯ä»”ä¹Ÿéœ€è¦æ‡‚çš„nginxå†…å®¹](https://juejin.cn/post/7007346707767754765)

[Nginx çš„ try_files æŒ‡ä»¤ä½¿ç”¨å®ä¾‹ ](https://www.hi-linux.com/posts/53878.html)

[å‰ç«¯éƒ¨ç½²æ¼”åŒ–å².op-note/deploy-fe.md at master Â· shfshanyue/op-note (github.com)](https://github.com/shfshanyue/op-note/blob/master/deploy-fe.md)

[ä½¿ç”¨apt-getå®‰è£…Nginx - å¿«ä¹çš„å‡¡äºº721 - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/luo630/p/9363478.html)

[ä¸‡å­—æ€»ç»“ï¼Œä½“ç³»åŒ–å¸¦ä½ å…¨é¢è®¤è¯† Nginx ï¼ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6942607113118023710)

## Redis

### å®‰è£…

#### åŸç”Ÿå®‰è£…

```shell
#â‘ ä¸Šä¼ å®‰è£…åŒ…,è‡ªå·±ç¼–è¯‘
yum install gcc-c++    #gccç¼–è¯‘å™¨
cd /opt                #åœ¨/opt ç›®å½•ä¸‹ ä¸‹è½½æ‰“åŒ…å‹ç¼©çš„redis
wget http://download.redis.io/releases/redis-2.8.17.tar.gz
cd  /opt/redis-2.8.17.tar.gz
tar xzvf

make #ç¼–è¯‘
å¦‚æœç¼–è¯‘å‡ºç°é”™è¯¯ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œæ¸…é™¤ç¼“å­˜
make distclean
make 
make insatall
```

```shell
#â‘¡yum æ·»åŠ æº,yum å®‰è£…åˆ°/usr/local/bin
yum install epel-release #å®‰è£…Fedoraçš„epelä»“åº“
yum install redis
```

![image-20210507102119205](https://gitee.com/ibepo/ogcip/raw/master/20210930122805.png)

### é…ç½®

```toml
redisé…ç½®æ–‡ä»¶æ ·ä¾‹

# Note on units: when memory size is needed, it is possible to specifiy
# it in the usual form of 1k 5GB 4M and so forth:
#
# 1k => 1000 bytes
# 1kb => 1024 bytes
# 1m => 1000000 bytes
# 1mb => 1024*1024 bytes
# 1g => 1000000000 bytes
# 1gb => 1024*1024*1024 bytes
#
# units are case insensitive so 1GB 1Gb 1gB are all the same.

# Redisé»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨yeså¯ç”¨å®ˆæŠ¤è¿›ç¨‹
# å¯ç”¨å®ˆæŠ¤è¿›ç¨‹åï¼ŒRedisä¼šæŠŠpidå†™åˆ°ä¸€ä¸ªpidfileä¸­ï¼Œåœ¨/var/run/redis.pid
daemonize yes

# å½“Redisä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶ï¼ŒRedisé»˜è®¤ä¼šæŠŠpidå†™å…¥/var/run/redis.pidæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡pidfileæŒ‡å®š
pidfile /var/run/redis.pid

# æŒ‡å®šRedisç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º6379
# å¦‚æœæŒ‡å®š0ç«¯å£ï¼Œè¡¨ç¤ºRedisä¸ç›‘å¬TCPè¿æ¥
port 6379

# ç»‘å®šçš„ä¸»æœºåœ°å€
# ä½ å¯ä»¥ç»‘å®šå•ä¸€æ¥å£ï¼Œå¦‚æœæ²¡æœ‰ç»‘å®šï¼Œæ‰€æœ‰æ¥å£éƒ½ä¼šç›‘å¬åˆ°æ¥çš„è¿æ¥
# bind 127.0.0.1
bind 0.0.0.0

# Specify the path for the unix socket that will be used to listen for
# incoming connections. There is no default, so Redis will not listen
# on a unix socket when not specified.
#
# unixsocket /tmp/redis.sock
# unixsocketperm 755

# å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½
timeout 0

# æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedisæ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸ºverbose
# debug (å¾ˆå¤šä¿¡æ¯, å¯¹å¼€å‘ï¼æµ‹è¯•æ¯”è¾ƒæœ‰ç”¨)
# verbose (many rarely useful info, but not a mess like the debug level)
# notice (moderately verbose, what you want in production probably)
# warning (only very important / critical messages are logged)
loglevel verbose

# æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æœé…ç½®ä¸ºredisä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™/dev/null
logfile /logs/redis.log

# To enable logging to the system logger, just set 'syslog-enabled' to yes,
# and optionally update the other syslog parameters to suit your needs.
# syslog-enabled no

# Specify the syslog identity.
# syslog-ident redis

# Specify the syslog facility.  Must be USER or between LOCAL0-LOCAL7.
# syslog-facility local0

# è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨select <dbid>å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id
# dbidæ˜¯ä»0åˆ°â€˜databasesâ€™-1çš„æ•°ç›®
databases 16

################################ SNAPSHOTTING  #################################
# æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ
# Save the DB on disk:
#
#   save <seconds> <changes>
#
#   Will save the DB if both the given number of seconds and the given
#   number of write operations against the DB occurred.
#
#   æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å°†ä¼šåŒæ­¥æ•°æ®:
#   900ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…æœ‰1ä¸ªæ›´æ”¹
#   300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…æœ‰10ä¸ªæ›´æ”¹
#   60ç§’å†…æœ‰10000ä¸ªæ›´æ”¹
#   Note: å¯ä»¥æŠŠæ‰€æœ‰â€œsaveâ€è¡Œæ³¨é‡Šæ‰ï¼Œè¿™æ ·å°±å–æ¶ˆåŒæ­¥æ“ä½œäº†

save 900 1
save 300 10
save 60 10000

# æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyesï¼ŒRedisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§
rdbcompression yes

# æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºdump.rdb
dbfilename dump.rdb

# å·¥ä½œç›®å½•.
# æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼Œæ–‡ä»¶åç”±ä¸Šä¸€ä¸ªdbfilenameé…ç½®é¡¹æŒ‡å®š
#
# Also the Append Only File will be created inside this directory.
#
# æ³¨æ„ï¼Œè¿™é‡Œåªèƒ½æŒ‡å®šä¸€ä¸ªç›®å½•ï¼Œä¸èƒ½æŒ‡å®šæ–‡ä»¶å
dir ./

################################# REPLICATION #################################

# ä¸»ä»å¤åˆ¶ã€‚ä½¿ç”¨slaveofä» RedisæœåŠ¡å™¨å¤åˆ¶ä¸€ä¸ªRediså®ä¾‹ã€‚æ³¨æ„ï¼Œè¯¥é…ç½®ä»…é™äºå½“å‰slaveæœ‰æ•ˆ
# so for example it is possible to configure the slave to save the DB with a
# different interval, or to listen to another port, and so on.
# è®¾ç½®å½“æœ¬æœºä¸ºslavæœåŠ¡æ—¶ï¼Œè®¾ç½®masteræœåŠ¡çš„ipåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥
# slaveof <masterip> <masterport>


# å½“masteræœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼ŒslavæœåŠ¡è¿æ¥masterçš„å¯†ç 
# ä¸‹æ–‡çš„â€œrequirepassâ€é…ç½®é¡¹å¯ä»¥æŒ‡å®šå¯†ç 
# masterauth <master-password>

# When a slave lost the connection with the master, or when the replication
# is still in progress, the slave can act in two different ways:
#
# 1) if slave-serve-stale-data is set to 'yes' (the default) the slave will
#    still reply to client requests, possibly with out of data data, or the
#    data set may just be empty if this is the first synchronization.
#
# 2) if slave-serve-stale data is set to 'no' the slave will reply with
#    an error "SYNC with master in progress" to all the kind of commands
#    but to INFO and SLAVEOF.
#
slave-serve-stale-data yes

# Slaves send PINGs to server in a predefined interval. It's possible to change
# this interval with the repl_ping_slave_period option. The default value is 10
# seconds.
#
# repl-ping-slave-period 10

# The following option sets a timeout for both Bulk transfer I/O timeout and
# master data or ping response timeout. The default value is 60 seconds.
#
# It is important to make sure that this value is greater than the value
# specified for repl-ping-slave-period otherwise a timeout will be detected
# every time there is low traffic between the master and the slave.
#
# repl-timeout 60

################################## SECURITY ###################################

# Warning: since Redis is pretty fast an outside user can try up to
# 150k passwords per second against a good box. This means that you should
# use a very strong password otherwise it will be very easy to break.
# è®¾ç½®Redisè¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥Redisæ—¶éœ€è¦é€šè¿‡auth <password>å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­
requirepass yourpass
# Command renaming.
#
# It is possilbe to change the name of dangerous commands in a shared
# environment. For instance the CONFIG command may be renamed into something
# of hard to guess so that it will be still available for internal-use
# tools but not available for general clients.
#
# Example:
#
# rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52
#
# It is also possilbe to completely kill a command renaming it into
# an empty string:
#
# rename-command CONFIG ""

################################### LIMITS ####################################

# è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRediså¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸ºRedisè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œ
# å¦‚æœè®¾ç½®maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚å½“å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶ï¼ŒRedisä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å›max Number of clients reachedé”™è¯¯ä¿¡æ¯
# maxclients 128

# Don't use more memory than the specified amount of bytes.
# When the memory limit is reached Redis will try to remove keys with an
# EXPIRE set. It will try to start freeing keys that are going to expire
# in little time and preserve keys with a longer time to live.
# Redis will also try to remove objects from free lists if possible.
#
# If all this fails, Redis will start to reply with errors to commands
# that will use more memory, like SET, LPUSH, and so on, and will continue
# to reply to most read-only commands like GET.
#
# WARNING: maxmemory can be a good idea mainly if you want to use Redis as a
# 'state' server or cache, not as a real DB. When Redis is used as a real
# database the memory usage will grow over the weeks, it will be obvious if
# it is going to use too much memory in the long run, and you'll have the time
# to upgrade. With maxmemory after the limit is reached you'll start to get
# errors for write operations, and this may even lead to DB inconsistency.
# æŒ‡å®šRedisæœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedisåœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedisä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„Keyï¼Œ
# å½“æ­¤æ–¹æ³•å¤„ç†åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚
# Redisæ–°çš„vmæœºåˆ¶ï¼Œä¼šæŠŠKeyå­˜æ”¾å†…å­˜ï¼ŒValueä¼šå­˜æ”¾åœ¨swapåŒº
# maxmemory <bytes>

# MAXMEMORY POLICY: how Redis will select what to remove when maxmemory
# is reached? You can select among five behavior:
#
# volatile-lru -> remove the key with an expire set using an LRU algorithm
# allkeys-lru -> remove any key accordingly to the LRU algorithm
# volatile-random -> remove a random key with an expire set
# allkeys->random -> remove a random key, any key
# volatile-ttl -> remove the key with the nearest expire time (minor TTL)
# noeviction -> don't expire at all, just return an error on write operations
#
# Note: with all the kind of policies, Redis will return an error on write
#       operations, when there are not suitable keys for eviction.
#
#       At the date of writing this commands are: set setnx setex append
#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd
#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby
#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby
#       getset mset msetnx exec sort
#
# The default is:
#
# maxmemory-policy volatile-lru

# LRU and minimal TTL algorithms are not precise algorithms but approximated
# algorithms (in order to save memory), so you can select as well the sample
# size to check. For instance for default Redis will check three keys and
# pick the one that was used less recently, you can change the sample size
# using the following configuration directive.
#
# maxmemory-samples 3

############################## APPEND ONLY MODE ###############################

#
# Note that you can have both the async dumps and the append only file if you
# like (you have to comment the "save" statements above to disable the dumps).
# Still if append only mode is enabled Redis will load the data from the
# log file at startup ignoring the dump.rdb file.
# æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼ŒRedisåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚
# å› ä¸ºredisæœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢saveæ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºå†…å­˜ä¸­ã€‚é»˜è®¤ä¸ºno
# IMPORTANT: Check the BGREWRITEAOF to check how to rewrite the append
# log file in background when it gets too big.

appendonly yes

# æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºappendonly.aof
# appendfilename appendonly.aof

# The fsync() call tells the Operating System to actually write data on disk
# instead to wait for more data in the output buffer. Some OS will really flush
# data on disk, some other OS will just try to do it ASAP.

# æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰3ä¸ªå¯é€‰å€¼ï¼š
# no:è¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰
# always:è¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰
# everysec:è¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜è¡·ï¼Œé»˜è®¤å€¼ï¼‰

appendfsync everysec
# appendfsync no

# When the AOF fsync policy is set to always or everysec, and a background
# saving process (a background save or AOF log background rewriting) is
# performing a lot of I/O against the disk, in some Linux configurations
# Redis may block too long on the fsync() call. Note that there is no fix for
# this currently, as even performing fsync in a different thread will block
# our synchronous write(2) call.
#
# In order to mitigate this problem it's possible to use the following option
# that will prevent fsync() from being called in the main process while a
# BGSAVE or BGREWRITEAOF is in progress.
#
# This means that while another child is saving the durability of Redis is
# the same as "appendfsync none", that in pratical terms means that it is
# possible to lost up to 30 seconds of log in the worst scenario (with the
# default Linux settings).
#
# If you have latency problems turn this to "yes". Otherwise leave it as
# "no" that is the safest pick from the point of view of durability.
no-appendfsync-on-rewrite no

# Automatic rewrite of the append only file.
# Redis is able to automatically rewrite the log file implicitly calling
# BGREWRITEAOF when the AOF log size will growth by the specified percentage.
#
# This is how it works: Redis remembers the size of the AOF file after the
# latest rewrite (or if no rewrite happened since the restart, the size of
# the AOF at startup is used).
#
# This base size is compared to the current size. If the current size is
# bigger than the specified percentage, the rewrite is triggered. Also
# you need to specify a minimal size for the AOF file to be rewritten, this
# is useful to avoid rewriting the AOF file even if the percentage increase
# is reached but it is still pretty small.
#
# Specify a precentage of zero in order to disable the automatic AOF
# rewrite feature.

auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

################################## SLOW LOG ###################################

# The Redis Slow Log is a system to log queries that exceeded a specified
# execution time. The execution time does not include the I/O operations
# like talking with the client, sending the reply and so forth,
# but just the time needed to actually execute the command (this is the only
# stage of command execution where the thread is blocked and can not serve
# other requests in the meantime).
#
# You can configure the slow log with two parameters: one tells Redis
# what is the execution time, in microseconds, to exceed in order for the
# command to get logged, and the other parameter is the length of the
# slow log. When a new command is logged the oldest one is removed from the
# queue of logged commands.

# The following time is expressed in microseconds, so 1000000 is equivalent
# to one second. Note that a negative number disables the slow log, while
# a value of zero forces the logging of every command.
slowlog-log-slower-than 10000

# There is no limit to this length. Just be aware that it will consume memory.
# You can reclaim memory used by the slow log with SLOWLOG RESET.
slowlog-max-len 1024

################################ VIRTUAL MEMORY ###############################

### WARNING! Virtual Memory is deprecated in Redis 2.4
### The use of Virtual Memory is strongly discouraged.

### WARNING! Virtual Memory is deprecated in Redis 2.4
### The use of Virtual Memory is strongly discouraged.

# Virtual Memory allows Redis to work with datasets bigger than the actual
# amount of RAM needed to hold the whole dataset in memory.
# In order to do so very used keys are taken in memory while the other keys
# are swapped into a swap file, similarly to what operating systems do
# with memory pages.
# æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸ºnoï¼Œ
# VMæœºåˆ¶å°†æ•°æ®åˆ†é¡µå­˜æ”¾ï¼Œç”±Rediså°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ®swapåˆ°ç£ç›˜ä¸Šï¼Œè®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜è‡ªåŠ¨æ¢å‡ºåˆ°å†…å­˜ä¸­
# æŠŠvm-enabledè®¾ç½®ä¸ºyesï¼Œæ ¹æ®éœ€è¦è®¾ç½®å¥½æ¥ä¸‹æ¥çš„ä¸‰ä¸ªVMå‚æ•°ï¼Œå°±å¯ä»¥å¯åŠ¨VMäº†
# vm-enabled no
# vm-enabled yes

# This is the path of the Redis swap file. As you can guess, swap files
# can't be shared by different Redis instances, so make sure to use a swap
# file for every redis process you are running. Redis will complain if the
# swap file is already in use.
#
# Redisäº¤æ¢æ–‡ä»¶æœ€å¥½çš„å­˜å‚¨æ˜¯SSDï¼ˆå›ºæ€ç¡¬ç›˜ï¼‰
# è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/tmp/redis.swapï¼Œä¸å¯å¤šä¸ªRediså®ä¾‹å…±äº«
# *** WARNING *** if you are using a shared hosting the default of putting
# the swap file under /tmp is not secure. Create a dir with access granted
# only to Redis user and configure Redis to create the swap file there.
# vm-swap-file /tmp/redis.swap

# With vm-max-memory 0 the system will swap everything it can. Not a good
# default, just specify the max amount of RAM you can in bytes, but it's
# better to leave some margin. For instance specify an amount of RAM
# that's more or less between 60 and 80% of your free RAM.
# å°†æ‰€æœ‰å¤§äºvm-max-memoryçš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜ï¼Œæ— è®ºvm-max-memoryè®¾ç½®å¤šå°‘ï¼Œæ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„ï¼ˆRedisçš„ç´¢å¼•æ•°æ®å°±æ˜¯keysï¼‰
# ä¹Ÿå°±æ˜¯è¯´å½“vm-max-memoryè®¾ç½®ä¸º0çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ‰€æœ‰valueéƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤å€¼ä¸º0
# vm-max-memory 0

# Redis swapæ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ªpageä¸Šé¢ï¼Œä½†ä¸€ä¸ªpageä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº«ï¼Œvm-page-sizeæ˜¯è¦æ ¹æ®å­˜å‚¨çš„æ•°æ®å¤§å°æ¥è®¾å®šçš„ã€‚
# å»ºè®®å¦‚æœå­˜å‚¨å¾ˆå¤šå°å¯¹è±¡ï¼Œpageå¤§å°æœ€åè®¾ç½®ä¸º32æˆ–64bytesï¼›å¦‚æœå­˜å‚¨å¾ˆå¤§çš„å¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ›´å¤§çš„pageï¼Œå¦‚æœä¸ç¡®å®šï¼Œå°±ä½¿ç”¨é»˜è®¤å€¼
# vm-page-size 32

# è®¾ç½®swapæ–‡ä»¶ä¸­çš„pageæ•°é‡ç”±äºé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„bitmapï¼‰æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œåœ¨ç£ç›˜ä¸Šæ¯8ä¸ªpageså°†æ¶ˆè€—1byteçš„å†…å­˜
# swapç©ºé—´æ€»å®¹é‡ä¸º vm-page-size * vm-pages
#
# With the default of 32-bytes memory pages and 134217728 pages Redis will
# use a 4 GB swap file, that will use 16 MB of RAM for the page table.
#
# It's better to use the smallest acceptable value for your application,
# but the default is large in order to work in most conditions.
# vm-pages 134217728

# Max number of VM I/O threads running at the same time.
# This threads are used to read/write data from/to swap file, since they
# also encode and decode objects from disk to memory or the reverse, a bigger
# number of threads can help with big objects even if they can't help with
# I/O itself as the physical device may not be able to couple with many
# reads/writes operations at the same time.
# è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„I/Oçº¿ç¨‹æ•°ï¼Œæœ€åä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œé‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿï¼Œé»˜è®¤å€¼ä¸º4
# vm-max-threads 4

############################### ADVANCED CONFIG ###############################

# Hashes are encoded in a special way (much more memory efficient) when they
# have at max a given numer of elements, and the biggest element does not
# exceed a given threshold. You can configure this limits with the following
# configuration directives.
# æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³•
# hash-max-zipmap-entries 512
# hash-max-zipmap-value 64

# Similarly to hashes, small lists are also encoded in a special way in order
# to save a lot of space. The special representation is only used when
# you are under the following limits:
list-max-ziplist-entries 512
list-max-ziplist-value 64

# Sets have a special encoding in just one case: when a set is composed
# of just strings that happens to be integers in radix 10 in the range
# of 64 bit signed integers.
# The following configuration setting sets the limit in the size of the
# set in order to use this special memory saving encoding.
set-max-intset-entries 512

# Similarly to hashes and lists, sorted sets are also specially encoded in
# order to save a lot of space. This encoding is only used when the length and
# elements of a sorted set are below the following limits:
zset-max-ziplist-entries 128
zset-max-ziplist-value 64

# Active rehashing uses 1 millisecond every 100 milliseconds of CPU time in
# order to help rehashing the main Redis hash table (the one mapping top-level
# keys to values). The hash table implementation redis uses (see dict.c)
# performs a lazy rehashing: the more operation you run into an hash table
# that is rhashing, the more rehashing "steps" are performed, so if the
# server is idle the rehashing is never complete and some more memory is used
# by the hash table.
#
# The default is to use this millisecond 10 times every second in order to
# active rehashing the main dictionaries, freeing memory when possible.
#
# If unsure:
# use "activerehashing no" if you have hard latency requirements and it is
# not a good thing in your environment that Redis can reply form time to time
# to queries with 2 milliseconds delay.
# æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯
activerehashing yes

################################## INCLUDES ###################################

# æŒ‡å®šåŒ…å«å…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ªRediså®ä¾‹ä¹‹é—´ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€ŒåŒæ—¶å„å®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶
# include /path/to/local.conf
# include /path/to/other.conf


```



### ä½¿ç”¨

#### å®‰è£… iredis

```shell
$ pip3 install iredis
```

#### å‘½ä»¤è¡Œé€šè¿‡åŠ å¼ºå·¥å…· iredis è¿æ¥

```shell
$ iredis --url redis://39.102.138.62:6379/1
```

#### è®¾ç½®æŸä¸ªé”®çš„å€¼

```shell
$ set testkey "kobe"
```

#### å–å¾—æŸä¸ªé”®çš„å€¼

```shell
$ get testkey
```

#### è·å– redis æœåŠ¡å™¨çš„ç»Ÿè®¡ä¿¡æ¯

```shell
$ info
```



[(6æ¡æ¶ˆæ¯) Redisâ€”â€”é…ç½®å…è®¸è¿œç¨‹è¿æ¥_å°è¯¸è‘›çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/LONG_Yi_1994/article/details/113940332)



## RabbitMQ

<a href="http://39.102.138.62:15672/#/"><img src="https://img.shields.io/badge/RabbitMQ%20-3.9.4-green" ></a><a href="http://39.102.138.62:15672/#/"><img src="https://img.shields.io/badge/Erlang%20-23.3.4.5-yellowgreen" ></a>

- ç¯å¢ƒå‡†å¤‡:
  
   [ğŸ”— rabbitmqå®‰è£…æŒ‡å—](https://blog.csdn.net/u010783161/article/details/104833030)
  [ğŸ”— rabbitmq webè®¿é—®è´¦å·è®¾ç½®](https://blog.csdn.net/u014650004/article/details/105800637?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-1.essearch_pc_relevant&spm=1001.2101.3001.4242)
  
- yum å®‰è£…çš„å®‰è£…è·¯å¾„ä¸º `/usr/lib/rabbitmq/lib/rabbitmq_server-xxx`

- å¯åŠ¨/æŸ¥çœ‹çŠ¶æ€/åœæ­¢/é‡å¯
  `service rabbitmq-server start/status/stop/restart`

```bash
yum -y update
yum -y install epel-release
yum -y install erlang socat
erl -verison  
sudo rabbitmqctl add_user ibepo 123456
sudo rabbitmqctl set_user_tags ibepo administrator
```

## jenkins

```bash
service jenkins restart #é‡å¯ jenkins
```



## Tailwind

å®½åº¦

`w-40`

å…¶ä»–å°ºå¯¸éƒ½éšè—,æ¡Œé¢æ¨¡å¼ ç°èº«

`hidden lg:block`

ç«–å‘æ’åˆ—

`flex  flex-col`

çºµå‘é“ºæ»¡å…¨å±å¹•,æ¨ªå‘å°ºå¯¸å›ºå®š

`w-60 h-screen`

fflex å¸ƒå±€,å‚ç›´æ–¹å‘å±…ä¸­,*ä»è¡Œé¦–èµ·å§‹ä½ç½®å¼€å§‹æ’åˆ—*

```
.mx-6 {
    margin-left: 1.5rem/* 24px */;
    margin-right: 1.5rem/* 24px */;
}
.mt-10 {
    margin-top: 2.5rem/* 40px */;
}
```



`flex items-center justify-start mx-6 mt-10`

## Vite

- åŸºäº [unplugin-vue-components](https://www.npmjs.com/package/unplugin-vue-components) çš„ vue æ’ä»¶ï¼Œå¯é€šè¿‡è¯†åˆ«è‡ªå®šä¹‰ç»„ä»¶ tag å‰ç¼€è‡ªåŠ¨å¯¼å…¥ç»„ä»¶çš„å·¥å…·ã€‚
-  [unplugin-element-plus](https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Felement-plus%2Funplugin-element-plus),æŒ‰éœ€è¦å¼•å…¥é¥¿äº†ä¹ˆç»„ä»¶



## node

```shell
npm install n -g
sudo n lts
sudo n stable
n <cr> #n +å›è½¦ åˆ‡æ¢å½“å‰ node ç‰ˆæœ¬

export NODE_HOME=/usr/local
export PATH=$NODE_HOME/bin:$PATH
export NODE_PATH=$NODE_HOME/lib/node_modules:$PATH
```



## vue3

- [Vue3ä½¿ç”¨Mittæ›¿ä»£EventBus ](https://zhuanlan.zhihu.com/p/340244131)
- `<script setup>`è¯­æ³•ç³–,çœå»äº† export default çš„è¿”å›å€¼,åœ¨å…¶ä¸­çš„å¯¼å…¥çš„ js,ä¹Ÿå¯ç›´æ¥ç”¨åˆ°`template`ä¸­

```vue
//1.
<script setup>
console.log('hello script setup')
</script>

//2.
<script setup>
// å˜é‡
const msg = 'Hello!'
// å‡½æ•°
function log() {
  console.log(msg)
}
</script>
<template>
  <div @click="log">{{ msg }}</div>
</template>

```

### ä¸€äº›ç»´åº¦

- vdom
- template
- jsx   

![image-20211109113931898](https://gitee.com/ibepo/ogcip/raw/master/20211109113932.png)



[ã€å‰ç«¯é¢è¯•å¿…å¤‡ã€‘Vue2ä¸Vue3æ ¸å¿ƒä¹‹ã€å“åº”å¼åŸç†ã€_å“”å“©å“”å“©_bilibili](https://www.bilibili.com/video/BV1Dk4y127Ha?spm_id_from=333.999.0.0)



## vetega

- topbar
- ç™»å½•é¡µ
- ç«™ç‚¹é¡µè„š
- å·¦ä¾§èœå• navbar
- ç«™ç‚¹é”šç‚¹
- å³é”®èœå•
- æŸ¥è¯¢åˆ—è¡¨é¡µ
- åˆ†æ­¥è¡¨å•é¡µ
- åˆ†ç»„è¡¨å•é¡µ
- å¼€ç¯‡åˆ—è¡¨é¡µ





## Maven


 mvn clean packageä¾æ¬¡æ‰§è¡Œäº†cleanã€resourcesã€compileã€testResourcesã€testCompileã€testã€jar(æ‰“åŒ…)ç­‰ï¼—ä¸ªé˜¶æ®µã€‚
 mvn clean installä¾æ¬¡æ‰§è¡Œäº†cleanã€resourcesã€compileã€testResourcesã€testCompileã€testã€jar(æ‰“åŒ…)ã€installç­‰8ä¸ªé˜¶æ®µã€‚
 mvn clean deployä¾æ¬¡æ‰§è¡Œäº†cleanã€resourcesã€compileã€testResourcesã€testCompileã€testã€jar(æ‰“åŒ…)ã€installã€deployç­‰ï¼™ä¸ªé˜¶æ®µã€‚

 packageå‘½ä»¤å®Œæˆäº†é¡¹ç›®ç¼–è¯‘ã€å•å…ƒæµ‹è¯•ã€æ‰“åŒ…åŠŸèƒ½ï¼Œä½†æ²¡æœ‰æŠŠæ‰“å¥½çš„å¯æ‰§è¡ŒjaråŒ…ï¼ˆwaråŒ…æˆ–å…¶å®ƒå½¢å¼çš„åŒ…ï¼‰å¸ƒç½²åˆ°æœ¬åœ°mavenä»“åº“å’Œè¿œç¨‹mavenç§æœä»“åº“

 installå‘½ä»¤å®Œæˆäº†é¡¹ç›®ç¼–è¯‘ã€å•å…ƒæµ‹è¯•ã€æ‰“åŒ…åŠŸèƒ½ï¼ŒåŒæ—¶æŠŠæ‰“å¥½çš„å¯æ‰§è¡ŒjaråŒ…ï¼ˆwaråŒ…æˆ–å…¶å®ƒå½¢å¼çš„åŒ…ï¼‰å¸ƒç½²åˆ°æœ¬åœ°mavenä»“åº“ï¼Œä½†æ²¡æœ‰å¸ƒç½²åˆ°è¿œç¨‹mavenç§æœä»“åº“

 deployå‘½ä»¤å®Œæˆäº†é¡¹ç›®ç¼–è¯‘ã€å•å…ƒæµ‹è¯•ã€æ‰“åŒ…åŠŸèƒ½ï¼ŒåŒæ—¶æŠŠæ‰“å¥½çš„å¯æ‰§è¡ŒjaråŒ…ï¼ˆwaråŒ…æˆ–å…¶å®ƒå½¢å¼çš„åŒ…ï¼‰å¸ƒç½²åˆ°æœ¬åœ°mavenä»“åº“å’Œè¿œç¨‹mavenç§æœä»“åº“

1. çˆ¶pom çš„ packaging è¦è®¾ä¸º pom,å­ pom çš„è®¾ä¸º jar
2. çˆ¶å­çš„å¥‘çº¦è¾¾æˆæ¡ä»¶æ˜¯ å­ pom çš„ parent è®¾ä¸ºçˆ¶ pom,ä¸”çˆ¶ pom ä¸­çš„ modules ä¸­å­˜åœ¨å­ pom
3. è€è€å®å®çš„ç»´æŠ¤ç‰ˆæœ¬å·,ä¸ä¾èµ– parents ä¸­çš„é»˜è®¤é…ç½®æ˜¯æœ€ç¨³å¦¥çš„æ–¹å¼
4. spring-boot-starter-parent çš„çˆ¶ä¾èµ–æ˜¯spring-boot-dependencies,å…¶ä¸­å®šä¹‰äº†ä¸€äº› version,ä½†æ˜¯ä¸å…¨ä¸è¦è¿‡åˆ†ä¾èµ–
5. mavenè·å–ä¾èµ–åŒ…é”™è¯¯ä»£ç ï¼š501, ReasonPhrase:HTTPS Requiredâ“
   è‡ª2020.01.15åmavenä¸­å¤®ä»“åº“è¦æ±‚ä½¿ç”¨httpsè¿›è¡Œè®¿é—®ï¼Œå°†mavené…ç½®ä¸­çš„åŸä¸­å¤®ä»“åº“åœ°å€httpæ›´æ”¹ä¸ºhttpså³å¯

## NPM

```SHELL
$ npm install eslint --save-dev #å°† eslint å®‰è£…åˆ°å¼€å‘ä¾èµ–ä¸­
$ ni #ä¸€åˆ‡çš†å¯ ni
```



## Eslint

Eslint åªæ ¡éªŒ js,stylelint æ ¡éªŒ css,ä¸¤è€…æ­é…ä½¿ç”¨,ä»¥ä¸‹æ˜¯ä»–ä¸¤çš„ vscode æ’ä»¶ éœ€è¦åœ¨ setting.json é…ç½®çš„`ä¿å­˜è‡ªåŠ¨æ ¼å¼åŒ– `ç›¸å…³ä»£ç 

```JS
//å·¥ä½œåŒº setting.json
{
    "editor.codeActionsOnSave": {
        "source.fixAll.eslint": true,
        "source.fixAll.stylelint": true
    },
    "stylelint.validate": [
        "css",
        "scss",
        "vue"
    ],
    "vue3snippets.enable-compile-vue-file-on-did-save-code": false
}

```





## package.json

### scripts

- script å±æ€§çš„æ„æ€æ˜¯è„šæœ¬ï¼Œä½¿ç”¨æ–¹æ³•æ˜¯åœ¨ cmd çª—å£ä¸­è¾“å…¥ `npm run æŒ‡ä»¤` çš„å½¢å¼ï¼Œå¦‚ï¼š`npm run lint:create`ï¼›
- `"lint:create": "eslint --init"` è¿™ä¸ªè„šæœ¬æ˜¯ä¸ºäº†ç”Ÿæˆ .eslintrc.js æ–‡ä»¶ï¼Œåœ¨ä»‹ç» Lint çš„æ—¶å€™è¯´åˆ° Lint åº”è¯¥æä¾›ç¼–ç è§„èŒƒï¼Œè§„èŒƒå†™åœ¨å“ªé‡Œï¼Œå°±å†™åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ›å»ºå®ƒï¼›
- `"lint": "eslint src"` åœ¨ä»‹ç» Lint çš„æ—¶å€™ä¹Ÿè¯´åˆ° Lint åº”è¯¥æä¾›è‡ªåŠ¨æ ¡éªŒä»£ç çš„ç¨‹åºï¼Œè¿™ä¸ªè„šæœ¬æ˜¯è®© Lint è‡ªåŠ¨æ£€éªŒ src ç›®å½•ä¸‹æ‰€æœ‰çš„ .js æ–‡ä»¶ã€‚
- è¿™é‡Œç»™ `"lint": "eslint src --fix",` åŠ ä¸Š `--fix` å‚æ•°ï¼Œæ˜¯ Eslint æä¾›çš„è‡ªåŠ¨ä¿®å¤åŸºç¡€é”™è¯¯çš„åŠŸèƒ½ã€‚

```shell
"scripts": {
    "test": "react-scripts test --env=jsdom",
    "lint": "eslint src --fix",
    "lint:create": "eslint --init"
}
```





## Mybatis

### ä»£ç ç”Ÿæˆå™¨

mybatisplus çš„ä»£ç ç”Ÿæˆå™¨åœ¨ `3.5.1`ä¹‹åæœ‰è¾ƒå¤§è¾ƒå¥½çš„æ›´æ–°,å¼•å…¥äº†`å»ºé€ è€…æ¨¡å¼`,ç®€åŒ–äº†`æ•°æ®åº“é…ç½®` `åŒ…é…ç½®` `æ¨¡æ¿é…ç½®` `æ³¨å…¥é…ç½®` `ç­–ç•¥é…ç½®`

[ä»£ç ç”Ÿæˆå™¨ï¼ˆ3.5.1+ç‰ˆæœ¬ï¼‰ | MyBatis-Plus (baomidou.com)](https://baomidou.com/guide/generator-new.html#åŒ…é…ç½®-packageconfig)

```JAVA
  FastAutoGenerator.create(url, username, password)
                .globalConfig(builder -> {
                    builder.author("ibepo") // è®¾ç½®ä½œè€…
                            //.enableSwagger() // å¼€å¯ swagger æ¨¡å¼
                            .fileOverride() // è¦†ç›–å·²ç”Ÿæˆæ–‡ä»¶
                            .disableOpenDir()//ç¦æ­¢æ‰“å¼€è¾“å‡ºç›®å½•
                            .outputDir("src/main/java"); // æŒ‡å®šè¾“å‡ºç›®å½•
                })
                .packageConfig(builder -> {
                    builder.parent("com.simas.goku") // è®¾ç½®çˆ¶åŒ…å
                            .moduleName("") // è®¾ç½®çˆ¶åŒ…æ¨¡å—å
                            .pathInfo(Collections.singletonMap(OutputFile.mapperXml, "src/main/resources/mapper")); // è®¾ç½®mapperXmlç”Ÿæˆè·¯å¾„
                })
                .strategyConfig(builder -> {
                    builder.addInclude("customer") // è®¾ç½®éœ€è¦ç”Ÿæˆçš„è¡¨å
                            .addTablePrefix("t_", "c_"); // è®¾ç½®è¿‡æ»¤è¡¨å‰ç¼€
                })
                .execute();
```



## MybatisPlus

- è‡ªåŠ¨å¡«å……
- version
- é€»è¾‘åˆ é™¤
- Wrapper



```java
@Override
    public Optional<DwdPersonIoDataVo> findLastIoData(String personCode) {
      //LamdaQueryWrapperçš„åˆ›å»ºæ–¹å¼ å¯ä»¥ç›´æ¥ new ,
      //ä¹Ÿå¯ä»¥ç›´æ¥ä»æ­¤ serviceiml é›†æˆçš„ baseserviceimpl ä¸­ ç›´æ¥ this.lamdaquery çš„æ–¹å¼æ‹¿åˆ° 
     //å½¢å¼ 1
      LambdaQueryWrapper<DwdPersonIoData> queryWrapper = new LambdaQueryWrapper<>();
        queryWrapper.eq(DwdPersonIoData::getPersonCode, personCode);
        queryWrapper.orderByDesc(DwdPersonIoData::getId);
        queryWrapper.last(" limit 1");
        DwdPersonIoData dwdPersonIoData = getBaseMapper().selectOne(queryWrapper);
       //å½¢å¼ 2
       LambdaQueryChainWrapper<DwdPersonIoData> last = this
                .lambdaQuery()
                .eq(DwdPersonIoData::getPersonCode, personCode)
                .orderByDesc(DwdPersonIoData::getId)
                .last("limit 1");
       DwdPersonIoData dwdPersonIoData1 = this.baseMapper.selectOne(last);

      //dto è½¬ vo
DwdPersonIoDataVo vo = BeanHelper.convertAndCopyWithRuntimeException(DwdPersonIoDataVo.class, dwdPersonIoData);
      
        return Optional.ofNullable(vo);
    }
```



## lombook

```java
@Slf4j lombok logå¯¹è±¡
å¦‚æœä¸æƒ³æ¯æ¬¡éƒ½å†™private  final Logger logger = LoggerFactory.getLogger(XXX.class); å¯ä»¥ç”¨æ³¨è§£@Slf4j

è¿™æ ·åœ¨ç±»ä¸­å°±å¯ä»¥ç›´æ¥ä½¿ç”¨logå¯¹è±¡ï¼Œ

log.debug("debug message");
log.warn("warn message");
log.info("info message");
log.error("error message");
log.trace("trace message");


```

## Jackson

æ ¼å¼åŒ–è¿”å›çš„ æ—¥æœŸæ ¼å¼

```java
 @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
```





## IDEA

[å¹²äº†5å¹´Javaï¼Œæˆ‘ç»ˆäºç©ä¼šäº†IDEAï¼ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6988866268312895501#heading-21)

## hutool

è¾“å‡ºå‹å¥½çš„ json å­—ç¬¦ä¸²æ ¼å¼

```java
JSONUtil.toJsonPrettyStr(obj/json)
```



## JWT

[jwt å®è·µåº”ç”¨ä»¥åŠä¸é€‚ç”¨ç‰¹æ®Šæ¡ˆä¾‹æ€è€ƒ | å±±æœˆè¡Œ (shanyue.tech)](https://shanyue.tech/post/jwt-guide.html#json-web-token)



1. ç½‘å…³ç»Ÿä¸€è®¤è¯æ–¹å¼

![image-20211116141604210](https://gitee.com/ibepo/ogcip/raw/master/20211116141604.png)



2. åº”ç”¨è®¤è¯æ–¹æ¡ˆ

![image-20211116142551585](https://gitee.com/ibepo/ogcip/raw/master/20211116142551.png)





![image-20211116142828945](https://gitee.com/ibepo/ogcip/raw/master/20211116142829.png)



## Nacos

```java
package com.simas.goku.controller;


import org.springframework.beans.factory.annotation.Value;
import org.springframework.cloud.context.config.annotation.RefreshScope;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.HashMap;
import java.util.Map;

@RefreshScope
@RestController
public class ConfigController {

    @Value("${project.name:}")
    private String projectName;

    @Value("${project.org:}")
    private String projectOrg;

    @GetMapping("/config")
    public Map<String, Object> getConfig() {
        Map<String, Object> configMap = new HashMap();
        configMap.put("projectName", projectName);
        configMap.put("projectOrg", projectOrg);
        return configMap;
    }

}

```





## ç»„ç»‡ç»“æ„

``` 
goku_jindowin
â”œâ”€â”€ goku-kamehameha -- å¾®æœåŠ¡è°ƒç”¨æµ‹è¯• å°†å•ä½“ goku ä¸­çš„æ•°æ®åº“è®¿é—®é‚£ä¸€å¥—ç§»æ¤è¿‡æ¥
â”œâ”€â”€ goku-common -- å·¥å…·ç±»åŠé€šç”¨ä»£ç æ¨¡å—
â”œâ”€â”€ goku-auth -- åŸºäºSpring Security Oauth2çš„ç»Ÿä¸€çš„è®¤è¯ä¸­å¿ƒ
â”œâ”€â”€ goku-gateway -- åŸºäºSpring Cloud Gatewayçš„å¾®æœåŠ¡APIç½‘å…³æœåŠ¡
â”œâ”€â”€ goku-monitor -- åŸºäºSpring Boot Adminçš„å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒ
â”œâ”€â”€ goku-admin -- åå°ç®¡ç†ç³»ç»ŸæœåŠ¡
â”œâ”€â”€ goku-search -- åŸºäºElasticsearchçš„å•†å“æœç´¢ç³»ç»ŸæœåŠ¡
â”œâ”€â”€ goku-portal -- ç§»åŠ¨ç«¯å•†åŸç³»ç»ŸæœåŠ¡
â”œâ”€â”€ goku-demo -- å¾®æœåŠ¡è¿œç¨‹è°ƒç”¨æµ‹è¯•æœåŠ¡
â””â”€â”€ config -- é…ç½®ä¸­å¿ƒå­˜å‚¨çš„é…ç½®
```

## æŠ€æœ¯é€‰å‹

### åç«¯æŠ€æœ¯

| æŠ€æœ¯                   | è¯´æ˜                 | å®˜ç½‘                                                 |
| ---------------------- | -------------------- | ---------------------------------------------------- |
| Spring Cloud           | å¾®æœåŠ¡æ¡†æ¶           | https://spring.io/projects/spring-cloud              |
| Spring Cloud Alibaba   | å¾®æœåŠ¡æ¡†æ¶           | https://github.com/alibaba/spring-cloud-alibaba      |
| Spring Boot            | å®¹å™¨+MVCæ¡†æ¶         | https://spring.io/projects/spring-boot               |
| Spring Security Oauth2 | è®¤è¯å’Œæˆæƒæ¡†æ¶       | https://spring.io/projects/spring-security-oauth     |
| MyBatis                | ORMæ¡†æ¶              | http://www.mybatis.org/mybatis-3/zh/index.html       |
| MyBatisGenerator       | æ•°æ®å±‚ä»£ç ç”Ÿæˆ       | http://www.mybatis.org/generator/index.html          |
| PageHelper             | MyBatisç‰©ç†åˆ†é¡µæ’ä»¶  | http://git.oschina.net/free/Mybatis_PageHelper       |
| Knife4j                | æ–‡æ¡£ç”Ÿäº§å·¥å…·         | https://github.com/xiaoymin/swagger-bootstrap-ui     |
| Elasticsearch          | æœç´¢å¼•æ“             | https://github.com/elastic/elasticsearch             |
| RabbitMq               | æ¶ˆæ¯é˜Ÿåˆ—             | https://www.rabbitmq.com/                            |
| Redis                  | åˆ†å¸ƒå¼ç¼“å­˜           | https://redis.io/                                    |
| MongoDb                | NoSqlæ•°æ®åº“          | https://www.mongodb.com/                             |
| Docker                 | åº”ç”¨å®¹å™¨å¼•æ“         | https://www.docker.com/                              |
| Druid                  | æ•°æ®åº“è¿æ¥æ±          | https://github.com/alibaba/druid                     |
| OSS                    | å¯¹è±¡å­˜å‚¨             | https://github.com/aliyun/aliyun-oss-java-sdk        |
| MinIO                  | å¯¹è±¡å­˜å‚¨             | https://github.com/minio/minio                       |
| JWT                    | JWTç™»å½•æ”¯æŒ          | https://github.com/jwtk/jjwt                         |
| LogStash               | æ—¥å¿—æ”¶é›†             | https://github.com/logstash/logstash-logback-encoder |
| Lombok                 | ç®€åŒ–å¯¹è±¡å°è£…å·¥å…·     | https://github.com/rzwitserloot/lombok               |
| Seata                  | å…¨å±€äº‹åŠ¡ç®¡ç†æ¡†æ¶     | https://github.com/seata/seata                       |
| Portainer              | å¯è§†åŒ–Dockerå®¹å™¨ç®¡ç† | https://github.com/portainer/portainer               |
| Jenkins                | è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·       | https://github.com/jenkinsci/jenkins                 |
| Kubernetes             | åº”ç”¨å®¹å™¨ç®¡ç†å¹³å°     | https://kubernetes.io/                               |

### å‰ç«¯æŠ€æœ¯

| æŠ€æœ¯       | è¯´æ˜                  | å®˜ç½‘                           |
| ---------- | --------------------- | ------------------------------ |
| Vue        | å‰ç«¯æ¡†æ¶              | https://vuejs.org/             |
| Vue-router | è·¯ç”±æ¡†æ¶              | https://router.vuejs.org/      |
| Vuex       | å…¨å±€çŠ¶æ€ç®¡ç†æ¡†æ¶      | https://vuex.vuejs.org/        |
| Element    | å‰ç«¯UIæ¡†æ¶            | https://element.eleme.io/      |
| Axios      | å‰ç«¯HTTPæ¡†æ¶          | https://github.com/axios/axios |
| v-charts   | åŸºäºEchartsçš„å›¾è¡¨æ¡†æ¶ | https://v-charts.js.org/       |



## Macè½¯ä»¶

|         å·¥å…·          |                             åœ°å€                             |                             å¤‡æ³¨                             |
| :-------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|        typora         | [Typora â€” a markdown editor, markdown reader.](https://typora.io/) |                        ä¸»é¢˜:Ava Diana                        |
|         Edge          |                                                              | æ’ä»¶:GitHubåŠ é€Ÿã€Infinity æ–°æ ‡ç­¾é¡µ (Pro)ã€JSON-handleã€RSSHub Radarã€ä¾§è¾¹ç¿»è¯‘ã€æ”¶è—çŒ«ã€NeatDownloadManager Extensionã€Markdown Niceã€Separate Windowã€Octotree - GitHub code treeã€Smart TOC(MDåˆ—è¡¨)ã€Tree Style History,Gitako(git æ ‘å½¢æ˜¾ç¤º) |
|      Fast-GitHub      |             https://github.com/ibepo/Fast-GitHub             |                                                              |
|    OpenInTerminal     |           https://github.com/ibepo/OpenInTerminal            |                         Finder æ‰©å±•                          |
|       cakebrew        |                                                              |                      homebrew çš„æ¡Œé¢ç«¯                       |
|      SourceTree       |                                                              |                          GIt æ¡Œé¢ç«¯                          |
|        Mangnet        |                                                              |                        window  manger                        |
|       SSH Shell       |                                                              |                       mac ç«¯ ssh å·¥å…·                        |
|        ApiPost        |                                                              |   å›½äº§ postman ,æ”¯æŒåœ¨çº¿ç”Ÿæˆæ–‡æ¡£,kefanbufan@163  lz123321    |
|       SniPaste        |                                                              |                             æˆªå›¾                             |
|          Mos          |                                                              |                    mac ä¸‹é¼ æ ‡å¹³æ»‘ç§»åŠ¨å·¥å…·                    |
|        clashx         |                                                              |                        é£æœºåœºé…ç½®å·¥å…·                        |
|         IINA          |                                                              |                          mac æ’­æ”¾å™¨                          |
|       Terimius        |                                                              |                     ç»ˆç«¯å’Œ ftp ä¼ è¾“å·¥å…·                      |
|        draw.io        |                                                              |                           UMLå·¥å…·                            |
|         Keka          |                                                              |                          è§£å‹ç¼©å·¥å…·                          |
|    The Unarchiver     |                                                              |                          è§£å‹ç¼©å·¥å…·                          |
| Nest Download Manager |                                                              |                            ä¸‹è½½å™¨                            |
|        iTerm2         |                                                              |                          å‘½ä»¤è¡Œå·¥å…·                          |
|        Downie4        |                                                              |                          è§†é¢‘ä¸‹è½½å™¨                          |
|         cubox         |                                                              |                           æ ‡ç­¾ç®¡ç†                           |
|         Drop          |                                                              |                           è‰²å·æå–                           |
|        Charles        |                                                              |                      web debugger proxy                      |
|       MobaXterm       |                https://mobaxterm.mobatek.net/                | Enhanced terminal for Windows with X11 server, tabbed SSH client, network tools and much more |
|         Idea          |                                                              |               æ’ä»¶:IDE Eval Reset(æ— é™æœŸè¯•ç”¨)                |
|      Sequel pro       |                                                              |                         æ•°æ®åº“å®¢æˆ·ç«¯                         |
|         Hyper         |                                                              |                      mac å‘½ä»¤è¡Œç»ˆç«¯å·¥å…·                      |
|         Xmind         |                                                              |                           è„‘å›¾å·¥å…·                           |
|       Swithhost       | [SwitchHosts/README_cn.md at master Â· oldj/SwitchHosts (github.com)](https://github.com/oldj/SwitchHosts/blob/master/README_cn.md) |                      æœ¬åœ°ä¿®æ”¹ host ç¥å™¨                      |
|       transmit        |                                                              |                        Ftp å·¥å…·æœ€ä¼˜è§£                        |
|         Macwk         |                    https://www.macwk.com/                    |                      ç›—ç‰ˆmac åº”ç”¨é›†æ•£åœ°                      |
|       TablePlus       |                                                              |                      Redis mysql å®¢æˆ·ç«¯                      |
|       æ²™æ‹‰æŸ¥è¯        |       [Saladict æ²™æ‹‰æŸ¥è¯](https://saladict.crimx.com/)       |                                                              |

ç«¯å£è¯´æ˜

|    æœåŠ¡    |                ç«¯å£                |
| :--------: | :--------------------------------: |
| `keyclock` | [9010](http://39.102.138.62:9010/) |



##### [æ‡’ç¨‹åºå‘˜å’Œä»–çš„ dotfiles - CoderZh Blog](https://blog.coderzh.com/2016/03/19/dotfiles/)

## skhdrc

```shell
alt+{1,2,3,4,5,6} #åˆ‡æ¢æ¡Œé¢
alt+hjkl #åˆ‡æ¢å½“å‰å±å¹•çš„ç„¦ç‚¹

ctrl+alt+a #åˆ‡æ¢åˆ°å¹³é“ºæ¨¡å¼
ctrl+alt+d #åˆ‡æ¢åˆ°æ™®é€šæµ®åŠ¨æ¨¡å¼

shift+cmd +{12334}  #å°†å½“å‰å…³æ³¨ç§»åŠ¨åˆ°æŒ‡å®šæ¡Œé¢
ctrl+cmd+{12334}    #å°†å½“å‰å…³æ³¨å‘å°„åˆ°æŒ‡å®šæ˜¾ç¤ºå™¨
```

æœ€æœ€é‡è¦çš„å‡ ä¸ªå¿«æ·é”®:

- alt + æ•°å­—é”® å¯ä»¥å¿«é€Ÿè¿›å…¥å¯¹åº”ç©ºé—´
- alt + h/j/k/l å¯ä»¥å¿«é€Ÿèšç„¦å½“å‰ç©ºé—´çš„æŸä¸ªçª—å£
- alt + f å°†æŸä¸ªçª—å£å…¨å± (å†æŒ‰ä¸€æ¬¡ä¼šæ¨å‡ºå…¨å±)
- shift + cmd + æ•°å­—é”® å¯ä»¥å°†å½“å‰æ´»è·ƒçª—å£ç§»åŠ¨åˆ°æŒ‡å®šç©ºé—´
- ctrl + alt + æ•°å­—é”® æ¿€æ´»æŒ‡å®šæ˜¾ç¤ºå™¨
- ctrl + cmd + æ•°å­—é”® å°†å½“å‰æ¿€æ´»çª—å£å‘é€åˆ°æŒ‡å®šæ˜¾ç¤ºå™¨ä¸Šé¢å» (æŒ‡å®šæ˜¾ç¤ºå™¨ä¸èƒ½æ˜¯æµ®åŠ¨æ¨¡å¼)



## yabai

### focus

| Action      | Key Combination |
| ----------- | --------------- |
| focus west  | alt + h         |
| focus south | alt + j         |
| focus north | alt + k         |
| focus east  | alt + l         |

#### Resize windows

| Action       | Key Combination |
| ------------ | --------------- |
| Resize left  | shfit + cmd + h |
| Resize down  | shfit + cmd + j |
| Resize up    | shfit + cmd + k |
| Resize right | shfit + cmd + l |
| Equalise     | shfit + cmd + 0 |

#### Rotate windows

| Action               | Key Combination |
| -------------------- | --------------- |
| Rotate clockwise     | shift + alt + r |
| Rotate anticlockwise | alt + r         |
| Flip on x-axis       | shift + alt + x |
| Flip on y-axis       | shift + alt + y |

#### Window actions

| Action            | Key Combination |
| ----------------- | --------------- |
| Fullscreen        | alt + f         |
| Native fullscreen | shift + alt + f |
| Center window     | shift + alt + c |

#### Insertion point

| Action                       | Key Combination         |
| ---------------------------- | ----------------------- |
| Insert left                  | shift + lctrl + alt + h |
| Insert down                  | shift + lctrl + alt + j |
| Insert up                    | shift + lctrl + alt + k |
| Insert right                 | shift + lctrl + alt + l |
| Cancel insert (chunkwm only) | shift + lctrl + alt + x |

#### Misc

| Action          | Key Combination         |
| --------------- | ----------------------- |
| Toggle float    | shift + alt + space     |
| Toggle gaps     | lctrl + alt + g         |
| Restart chunkwm | lctrl + shift + alt + r |





#### Move windows

shift + alt + hjkl

#### Move windows to workspace

| Action                      | Key Combination   |
| --------------------------- | ----------------- |
| Send to last active desktop | shift + alt + m   |
| Send to previous workplace  | shift + alt + p   |
| Send to next workplace      | shift + alt + n   |
| Send to workplace           | shift + alt + num |

## ç¯å¢ƒæ­å»º

### å¼€å‘ç¯å¢ƒ

| å·¥å…·          | ç‰ˆæœ¬å· | ä¸‹è½½                                                         |
| ------------- | ------ | ------------------------------------------------------------ |
| JDK           | 1.8    | https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html |
| Mysql         | 5.7    | https://www.mysql.com/                                       |
| Redis         | 5.0    | https://redis.io/download                                    |
| Elasticsearch | 7.6.2  | https://www.elastic.co/cn/downloads/elasticsearch            |
| Kibana        | 7.6.2  | https://www.elastic.co/cn/downloads/kibana                   |
| Logstash      | 7.6.2  | https://www.elastic.co/cn/downloads/logstash                 |
| MongoDb       | 4.2.5  | https://www.mongodb.com/download-center                      |
| RabbitMq      | 3.7.14 | http://www.rabbitmq.com/download.html                        |
| nginx         | 1.10   | http://nginx.org/en/download.html                            |



kamehouse

![image-20211110121753806](https://gitee.com/ibepo/ogcip/raw/master/20211110121754.png)



### æ­å»ºæ­¥éª¤

> Windowsç¯å¢ƒéƒ¨ç½²

- Windowsç¯å¢ƒæ­å»ºè¯·å‚è€ƒï¼š[mall-swarmåœ¨Windowsç¯å¢ƒä¸‹çš„éƒ¨ç½²](http://www.macrozheng.com/#/deploy/mall_swarm_deploy_windows);
- `mall-admin-web`é¡¹ç›®çš„å®‰è£…åŠéƒ¨ç½²è¯·å‚è€ƒï¼š[mallå‰ç«¯é¡¹ç›®çš„å®‰è£…ä¸éƒ¨ç½²](http://www.macrozheng.com/#/deploy/mall_deploy_web);
- `ELK`æ—¥å¿—æ”¶é›†ç³»ç»Ÿçš„æ­å»ºè¯·å‚è€ƒï¼š[SpringBootåº”ç”¨æ•´åˆELKå®ç°æ—¥å¿—æ”¶é›†](http://www.macrozheng.com/#/technology/mall_tiny_elk);
- ä½¿ç”¨MinIOå­˜å‚¨æ–‡ä»¶è¯·å‚è€ƒï¼š[å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œå¦‚ä½•ä¼˜é›…å®ç°æ–‡ä»¶å­˜å‚¨](http://www.macrozheng.com/#/technology/minio_use);
- è¯»å†™åˆ†ç¦»è§£å†³æ–¹æ¡ˆè¯·å‚è€ƒï¼š[ä½ è¿˜åœ¨ä»£ç é‡Œåšè¯»å†™åˆ†ç¦»ä¹ˆï¼Œè¯•è¯•è¿™ä¸ªä¸­é—´ä»¶å§](http://www.macrozheng.com/#/reference/gaea);
- `åˆ†å¸ƒå¼äº‹åŠ¡`è§£å†³æ–¹æ¡ˆè¯·å‚è€ƒï¼š[ä½¿ç”¨Seataå½»åº•è§£å†³Spring Cloudä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼](http://www.macrozheng.com/#/cloud/seata)ã€‚

> Dockerç¯å¢ƒéƒ¨ç½²

- ä½¿ç”¨è™šæ‹Ÿæœºå®‰è£…CentOS7.6è¯·å‚è€ƒï¼š[è™šæ‹Ÿæœºå®‰è£…åŠä½¿ç”¨Linuxï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†](http://www.macrozheng.com/#/reference/linux_install);
- Dockerç¯å¢ƒçš„å®‰è£…è¯·å‚è€ƒï¼š[å¼€å‘è€…å¿…å¤‡Dockerå‘½ä»¤](http://www.macrozheng.com/#/reference/docker);
- æœ¬é¡¹ç›®Dockeré•œåƒæ„å»ºè¯·å‚è€ƒï¼š[ä½¿ç”¨Mavenæ’ä»¶ä¸ºSpringBootåº”ç”¨æ„å»ºDockeré•œåƒ](http://www.macrozheng.com/#/reference/docker_maven);
- æœ¬é¡¹ç›®åœ¨Dockerå®¹å™¨ä¸‹çš„éƒ¨ç½²è¯·å‚è€ƒï¼š[mall-swarmåœ¨Linuxç¯å¢ƒä¸‹çš„éƒ¨ç½²ï¼ˆåŸºäºDockerå®¹å™¨ï¼‰](http://www.macrozheng.com/#/deploy/mall_swarm_deploy_docker);
- æœ¬é¡¹ç›®ä½¿ç”¨Jenkinsè‡ªåŠ¨åŒ–éƒ¨ç½²è¯·å‚è€ƒï¼š[å¾®æœåŠ¡æ¶æ„ä¸‹çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œä½¿ç”¨Jenkinsæ¥å®ç°](http://www.macrozheng.com/#/deploy/mall_swarm_deploy_jenkins)ã€‚

> Kubernetesç¯å¢ƒéƒ¨ç½²

- æœ¬é¡¹ç›®ä½¿ç”¨Kuberneteséƒ¨ç½²è¯·å‚è€ƒï¼š[mall-swarmå¾®æœåŠ¡é¡¹ç›®åœ¨K8Sä¸‹çš„å®è·µï¼](http://www.macrozheng.com/#/deploy/mall_swarm_deploy_k8s)

- ç›‘æ§ä¸­å¿ƒåº”ç”¨ä¿¡æ¯ï¼Œè®¿é—®åœ°å€ï¼šhttp://192.168.3.101:8101

- APIæ–‡æ¡£ä¿¡æ¯ï¼Œè®¿é—®åœ°å€ï¼šhttp://192.168.3.101:8201

- æ—¥å¿—æ”¶é›†ç³»ç»Ÿä¿¡æ¯ï¼Œè®¿é—®åœ°å€ï¼šhttp://192.168.3.101:5601

- å¯è§†åŒ–å®¹å™¨ç®¡ç†ï¼Œè®¿é—®åœ°å€ï¼šhttp://192.168.3.101:9000

## å®¹å™¨åŒ–åŸºç¡€å¹³å°æ­å»º

![image-20211112085203065](https://gitee.com/ibepo/ogcip/raw/master/20211112085203.png)

### traefik

- æœåŠ¡å‘ç° docker å®¹å™¨ä¸­çš„ åŸºç¡€è®¾ç½®
- é€šè¿‡ `é™æ€é…ç½®`æˆ–è€… `compose ä¸­çš„ labelså’Œ command` é…ç½®é»˜è®¤çš„è·¯ç”±è½¬å‘è§„åˆ™
- 

### æ•°æ®åº“å¤‡ä»½

```shell
echo ${WORKSPACE}
echo `ls ${WORKSPACE}/../backup-database/*.sql -t | head -1`
echo ${JENKINS_HOME}

mysql -u root -h 172.18.0.2 -P 3306 --password=SHBlueHour@2019 -D iot < `ls ${WORKSPACE}/../backup-database/*.sql -t | head -1`
```

```shell
mysqldump --hex-blob --default-character-set=utf8 -u root -h 172.17.0.9 -P 3306 --password=SHBlueHour@2019 iot > iot_production_`date +%w`.sql
```



### åç«¯éƒ¨ç½²

##### jenkinsåç«¯éƒ¨ç½²è„šæœ¬æ¡ˆä¾‹(ç«‹å®iot åç«¯ç³»ç»Ÿ)

```shell
#echo "shutdown iot-app..."
#curl --connect-timeout 5 --max-time 10 -X POST http://localhost:8099/actuator/shutdown

port=9099
pid=$(ps -ef | grep "iot-app.jar" | grep -v grep | awk '{print $2}')
echo $pid
if [ -n "$pid" ]
then
   echo "kill iot-app.jar -9 pid:" $pid
   kill -9 $pid
fi
sleep 10
cd /opt/apps/server

rm -rf iot-app.jar.bak

mv iot-app.jar iot-app.jar.bak

mv iot-app-1.0.0-SNAPSHOT-exec.jar iot-app.jar

echo "startup application..."
nohup java -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=iot-app.hprof -jar -Dspring.profiles.active=production iot-app.jar  >/dev/null 2>&1  &


echo "done"

```



### å‰ç«¯éƒ¨ç½²

[op-note/deploy-fe.md at master Â· shfshanyue/op-note (github.com)](https://github.com/shfshanyue/op-note/blob/master/deploy-fe.md)

[op-note/deploy-fe-with-docker.md at master Â· shfshanyue/op-note (github.com)](https://github.com/shfshanyue/op-note/blob/master/deploy-fe-with-docker.md)

#### ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒ

è¿™ä¸­é—´å…¶å®ç»å†äº†ä¸å°‘åå·ï¼Œå…¶ä¸­è¿‡ç¨‹å¦‚ä½•ï¼Œè¯¦è§æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« : [å¦‚ä½•ä½¿ç”¨ docker éƒ¨ç½²å‰ç«¯åº”ç”¨](https://juejin.im/post/5c83cbaa6fb9a04a0f65fdaa)ã€‚

å…¶ä¸­ä¸»è¦çš„ä¼˜åŒ–ä¹Ÿæ˜¯åœ¨ä¸Šè¿°æ‰€æåˆ°çš„ä¸¤ä¸ªæ–¹é¢

1. æ„å»ºé•œåƒä½“ç§¯ç”± 1G+ å˜ä¸º 10M+
2. æ„å»ºé•œåƒæ—¶é—´ç”± 5min+ å˜ä¸º 1min (è§†é¡¹ç›®å¤æ‚ç¨‹åº¦ï¼Œå¤§éƒ¨åˆ†æ—¶é—´åœ¨æ„å»ºæ—¶é—´ä¸ä¸Šä¼ é™æ€èµ„æºæ—¶é—´)

```
FROM node:alpine as builder

ENV PROJECT_ENV production
ENV NODE_ENV production

WORKDIR /code

ADD package.json /code
RUN npm install --production

ADD . /code

# npm run uploadCdn æ˜¯æŠŠé™æ€èµ„æºä¸Šä¼ è‡³ oss ä¸Šçš„è„šæœ¬æ–‡ä»¶ï¼Œå°†æ¥ä¼šä½¿ç”¨ cdn å¯¹ oss åŠ é€Ÿ
RUN npm run build && npm run uploadCdn

# ğŸ¦–é€‰æ‹©æ›´å°ä½“ç§¯çš„åŸºç¡€é•œåƒ
FROM nginx:alpine
COPY --from=builder code/public/index.html code/public/favicon.ico /usr/share/nginx/html/
COPY --from=builder code/public/static /usr/share/nginx/html/static
```

é‚£å®ƒæ€ä¹ˆåšçš„

1. å…ˆ `ADD package.json /code`, å† `npm install --production` ä¹‹å `Add` æ‰€æœ‰æ–‡ä»¶ã€‚å……åˆ†åˆ©ç”¨é•œåƒç¼“å­˜ï¼Œå‡å°‘æ„å»ºæ—¶é—´
2. å¤šé˜¶æ®µæ„å»ºï¼Œå¤§å¤§å‡å°é•œåƒä½“ç§¯

å¦å¤–è¿˜å¯ä»¥æœ‰ä¸€äº›å°ä¼˜åŒ–ï¼Œå¦‚

- `npm cache` çš„åŸºç¡€é•œåƒæˆ–è€… `npm` ç§æœ‰ä»“åº“ï¼Œå‡å°‘ `npm install` æ—¶é—´ï¼Œå‡å°æ„å»ºæ—¶é—´
- `npm install --production` åªè£…å¿…è¦çš„åŒ…

å‰ç«¯çœ‹ç€è‡ªå·±ä¼˜åŒ–çš„ `dockerfile`ï¼Œæƒ³ç€å‰å‡ å¤©è¿˜è¢«è¿ç»´åµï¼Œè¯´ä»€ä¹ˆç£ç›˜ä¸€åŠçš„ç©ºé—´éƒ½è¢«å‰ç«¯çš„é•œåƒç»™å äº†ï¼Œæƒ³ç€è‡ªå·±èŠ‚çœäº†å‰ç«¯é•œåƒå‡ ä¸ªæ•°é‡çº§çš„ä½“ç§¯ï¼Œä¸ºå…¬å¸å¥½åƒçœäº†ä¸å°‘æœåŠ¡å™¨çš„å¼€é”€ï¼Œæƒ³ç€è‡ªå·±çš„åŸºç¡€ç›˜è¿›ä¸€æ­¥æ‰©å¤§ï¼Œåˆä¸ç¦å¼€å¿ƒçš„ç¬‘äº†

è¿™æ—¶å€™å†æ€è€ƒæ–‡ç« æœ€å‰é¢ä¸¤ä¸ªé—®é¢˜

1. ç¼“å­˜ï¼Œç¼“å­˜ç”±å‰ç«¯æ§åˆ¶ï¼Œç¼“å­˜åœ¨ossä¸Šè®¾ç½®ï¼Œå°†ä¼šä½¿ç”¨ cdn å¯¹ oss åŠ é€Ÿã€‚æ­¤æ—¶ç¼“å­˜ç”±å‰ç«¯å†™è„šæœ¬æ§åˆ¶
2. è·¨åŸŸï¼Œè·¨åŸŸä»ç”±è¿ç»´åœ¨ `nginx` ä¸­é…ç½®

ç«‹å®å¼€å‘åº“é…ç½®

![image-20220516152740422](https://gitee.com/ibepo/ogcip/raw/master/20220516152741.png)

![image-20220516153233398](https://gitee.com/ibepo/ogcip/raw/6c4279f622e6d6bf6e8ba8f7bba8a7841e78b8ce/20220516153234.png)

